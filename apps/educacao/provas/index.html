<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Provas | Plena Apps</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .page-a4 {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        @media print {
            body {
                background: white;
            }

            .no-print {
                display: none !important;
            }

            .page-a4 {
                box-shadow: none;
                margin: 0;
                width: 100%;
            }
        }
    </style>
</head>

<body class="bg-slate-100 font-serif">

    <div id="app" v-cloak class="flex flex-col md:flex-row min-h-screen">

        <!-- EDITOR SIDEBAR -->
        <aside
            class="w-full md:w-96 bg-white border-r border-slate-200 flex flex-col h-screen sticky top-0 no-print z-20">
            <header class="p-4 border-b border-slate-200 bg-slate-50">
                <h1 class="font-bold text-slate-800"><i class="fa-solid fa-file-pen text-blue-600 mr-2"></i>Editor de
                    Prova</h1>
            </header>

            <div class="flex-grow overflow-y-auto p-4 space-y-4">

                <!-- Header Info -->
                <div class="space-y-2 bg-slate-50 p-3 rounded-lg border border-slate-200">
                    <h3 class="text-xs font-bold uppercase text-slate-400">Cabeçalho</h3>
                    <input v-model="info.school" type="text" placeholder="Nome da Escola"
                        class="w-full p-2 border rounded text-sm">
                    <input v-model="info.teacher" type="text" placeholder="Nome do Professor"
                        class="w-full p-2 border rounded text-sm">
                    <div class="flex gap-2">
                        <input v-model="info.class" type="text" placeholder="Turma/Ano"
                            class="w-full p-2 border rounded text-sm">
                        <input v-model="info.discipline" type="text" placeholder="Disciplina"
                            class="w-full p-2 border rounded text-sm">
                    </div>
                </div>

                <!-- Questions List -->
                <div class="space-y-3">
                    <h3 class="text-xs font-bold uppercase text-slate-400">Questões</h3>

                    <div v-for="(q, idx) in questions" :key="idx"
                        class="bg-white border hover:border-blue-400 rounded-lg p-3 shadow-sm transition group relative">
                        <div class="absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition">
                            <button @click="removeQuestion(idx)" class="text-red-400 hover:text-red-600"><i
                                    class="fa-solid fa-trash"></i></button>
                        </div>

                        <div class="flex items-center gap-2 mb-2">
                            <span class="bg-slate-100 text-slate-500 text-xs font-bold px-2 py-0.5 rounded">#{{ idx + 1
                                }}</span>
                            <select v-model="q.type" class="text-xs border rounded p-1">
                                <option value="discursive">Discursiva (Linhas)</option>
                                <option value="multiple">Múltipla Escolha</option>
                            </select>
                        </div>

                        <textarea v-model="q.text" rows="2" placeholder="Enunciado da questão..."
                            class="w-full p-2 border border-slate-200 rounded text-sm font-sans mb-2 outline-none focus:border-blue-400"></textarea>

                        <!-- Opts for Multiple -->
                        <div v-if="q.type === 'multiple'" class="space-y-1 pl-2 border-l-2 border-slate-100">
                            <div v-for="(opt, oIdx) in q.options" :key="oIdx" class="flex items-center gap-2">
                                <span class="text-xs font-bold text-slate-400">{{ String.fromCharCode(97 + oIdx)
                                    }})</span>
                                <input v-model="q.options[oIdx]" type="text"
                                    class="w-full text-xs border-b border-dashed bg-transparent outline-none">
                            </div>
                            <button @click="addOption(q)" class="text-[10px] text-blue-500 hover:underline">+
                                Opção</button>
                        </div>

                        <!-- Lines for Discursive -->
                        <div v-if="q.type === 'discursive'" class="flex items-center gap-2">
                            <label class="text-xs text-slate-400">Linhas:</label>
                            <input type="number" v-model="q.lines" class="w-12 text-xs border rounded p-1">
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-2">
                    <button @click="addQuestion('discursive')"
                        class="bg-white border border-dashed border-slate-300 py-3 rounded-lg text-slate-500 hover:border-blue-500 hover:text-blue-500 transition text-sm">
                        + Discursiva
                    </button>
                    <button @click="addQuestion('multiple')"
                        class="bg-white border border-dashed border-slate-300 py-3 rounded-lg text-slate-500 hover:border-blue-500 hover:text-blue-500 transition text-sm">
                        + Objetiva
                    </button>
                </div>

            </div>

            <footer class="p-4 border-t border-slate-200 bg-white">
                <button @click="print"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-lg flex items-center justify-center gap-2">
                    <i class="fa-solid fa-print"></i> Imprimir Prova
                </button>
            </footer>
        </aside>

        <!-- PREVIEW AREA (A4) -->
        <main class="flex-grow p-8 bg-slate-200 overflow-y-auto">

            <div class="page-a4 relative">

                <!-- CABEÇALHO DA PROVA -->
                <div class="border border-black mb-8 p-4 flex flex-col gap-4">
                    <div class="text-center border-b border-black pb-4">
                        <h1 class="text-xl font-bold uppercase">{{ info.school || 'Nome da Escola' }}</h1>
                        <p class="text-sm">Avaliação de {{ info.discipline || 'Disciplina' }}</p>
                    </div>
                    <div class="flex justify-between text-sm">
                        <div><b>Professor(a):</b> {{ info.teacher }}</div>
                        <div><b>Turma:</b> {{ info.class }}</div>
                        <div><b>Data:</b> ____/____/____</div>
                    </div>
                    <div class="text-sm">
                        <b>Aluno(a):</b> _________________________________________________________________
                    </div>
                    <div class="flex justify-between text-xs pt-2">
                        <span><b>Valor:</b> 10,0</span>
                        <span><b>Nota:</b> __________</span>
                    </div>
                </div>

                <!-- QUESTÕES -->
                <div class="space-y-6 text-justify">
                    <div v-for="(q, idx) in questions" :key="idx">
                        <div class="flex gap-2 mb-2">
                            <span class="font-bold">{{ idx + 1 }}.</span>
                            <p class="whitespace-pre-wrap">{{ q.text || 'Digite o enunciado...' }}</p>
                        </div>

                        <!-- Discursiva Lines -->
                        <div v-if="q.type === 'discursive'" class="pl-6 space-y-3 mt-4">
                            <div v-for="l in q.lines" class="border-b border-black opacity-30 h-6 w-full"></div>
                        </div>

                        <!-- Multiple Choice -->
                        <div v-if="q.type === 'multiple'" class="pl-6 space-y-2 mt-2">
                            <div v-for="(opt, oIdx) in q.options" :key="oIdx" class="flex gap-2 items-start">
                                <span class="font-bold"> {{ String.fromCharCode(97 + oIdx) }}) </span>
                                <span>{{ opt }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer Clean -->
                <div class="absolute bottom-10 left-0 w-full text-center text-[10px] text-gray-400 no-print-text">
                    Gerado via Plena Apps - Provas
                </div>

            </div>

        </main>

    </div>

    <script>
        const { createApp, ref } = Vue;

        createApp({
            setup() {
                const info = ref({
                    school: 'Escola Modelo Estadual',
                    teacher: '',
                    class: '',
                    discipline: ''
                });

                const questions = ref([
                    { type: 'discursive', text: 'Explique com suas palavras a importância do tema estudado.', lines: 4 },
                    { type: 'multiple', text: 'Qual das opções abaixo está correta?', options: ['Opção A', 'Opção B', 'Opção C', 'Opção D'] }
                ]);

                const addQuestion = (type) => {
                    if (type === 'discursive') {
                        questions.value.push({ type: 'discursive', text: '', lines: 3 });
                    } else {
                        questions.value.push({ type: 'multiple', text: '', options: ['', '', '', ''] });
                    }
                };

                const removeQuestion = (idx) => {
                    questions.value.splice(idx, 1);
                };

                const addOption = (q) => {
                    q.options.push('');
                };

                const print = () => {
                    window.print();
                };

                return {
                    info, questions, addQuestion, removeQuestion, addOption, print
                };
            }
        }).mount('#app');
    </script>
</body>

</html>