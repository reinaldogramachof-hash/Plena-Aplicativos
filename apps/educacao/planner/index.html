<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson Planner | Plena Apps</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        [v-cloak] {
            display: none;
        }

        .print-area {
            display: none;
        }

        @media print {
            .no-print {
                display: none !important;
            }

            .print-area {
                display: block;
            }

            body {
                background: white;
            }
        }
    </style>
</head>

<body class="text-gray-800">

    <div id="app" v-cloak class="min-h-screen flex flex-col">

        <!-- HEADER -->
        <header
            class="bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between no-print sticky top-0 z-20">
            <div class="flex items-center gap-3">
                <div class="bg-indigo-600 text-white w-10 h-10 rounded-lg flex items-center justify-center text-xl">
                    <i class="fa-solid fa-book-open"></i>
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Lesson Planner</h1>
                    <p class="text-xs text-gray-500">Planejamento Semanal</p>
                </div>
            </div>

            <div class="flex gap-2">
                <button @click="clearWeek"
                    class="px-4 py-2 text-sm text-red-500 hover:bg-red-50 rounded-lg transition font-medium">
                    Limpar
                </button>
                <button @click="printPlan"
                    class="px-4 py-2 text-sm bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg shadow-lg flex items-center gap-2 transition font-bold">
                    <i class="fa-solid fa-print"></i> Imprimir / PDF
                </button>
            </div>
        </header>

        <!-- MAIN GRID -->
        <main class="flex-grow p-6 overflow-x-auto no-print">

            <div class="min-w-[1000px] grid grid-cols-5 gap-4">
                <!-- DAYS HEADER -->
                <div v-for="day in days" :key="day"
                    class="text-center font-bold text-gray-400 uppercase text-xs tracking-wider pb-2 border-b-2 border-indigo-100">
                    {{ day }}
                </div>

                <!-- COLUMNS -->
                <div v-for="(day, dayIndex) in days" :key="dayIndex" class="space-y-4">

                    <!-- SLOTS -->
                    <div v-for="period in 5" :key="period"
                        class="bg-white rounded-xl shadow-sm border border-gray-100 p-4 h-40 flex flex-col group hover:shadow-md transition relative cursor-pointer"
                        @click="editSlot(dayIndex, period)">

                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[10px] font-bold text-indigo-200 bg-indigo-50 px-2 py-0.5 rounded">{{
                                period }}º Aula</span>
                            <span v-if="getSlot(dayIndex, period).turma" class="text-[10px] font-bold text-gray-500">{{
                                getSlot(dayIndex, period).turma }}</span>
                        </div>

                        <div v-if="getSlot(dayIndex, period).subject" class="flex-grow">
                            <h3 class="font-bold text-sm text-gray-800 line-clamp-2 leading-tight">{{ getSlot(dayIndex,
                                period).subject }}</h3>
                            <p class="text-xs text-gray-400 mt-1 line-clamp-3">{{ getSlot(dayIndex, period).objective }}
                            </p>
                        </div>
                        <div v-else
                            class="flex-grow flex items-center justify-center opacity-0 group-hover:opacity-100 transition">
                            <i class="fa-solid fa-plus text-2xl text-gray-200"></i>
                        </div>

                        <!-- Tag BNCC -->
                        <div v-if="getSlot(dayIndex, period).bncc" class="mt-auto">
                            <span
                                class="text-[9px] bg-gray-100 text-gray-500 px-1 py-0.5 rounded border border-gray-200">{{
                                getSlot(dayIndex, period).bncc }}</span>
                        </div>

                    </div>

                </div>
            </div>

        </main>

        <!-- EDITOR MODAL -->
        <div v-if="editing" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 no-print">
            <div class="bg-white rounded-2xl w-full max-w-lg p-6 shadow-2xl animate-fade-in-up">

                <div class="flex justify-between items-center mb-6">
                    <h3 class="font-bold text-xl text-gray-800">Editar Aula</h3>
                    <button @click="editing = null" class="text-gray-400 hover:text-gray-600"><i
                            class="fa-solid fa-times text-xl"></i></button>
                </div>

                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Turma</label>
                            <select v-model="editing.data.turma"
                                class="w-full bg-gray-50 border border-gray-200 rounded-lg p-2.5 text-sm outline-none focus:border-indigo-500">
                                <option value="">Selecione</option>
                                <option>6º Ano A</option>
                                <option>6º Ano B</option>
                                <option>7º Ano A</option>
                                <option>8º Ano A</option>
                                <option>9º Ano A</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Cód. BNCC</label>
                            <input v-model="editing.data.bncc" type="text" placeholder="Ex: EF06MA01"
                                class="w-full bg-gray-50 border border-gray-200 rounded-lg p-2.5 text-sm outline-none focus:border-indigo-500">
                        </div>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Tema / Conteúdo</label>
                        <input v-model="editing.data.subject" type="text" placeholder="Ex: Frações e Decimais"
                            class="w-full bg-gray-50 border border-gray-200 rounded-lg p-2.5 text-sm outline-none focus:border-indigo-500 font-bold">
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Objetivos &
                            Metodologia</label>
                        <textarea v-model="editing.data.objective" rows="4" placeholder="Descreva o que será feito..."
                            class="w-full bg-gray-50 border border-gray-200 rounded-lg p-2.5 text-sm outline-none focus:border-indigo-500"></textarea>
                    </div>
                </div>

                <div class="mt-8 flex gap-3">
                    <button @click="deleteSlot"
                        class="px-4 py-3 rounded-xl bg-red-50 text-red-600 font-bold text-sm hover:bg-red-100 transition">Excluir</button>
                    <button @click="saveSlot"
                        class="flex-grow px-4 py-3 rounded-xl bg-indigo-600 text-white font-bold text-sm hover:bg-indigo-700 transition shadow-lg shadow-indigo-200">Salvar
                        Planejamento</button>
                </div>

            </div>
        </div>

        <!-- PRINT TEMPLATE -->
        <div class="print-area p-8 max-w-[297mm] mx-auto">
            <h1 class="text-2xl font-bold text-center mb-2">Planejamento Semanal</h1>
            <p class="text-center text-sm text-gray-500 mb-8 border-b pb-4">Professor(a):
                ____________________________________ Semana: ____/____/____</p>

            <div class="grid grid-cols-5 gap-2 border border-gray-300">
                <div v-for="day in days" :key="day"
                    class="font-bold text-center p-2 border-b border-gray-300 bg-gray-50">{{ day }}</div>

                <template v-for="period in 5">
                    <div v-for="(day, dIndex) in days" :key="dIndex + '-' + period"
                        class="h-32 p-2 border border-dotted border-gray-200 text-xs">
                        <div v-if="getSlot(dIndex, period).subject">
                            <div class="font-bold mb-1">{{ getSlot(dIndex, period).turma }} - {{ getSlot(dIndex,
                                period).subject }}</div>
                            <div class="text-gray-600">{{ getSlot(dIndex, period).objective }}</div>
                            <div class="mt-1 text-gray-400 font-mono text-[9px]">{{ getSlot(dIndex, period).bncc }}
                            </div>
                        </div>
                    </div>
                </template>
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref } = Vue;

        createApp({
            setup() {
                const days = ['Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta'];
                const slots = ref({}); // key format: "dayIndex-period"
                const editing = ref(null);

                // Initialize empty slots
                const getSlotKey = (d, p) => `${d}-${p}`;

                const getSlot = (d, p) => {
                    const key = getSlotKey(d, p);
                    if (!slots.value[key]) {
                        slots.value[key] = { turma: '', subject: '', objective: '', bncc: '' };
                    }
                    return slots.value[key];
                };

                const editSlot = (d, p) => {
                    const key = getSlotKey(d, p);
                    // Clone to avoid reactive editing before save
                    editing.value = {
                        key: key,
                        data: { ...getSlot(d, p) }
                    };
                };

                const saveSlot = () => {
                    if (editing.value) {
                        slots.value[editing.value.key] = { ...editing.value.data };
                        editing.value = null;
                    }
                };

                const deleteSlot = () => {
                    if (editing.value) {
                        slots.value[editing.value.key] = { turma: '', subject: '', objective: '', bncc: '' };
                        editing.value = null;
                    }
                };

                const clearWeek = () => {
                    if (confirm("Deseja limpar todo o planejamento da semana?")) {
                        slots.value = {};
                    }
                };

                const printPlan = () => {
                    window.print();
                };

                return {
                    days, getSlot, editing, editSlot, saveSlot, deleteSlot, clearWeek, printPlan
                };
            }
        }).mount('#app');
    </script>
</body>

</html>