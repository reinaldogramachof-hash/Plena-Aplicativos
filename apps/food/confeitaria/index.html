<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confeitaria Lucrativa | Plena Apps</title>
    <!-- LIBS -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
        }

        h1,
        h2 {
            font-family: 'Pacifico', cursive;
        }

        [v-cloak] {
            display: none;
        }

        .candy-bg {
            background-color: #fce7f3;
        }

        .gradient-header {
            background: linear-gradient(135deg, #ec4899 0%, #be185d 100%);
        }
    </style>
</head>

<body class="candy-bg text-pink-900">

    <div id="app" v-cloak class="max-w-md mx-auto min-h-screen bg-white shadow-2xl flex flex-col relative">

        <!-- HEADER -->
        <header class="gradient-header text-white p-6 pb-12 rounded-b-[40px] shadow-lg relative z-10">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl drop-shadow-md flex items-center gap-2">
                    <i class="fa-solid fa-cake-candles"></i> Confeitaria
                </h1>
                <div class="bg-white/20 p-2 rounded-full cursor-pointer hover:bg-white/30 transition shadow-inner">
                    <i class="fa-solid fa-cog text-white"></i>
                </div>
            </div>
            <p class="text-pink-100 text-sm mt-1 font-bold ml-1">Precifique e Lucre com seus Doces 游븨</p>
        </header>

        <!-- MAIN CONTENT -->
        <main class="flex-grow px-4 -mt-8 relative z-20 pb-24 overflow-y-auto">

            <!-- TABS -->
            <div class="flex justify-center gap-4 mb-6">
                <button @click="currentTab = 'calc'"
                    :class="currentTab === 'calc' ? 'bg-pink-600 text-white shadow-lg' : 'bg-white text-pink-400 border border-pink-100'"
                    class="px-6 py-3 rounded-full font-bold text-sm transition-all w-1/2 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-calculator"></i> Precificar
                </button>
                <button @click="currentTab = 'menu'"
                    :class="currentTab === 'menu' ? 'bg-pink-600 text-white shadow-lg' : 'bg-white text-pink-400 border border-pink-100'"
                    class="px-6 py-3 rounded-full font-bold text-sm transition-all w-1/2 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-store"></i> Card치pio
                </button>
            </div>

            <!-- CALCULATOR TAB -->
            <div v-if="currentTab === 'calc'" class="animate-fade-in">

                <div class="bg-white p-5 rounded-2xl shadow-lg border border-pink-50 mb-4">
                    <h3 class="font-bold text-pink-600 mb-3 flex items-center gap-2">
                        <span class="bg-pink-100 w-6 h-6 rounded-full flex items-center justify-center text-xs">1</span>
                        Nova Receita
                    </h3>
                    <input v-model="recipe.name" type="text" placeholder="Nome do Doce (ex: Bolo de Cenoura)"
                        class="w-full border border-pink-200 rounded-xl p-3 text-sm focus:border-pink-500 outline-none mb-3 bg-pink-50/30">

                    <label class="block text-xs font-bold text-pink-400 mb-1">Custo dos Ingredientes (R$)</label>
                    <input v-model.number="recipe.cost" type="number" placeholder="0.00"
                        class="w-full border border-pink-200 rounded-xl p-3 text-lg font-bold text-pink-700 bg-pink-50/50 mb-3">

                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-xs font-bold text-pink-400 mb-1">Rendimento (Un)</label>
                            <input v-model.number="recipe.yield" type="number" placeholder="Ex: 10"
                                class="w-full border rounded-xl p-2 text-center">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-pink-400 mb-1">Lucro Desejado (%)</label>
                            <input v-model.number="recipe.profitMargin" type="number" placeholder="100%"
                                class="w-full border rounded-xl p-2 text-center text-green-600 font-bold">
                        </div>
                    </div>
                </div>

                <!-- RESULTS CARD -->
                <div
                    class="bg-gradient-to-br from-purple-600 to-pink-600 text-white p-5 rounded-2xl shadow-xl relative overflow-hidden">
                    <div class="absolute -right-4 -top-4 text-white/10 text-9xl rotate-12"><i
                            class="fa-solid fa-tag"></i></div>

                    <p class="text-pink-200 text-xs font-bold uppercase mb-1">Pre칞o de Venda Sugerido (Un)</p>
                    <div class="text-4xl font-bold mb-2">R$ {{ suggestedPrice }}</div>

                    <div class="flex gap-4 text-xs font-bold text-pink-100/80 border-t border-white/20 pt-2 mt-2">
                        <span>Custo: R$ {{ unitCost }}</span>
                        <span>Lucro: R$ {{ unitProfit }}</span>
                    </div>

                    <button @click="addToMenu"
                        class="mt-4 w-full bg-white text-pink-600 font-bold py-2 rounded-lg hover:bg-pink-50 transition shadow-md text-sm uppercase">
                        <i class="fa-solid fa-plus-circle"></i> Adicionar ao Card치pio
                    </button>
                </div>

            </div>

            <!-- MENU TAB -->
            <div v-if="currentTab === 'menu'" class="animate-fade-in">

                <div v-if="menu.length === 0" class="text-center py-10 opacity-50">
                    <i class="fa-solid fa-cookie-bite text-6xl text-pink-300 mb-4"></i>
                    <p>Seu card치pio est치 vazio!</p>
                    <p class="text-sm">Cadastre receitas na aba Precificar.</p>
                </div>

                <div v-else class="space-y-4">
                    <div v-for="(item, idx) in menu" :key="idx"
                        class="bg-white p-4 rounded-xl shadow-sm border border-pink-100 flex justify-between items-center group">
                        <div>
                            <h4 class="font-bold text-pink-800">{{ item.name }}</h4>
                            <p class="text-xs text-pink-400">R$ {{ item.price.toFixed(2) }} / un</p>
                        </div>
                        <button @click="removeFromMenu(idx)" class="text-pink-300 hover:text-red-400 p-2"><i
                                class="fa-solid fa-trash"></i></button>
                    </div>

                    <!-- WHATSAPP CTA -->
                    <div class="bg-green-100 border border-green-200 p-4 rounded-xl mt-6 text-center">
                        <h3 class="text-green-800 font-bold mb-2">Divulgar Agora!</h3>
                        <button @click="shareMenu"
                            class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-xl shadow-lg transition flex items-center justify-center gap-2 animate-bounce-subtle">
                            <i class="fa-brands fa-whatsapp text-xl"></i> Enviar Card치pio
                        </button>
                    </div>
                </div>

            </div>

        </main>

    </div>

    <script>
        const { createApp, ref, computed, onMounted, watch } = Vue;

        createApp({
            setup() {
                const currentTab = ref('calc');
                const menu = ref([]);

                const recipe = ref({
                    name: '',
                    cost: '',
                    yield: '',
                    profitMargin: 100
                });

                // --- PERSISTENCE ---
                onMounted(() => {
                    const saved = localStorage.getItem('confeitaria_menu');
                    if (saved) menu.value = JSON.parse(saved);
                });

                watch(menu, (newVal) => {
                    localStorage.setItem('confeitaria_menu', JSON.stringify(newVal));
                }, { deep: true });


                // --- COMPUTED ---
                const unitCost = computed(() => {
                    if (!recipe.value.cost || !recipe.value.yield) return "0.00";
                    return (recipe.value.cost / recipe.value.yield).toFixed(2);
                });

                const suggestedPrice = computed(() => {
                    const cost = Number(unitCost.value);
                    if (cost === 0) return "0.00";
                    const margin = 1 + (recipe.value.profitMargin / 100);
                    return (cost * margin).toFixed(2);
                });

                const unitProfit = computed(() => {
                    const price = Number(suggestedPrice.value);
                    const cost = Number(unitCost.value);
                    return (price - cost).toFixed(2);
                });

                // --- ACTIONS ---
                const addToMenu = () => {
                    if (!recipe.value.name || Number(suggestedPrice.value) <= 0) return alert('Preencha os dados corretamente!');

                    menu.value.push({
                        name: recipe.value.name,
                        price: Number(suggestedPrice.value)
                    });

                    recipe.value.name = '';
                    recipe.value.cost = '';
                    recipe.value.yield = '';
                    alert('Adicionado ao Card치pio! 游븨');
                    currentTab.value = 'menu';
                };

                const removeFromMenu = (idx) => {
                    if (confirm('Remover este item?')) menu.value.splice(idx, 1);
                };

                const shareMenu = () => {
                    let text = `*游븨 CARD츼PIO DE HOJE 游븨*\n\n`;
                    text += `Ol치! Confira nossas del칤cias fresquinhas:\n\n`;

                    menu.value.forEach(item => {
                        text += `游꼻 *${item.name}* ............ R$ ${item.price.toFixed(2)}\n`;
                    });

                    text += `\n_Fa칞a seu pedido por aqui!_`;

                    const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
                    window.open(url, '_blank');
                };

                return {
                    currentTab, menu, recipe, unitCost, suggestedPrice, unitProfit,
                    addToMenu, removeFromMenu, shareMenu
                };
            }
        }).mount('#app');
    </script>
</body>

</html>