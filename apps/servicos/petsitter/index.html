<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pet Sitter Pro | Plena Apps</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #fdf2f8;
            font-family: 'Fredoka', sans-serif;
        }

        [v-cloak] {
            display: none;
        }
    </style>
    <script src="../../../assets/js/plena-lock.js"></script>
</head>

<body class="pb-20">

    <div id="app" v-cloak class="max-w-md mx-auto min-h-screen bg-white shadow-xl flex flex-col">

        <header class="bg-pink-400 text-white p-6 shadow-md rounded-b-[40px] mb-6 relative">
            <h1 class="text-3xl font-bold text-center"><i class="fa-solid fa-paw"></i> Pet Sitter</h1>
            <p class="text-center text-pink-100 text-sm">DiÃ¡rio de Bordo</p>
            <div class="absolute top-4 right-4 flex gap-2">
                <button @click="backupData" class="bg-pink-500 hover:bg-pink-600 p-2 rounded-full transition text-xs"
                    title="Backup"><i class="fa-solid fa-download"></i></button>
                <label class="bg-pink-500 hover:bg-pink-600 p-2 rounded-full transition text-xs cursor-pointer"
                    title="Restore">
                    <i class="fa-solid fa-upload"></i>
                    <input type="file" @change="restoreData" class="hidden" accept=".json">
                </label>
            </div>
        </header>

        <!-- PET SELECTOR -->
        <div class="px-6 mb-6 text-center">
            <input v-model="petName"
                class="w-full text-center text-2xl font-bold text-gray-700 border-b-2 border-pink-200 outline-none focus:border-pink-500 bg-transparent placeholder-gray-300"
                placeholder="Nome do Pet">
        </div>

        <!-- ACTIONS GRID -->
        <div class="px-6 grid grid-cols-2 gap-4 mb-8">
            <button @click="addLog('walk')"
                class="bg-green-100 hover:bg-green-200 p-4 rounded-2xl flex flex-col items-center gap-2 transition">
                <span class="text-3xl">ðŸ¦®</span>
                <span class="font-bold text-green-700">Passeio</span>
            </button>
            <button @click="addLog('food')"
                class="bg-orange-100 hover:bg-orange-200 p-4 rounded-2xl flex flex-col items-center gap-2 transition">
                <span class="text-3xl">ðŸ¥£</span>
                <span class="font-bold text-orange-700">Comida</span>
            </button>
            <button @click="addLog('pee')"
                class="bg-yellow-100 hover:bg-yellow-200 p-4 rounded-2xl flex flex-col items-center gap-2 transition">
                <span class="text-3xl">ðŸ’¦</span>
                <span class="font-bold text-yellow-700">Xixi</span>
            </button>
            <button @click="addLog('poop')"
                class="bg-gray-100 hover:bg-gray-200 p-4 rounded-2xl flex flex-col items-center gap-2 transition">
                <span class="text-3xl">ðŸ’©</span>
                <span class="font-bold text-gray-700">CocÃ´</span>
            </button>
            <button @click="addLog('meds')"
                class="bg-blue-100 hover:bg-blue-200 p-4 rounded-2xl flex flex-col items-center gap-2 transition col-span-2">
                <span class="text-3xl">ðŸ’Š</span>
                <span class="font-bold text-blue-700">RemÃ©dio / Cuidados</span>
            </button>
        </div>

        <!-- TIMELINE -->
        <div class="px-6 flex-grow">
            <h3 class="font-bold text-gray-400 text-sm uppercase mb-4">Hoje</h3>

            <div class="space-y-4 border-l-2 border-pink-100 pl-4 ml-2">
                <div v-for="(log, idx) in logs" :key="idx" class="relative group">
                    <div class="absolute -left-[25px] top-0 bg-white border-2 border-pink-300 w-4 h-4 rounded-full">
                    </div>
                    <div class="flex justify-between items-start">
                        <div>
                            <span class="font-bold text-gray-700 text-lg">{{ getEmoji(log.type) }} {{ getLabel(log.type)
                                }}</span>
                            <p class="text-xs text-gray-400">{{ log.time }}</p>
                        </div>
                        <button @click="logs.splice(idx,1)"
                            class="opacity-0 group-hover:opacity-100 text-red-300 hover:text-red-500"><i
                                class="fa-solid fa-trash"></i></button>
                    </div>
                </div>
            </div>
            <div v-if="logs.length === 0" class="text-center text-gray-300 italic py-4">Nenhuma atividade registrada
                hoje.</div>
        </div>

        <!-- FOOTER -->
        <div class="p-6">
            <button @click="shareWhatsapp"
                class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-4 rounded-full shadow-lg flex items-center justify-center gap-2 transition hover:scale-105">
                <i class="fa-brands fa-whatsapp text-2xl"></i> Enviar RelatÃ³rio
            </button>
        </div>

    </div>

    <script>
        const { createApp, ref, onMounted, watch } = Vue;

        createApp({
            setup() {
                const petName = ref('');
                const logs = ref([]);

                const addLog = (type) => {
                    logs.value.unshift({
                        type: type,
                        time: new Date().toLocaleTimeString().slice(0, 5),
                        date: new Date().toLocaleDateString()
                    });
                };

                const getEmoji = (t) => {
                    const m = { walk: 'ðŸ¦®', food: 'ðŸ¥£', pee: 'ðŸ’¦', poop: 'ðŸ’©', meds: 'ðŸ’Š' };
                    return m[t] || 'ðŸ¾';
                };

                const getLabel = (t) => {
                    const m = { walk: 'Passeio', food: 'AlimentaÃ§Ã£o', pee: 'Xixi', poop: 'CocÃ´', meds: 'MedicaÃ§Ã£o' };
                    return m[t] || 'Geral';
                };

                const shareWhatsapp = () => {
                    let text = `ðŸ¾ *DiÃ¡rio do Pet: ${petName.value || 'AmigÃ£o'}* ðŸ¾\n` +
                        `ðŸ“… ${new Date().toLocaleDateString()}\n\n`;

                    logs.value.forEach(l => {
                        text += `${getEmoji(l.type)} ${l.time} - ${getLabel(l.type)}\n`;
                    });

                    text += `\n_Cuidando com amor!_ â¤ï¸`;
                    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
                };

                // Backup
                const backupData = () => {
                    const blob = new Blob([JSON.stringify({ logs: logs.value, pet: petName.value })], { type: "application/json" });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = `backup_pet_${Date.now()}.json`;
                    a.click();
                };

                const restoreData = (e) => {
                    const f = e.target.files[0];
                    if (!f) return;
                    const r = new FileReader();
                    r.onload = (v) => { try { const d = JSON.parse(v.target.result); logs.value = d.logs; petName.value = d.pet; alert("Restaurado!"); } catch (e) { alert("Erro!"); } };
                    r.readAsText(f);
                };

                // Storage
                onMounted(() => {
                    const d = localStorage.getItem('plena_pet');
                    if (d) {
                        const parsed = JSON.parse(d);
                        logs.value = parsed.logs;
                        petName.value = parsed.pet;
                    }
                });

                watch([logs, petName], () => {
                    localStorage.setItem('plena_pet', JSON.stringify({ logs: logs.value, pet: petName.value }));
                }, { deep: true });

                return {
                    petName, logs,
                    addLog, getEmoji, getLabel, shareWhatsapp, backupData, restoreData
                };
            }
        }).mount('#app');
    </script>
</body>

</html>