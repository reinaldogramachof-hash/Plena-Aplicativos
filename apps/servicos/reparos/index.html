<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Reparos | Plena Apps</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background-color: #fbbf24;
            font-family: 'Segoe UI', sans-serif;
        }

        [v-cloak] {
            display: none;
        }
    </style>
</head>

<body class="pb-20">

    <div id="app" v-cloak class="max-w-md mx-auto min-h-screen bg-gray-900 text-white shadow-xl flex flex-col">

        <header class="bg-gray-800 border-b border-gray-700 p-6 flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold text-yellow-500"><i class="fa-solid fa-screwdriver-wrench"></i> SOS
                    Reparos</h1>
                <p class="text-gray-400 text-xs">Or√ßamentos R√°pidos</p>
            </div>
            <button @click="resetConfig" class="text-gray-400 hover:text-white"><i
                    class="fa-solid fa-rotate-right"></i></button>
        </header>

        <div class="p-6 space-y-6 flex-grow">

            <!-- LABOR -->
            <div class="bg-gray-800 p-4 rounded-xl border border-gray-700">
                <h3 class="font-bold text-yellow-500 text-sm uppercase mb-3"><i class="fa-solid fa-helmet-safety"></i>
                    M√£o de Obra</h3>
                <div class="space-y-3">
                    <div v-for="(item, idx) in laborItems" :key="idx" class="flex gap-2">
                        <input v-model="item.desc"
                            class="flex-grow bg-gray-900 border border-gray-600 rounded p-2 text-sm outline-none focus:border-yellow-500"
                            placeholder="Descri√ß√£o do servi√ßo...">
                        <input v-model.number="item.price" type="number"
                            class="w-24 bg-gray-900 border border-gray-600 rounded p-2 text-sm text-right outline-none focus:border-yellow-500"
                            placeholder="R$">
                        <button @click="removeLabor(idx)" class="text-red-400 px-2"><i
                                class="fa-solid fa-xmark"></i></button>
                    </div>
                    <button @click="addLabor" class="text-yellow-500 text-xs font-bold hover:text-yellow-400">+
                        Adicionar Servi√ßo</button>
                </div>
            </div>

            <!-- PARTS -->
            <div class="bg-gray-800 p-4 rounded-xl border border-gray-700">
                <h3 class="font-bold text-blue-400 text-sm uppercase mb-3"><i class="fa-solid fa-bolt"></i> Materiais /
                    Pe√ßas</h3>
                <div class="space-y-3">
                    <div v-for="(item, idx) in partItems" :key="idx" class="flex gap-2">
                        <input v-model="item.desc"
                            class="flex-grow bg-gray-900 border border-gray-600 rounded p-2 text-sm outline-none focus:border-blue-500"
                            placeholder="Pe√ßa ou Material...">
                        <input v-model.number="item.price" type="number"
                            class="w-24 bg-gray-900 border border-gray-600 rounded p-2 text-sm text-right outline-none focus:border-blue-500"
                            placeholder="R$">
                        <button @click="removePart(idx)" class="text-red-400 px-2"><i
                                class="fa-solid fa-xmark"></i></button>
                    </div>
                    <button @click="addPart" class="text-blue-500 text-xs font-bold hover:text-blue-400">+ Adicionar
                        Material</button>
                </div>
            </div>

            <!-- SUMMARY -->
            <div class="border-t border-gray-700 pt-4">
                <h2 class="text-right text-gray-400 text-sm">Total do Or√ßamento</h2>
                <div class="text-right text-4xl font-bold text-yellow-400">R$ {{ total.toFixed(2) }}</div>
            </div>

        </div>

        <div class="bg-gray-800 p-4 sticky bottom-0 border-t border-gray-700">
            <button @click="shareBudget"
                class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded-lg shadow flex items-center justify-center gap-2">
                <i class="fa-brands fa-whatsapp"></i> Enviar para Cliente
            </button>
        </div>

    </div>

    <script>
        const { createApp, ref, computed } = Vue;

        createApp({
            setup() {
                const laborItems = ref([{ desc: '', price: '' }]);
                const partItems = ref([{ desc: '', price: '' }]);

                const addLabor = () => laborItems.value.push({ desc: '', price: '' });
                const addPart = () => partItems.value.push({ desc: '', price: '' });

                const removeLabor = (i) => laborItems.value.length > 1 ? laborItems.value.splice(i, 1) : laborItems.value[0] = { desc: '', price: '' };
                const removePart = (i) => partItems.value.length > 1 ? partItems.value.splice(i, 1) : partItems.value[0] = { desc: '', price: '' };

                const total = computed(() => {
                    const l = laborItems.value.reduce((a, b) => a + (b.price || 0), 0);
                    const p = partItems.value.reduce((a, b) => a + (b.price || 0), 0);
                    return l + p;
                });

                const resetConfig = () => {
                    if (confirm("Limpar or√ßamento?")) {
                        laborItems.value = [{ desc: '', price: '' }];
                        partItems.value = [{ desc: '', price: '' }];
                    }
                };

                const shareBudget = () => {
                    if (total.value === 0) return alert("Preencha o or√ßamento!");

                    let text = `üõ†Ô∏è *Or√ßamento SOS Reparos*\n\n`;

                    if (laborItems.value.some(i => i.price)) {
                        text += `*Servi√ßos:*\n`;
                        laborItems.value.forEach(i => { if (i.desc) text += `- ${i.desc}: R$ ${(i.price || 0).toFixed(2)}\n`; });
                    }

                    if (partItems.value.some(i => i.price)) {
                        text += `\n*Materiais:*\n`;
                        partItems.value.forEach(i => { if (i.desc) text += `- ${i.desc}: R$ ${(i.price || 0).toFixed(2)}\n`; });
                    }

                    text += `\nüí∞ *Total Estimado: R$ ${total.value.toFixed(2)}*`;
                    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
                };

                return { laborItems, partItems, addLabor, addPart, removeLabor, removePart, total, shareBudget, resetConfig };
            }
        }).mount('#app');
    </script>
</body>

</html>