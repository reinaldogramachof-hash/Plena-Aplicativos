<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f172a">
    <title>SOS Reparos | Plena</title>
    <!-- CDNs Padr√£o -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Fonte Inter -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        [v-cloak] {
            display: none;
        }
    </style>
    <script src="../../../assets/js/plena-lock.js"></script>
</head>

<body class="bg-slate-50 text-slate-800 h-screen overflow-hidden">
    <div id="app" v-cloak class="flex h-full">

        <!-- SIDEBAR -->
        <aside
            :class="['fixed inset-y-0 left-0 z-50 w-64 bg-slate-900 text-white transition-transform lg:static lg:translate-x-0 flex flex-col', isMenuOpen ? 'translate-x-0' : '-translate-x-full']">
            <!-- Logo -->
            <div class="p-6 border-b border-slate-800 flex items-center gap-3">
                <div class="bg-blue-600 p-2 rounded-lg"><i class="fa-solid fa-screwdriver-wrench"></i></div>
                <span class="font-bold text-lg leading-tight">SOS Reparos</span>
            </div>
            <!-- Menu -->
            <nav class="flex-1 p-4 space-y-2">
                <button class="w-full text-left px-4 py-3 rounded-xl bg-white/10 text-white font-bold"><i
                        class="fa-solid fa-home mr-2"></i> Or√ßamento</button>
                <div class="px-4 pt-4 text-xs text-slate-500 uppercase font-bold">A√ß√µes</div>
                <button @click="resetConfig"
                    class="w-full text-left px-4 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition"><i
                        class="fa-solid fa-trash mr-2"></i> Limpar Tudo</button>
            </nav>
            <!-- Voltar Loja -->
            <div class="p-4 border-t border-slate-800">
                <a href="../../../index.html"
                    class="flex items-center gap-2 text-slate-400 hover:text-white transition px-4 py-2">
                    <i class="fa-solid fa-arrow-left"></i> Voltar √† Loja
                </a>
            </div>
        </aside>

        <!-- OVERLAY MOBILE -->
        <div v-if="isMenuOpen" @click="isMenuOpen = false" class="fixed inset-0 bg-black/50 z-40 lg:hidden"></div>

        <!-- CONTE√öDO PRINCIPAL -->
        <main class="flex-1 flex flex-col relative w-full">
            <!-- Header Mobile -->
            <header class="lg:hidden bg-white p-4 border-b flex justify-between items-center shadow-sm">
                <button @click="isMenuOpen = true" class="text-slate-600"><i
                        class="fa-solid fa-bars text-xl"></i></button>
                <span class="font-bold text-slate-800">SOS Reparos</span>
                <div class="w-6"></div>
            </header>

            <!-- √Årea de Trabalho (Scroll√°vel) -->
            <div class="flex-1 overflow-y-auto p-4 lg:p-8">

                <div class="max-w-2xl mx-auto space-y-6">

                    <!-- Header da P√°gina -->
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">Novo Or√ßamento</h2>
                            <p class="text-slate-500 text-sm">Liste servi√ßos e materiais abaixo.</p>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-slate-400 uppercase font-bold">Total Estimado</div>
                            <div class="text-3xl font-bold text-blue-600">R$ {{ total.toFixed(2) }}</div>
                        </div>
                    </div>

                    <!-- LABOR -->
                    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                        <div class="bg-slate-50 px-6 py-4 border-b border-slate-200 flex justify-between items-center">
                            <h3 class="font-bold text-slate-700 flex items-center gap-2"><i
                                    class="fa-solid fa-helmet-safety text-orange-500"></i> M√£o de Obra</h3>
                        </div>
                        <div class="p-6 space-y-4">
                            <div v-for="(item, idx) in laborItems" :key="idx"
                                class="flex gap-3 items-center animate-fade-in">
                                <span class="text-slate-400 text-xs font-bold w-4">{{ idx + 1 }}.</span>
                                <input v-model="item.desc"
                                    class="flex-grow bg-slate-50 border border-slate-200 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-blue-500 transition text-sm"
                                    placeholder="Descri√ß√£o do servi√ßo...">
                                <div class="relative w-28">
                                    <span class="absolute left-3 top-2.5 text-slate-400 text-sm">R$</span>
                                    <input v-model.number="item.price" type="number"
                                        class="w-full bg-slate-50 border border-slate-200 rounded-xl pl-8 pr-3 py-2.5 outline-none focus:ring-2 focus:ring-blue-500 transition text-sm font-bold text-slate-700"
                                        placeholder="0.00">
                                </div>
                                <button @click="removeLabor(idx)"
                                    class="text-slate-300 hover:text-red-500 transition px-1"><i
                                        class="fa-solid fa-trash-can"></i></button>
                            </div>
                            <button @click="addLabor"
                                class="w-full py-3 border-2 border-dashed border-slate-200 rounded-xl text-slate-400 font-bold text-sm hover:border-blue-400 hover:text-blue-500 transition flex items-center justify-center gap-2">
                                <i class="fa-solid fa-plus"></i> Adicionar Servi√ßo
                            </button>
                        </div>
                    </div>

                    <!-- PARTS -->
                    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                        <div class="bg-slate-50 px-6 py-4 border-b border-slate-200 flex justify-between items-center">
                            <h3 class="font-bold text-slate-700 flex items-center gap-2"><i
                                    class="fa-solid fa-box-open text-blue-500"></i> Materiais</h3>
                        </div>
                        <div class="p-6 space-y-4">
                            <div v-for="(item, idx) in partItems" :key="idx"
                                class="flex gap-3 items-center animate-fade-in">
                                <span class="text-slate-400 text-xs font-bold w-4">{{ idx + 1 }}.</span>
                                <input v-model="item.desc"
                                    class="flex-grow bg-slate-50 border border-slate-200 rounded-xl px-4 py-2.5 outline-none focus:ring-2 focus:ring-blue-500 transition text-sm"
                                    placeholder="Nome do material...">
                                <div class="relative w-28">
                                    <span class="absolute left-3 top-2.5 text-slate-400 text-sm">R$</span>
                                    <input v-model.number="item.price" type="number"
                                        class="w-full bg-slate-50 border border-slate-200 rounded-xl pl-8 pr-3 py-2.5 outline-none focus:ring-2 focus:ring-blue-500 transition text-sm font-bold text-slate-700"
                                        placeholder="0.00">
                                </div>
                                <button @click="removePart(idx)"
                                    class="text-slate-300 hover:text-red-500 transition px-1"><i
                                        class="fa-solid fa-trash-can"></i></button>
                            </div>
                            <button @click="addPart"
                                class="w-full py-3 border-2 border-dashed border-slate-200 rounded-xl text-slate-400 font-bold text-sm hover:border-blue-400 hover:text-blue-500 transition flex items-center justify-center gap-2">
                                <i class="fa-solid fa-plus"></i> Adicionar Material
                            </button>
                        </div>
                    </div>

                </div>

                <!-- Spacer for FAB -->
                <div class="h-20"></div>
            </div>

            <!-- Bot√£o Flutuante (Action) -->
            <div class="fixed bottom-6 right-20 z-40">
                <button @click="shareBudget"
                    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-full shadow-xl font-bold flex items-center gap-2 transition transform hover:scale-105">
                    <i class="fa-solid fa-share-nodes"></i> Gerar Or√ßamento
                </button>
            </div>

            <!-- Bot√£o Flutuante (Suporte) -->
            <a href="https://wa.me/5567993333999" target="_blank"
                class="fixed bottom-6 right-4 bg-green-500 hover:bg-green-600 text-white w-14 h-14 rounded-full shadow-xl flex items-center justify-center text-3xl transition transform hover:scale-110 z-50">
                <i class="fa-brands fa-whatsapp"></i>
            </a>
        </main>
    </div>

    <script>
        const { createApp, ref, computed } = Vue;
        createApp({
            setup() {
                const isMenuOpen = ref(false);

                // --- L√≥gica Original do SOS Reparos ---
                const laborItems = ref([{ desc: '', price: '' }]);
                const partItems = ref([{ desc: '', price: '' }]);

                const addLabor = () => laborItems.value.push({ desc: '', price: '' });
                const addPart = () => partItems.value.push({ desc: '', price: '' });

                const removeLabor = (i) => laborItems.value.length > 1 ? laborItems.value.splice(i, 1) : laborItems.value[0] = { desc: '', price: '' };
                const removePart = (i) => partItems.value.length > 1 ? partItems.value.splice(i, 1) : partItems.value[0] = { desc: '', price: '' };

                const total = computed(() => {
                    const l = laborItems.value.reduce((a, b) => a + (b.price || 0), 0);
                    const p = partItems.value.reduce((a, b) => a + (b.price || 0), 0);
                    return l + p;
                });

                const resetConfig = () => {
                    if (confirm("Limpar or√ßamento?")) {
                        laborItems.value = [{ desc: '', price: '' }];
                        partItems.value = [{ desc: '', price: '' }];
                    }
                };

                const shareBudget = () => {
                    if (total.value === 0) return alert("Preencha o or√ßamento!");
                    let text = `üõ†Ô∏è *Or√ßamento SOS Reparos*\n\n`;
                    if (laborItems.value.some(i => i.price)) {
                        text += `*Servi√ßos:*\n`;
                        laborItems.value.forEach(i => { if (i.desc) text += `- ${i.desc}: R$ ${(i.price || 0).toFixed(2)}\n`; });
                    }
                    if (partItems.value.some(i => i.price)) {
                        text += `\n*Materiais:*\n`;
                        partItems.value.forEach(i => { if (i.desc) text += `- ${i.desc}: R$ ${(i.price || 0).toFixed(2)}\n`; });
                    }
                    text += `\nüí∞ *Total Estimado: R$ ${total.value.toFixed(2)}*`;
                    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
                };

                return { isMenuOpen, laborItems, partItems, addLabor, addPart, removeLabor, removePart, total, shareBudget, resetConfig }
            }
        }).mount('#app');
    </script>
    <style>
        .animate-fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</body>

</html>