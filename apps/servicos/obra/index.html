<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Obra F√°cil | Plena</title>
    <!-- CDNs -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        [v-cloak] {
            display: none;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800 h-screen overflow-hidden">

    <div id="app" v-cloak class="flex h-full">

        <!-- SIDEBAR -->
        <aside
            :class="['fixed inset-y-0 left-0 z-50 w-64 bg-slate-900 text-white transition-transform lg:static lg:translate-x-0 flex flex-col', isMenuOpen ? 'translate-x-0' : '-translate-x-full']">
            <div class="p-6 border-b border-slate-800 flex items-center gap-3">
                <div class="bg-yellow-500 p-2 rounded-lg text-slate-900"><i class="fa-solid fa-hammer"></i></div>
                <span class="font-bold text-lg leading-tight">Obra F√°cil</span>
            </div>
            <nav class="flex-1 p-4 space-y-2">
                <button
                    class="w-full text-left px-4 py-3 rounded-xl bg-white/10 text-white font-bold flex items-center gap-2">
                    <i class="fa-solid fa-calculator"></i> Or√ßamento
                </button>
                <div class="px-4 py-2 text-slate-500 text-xs uppercase font-bold mt-4">A√ß√µes</div>
                <button @click="resetForm"
                    class="w-full text-left px-4 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition flex items-center gap-2">
                    <i class="fa-solid fa-trash"></i> Limpar Tudo
                </button>
            </nav>
            <div class="p-4 border-t border-slate-800">
                <a href="../../../index.html"
                    class="flex items-center gap-2 text-slate-400 hover:text-white transition px-4 py-2">
                    <i class="fa-solid fa-arrow-left"></i> Voltar √† Loja
                </a>
            </div>
        </aside>

        <!-- OVERLAY MOBILE -->
        <div v-if="isMenuOpen" @click="isMenuOpen = false" class="fixed inset-0 bg-black/50 z-40 lg:hidden"></div>

        <!-- MAIN CONTENT -->
        <main class="flex-1 flex flex-col relative w-full overflow-hidden">
            <!-- Header Mobile -->
            <header class="lg:hidden bg-white p-4 border-b flex justify-between items-center shadow-sm z-30">
                <button @click="isMenuOpen = true" class="text-slate-600"><i
                        class="fa-solid fa-bars text-xl"></i></button>
                <span class="font-bold text-slate-800">Obra F√°cil</span>
                <span class="w-6"></span>
            </header>

            <div class="flex-1 overflow-y-auto p-4 lg:p-8">

                <div class="max-w-4xl mx-auto space-y-6">

                    <div>
                        <h2 class="text-2xl font-bold text-slate-800">Novo Or√ßamento</h2>
                        <p class="text-sm text-slate-500">Calcule custos de m√£o de obra e liste materiais.</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                        <!-- Coluna 1: Dados -->
                        <div class="space-y-6">

                            <div
                                class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 relative overflow-hidden">
                                <div class="absolute top-0 left-0 w-1 h-full bg-yellow-500"></div>
                                <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2"><i
                                        class="fa-solid fa-user-hard-hat text-yellow-500"></i> Dados do Servi√ßo</h3>

                                <div class="space-y-4">
                                    <div>
                                        <label
                                            class="block text-xs font-bold text-slate-400 uppercase mb-1">Cliente</label>
                                        <input v-model="quote.client"
                                            class="w-full bg-slate-50 border-slate-200 rounded-xl p-3 outline-none focus:ring-2 focus:ring-yellow-400 transition text-sm"
                                            placeholder="Nome do Cliente">
                                    </div>
                                    <div>
                                        <label
                                            class="block text-xs font-bold text-slate-400 uppercase mb-1">Descri√ß√£o</label>
                                        <textarea v-model="quote.description" rows="3"
                                            class="w-full bg-slate-50 border-slate-200 rounded-xl p-3 outline-none focus:ring-2 focus:ring-yellow-400 transition text-sm"
                                            placeholder="Ex: Constru√ß√£o de Muro..."></textarea>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-xs font-bold text-slate-400 uppercase mb-1">M√£o de
                                                Obra (R$)</label>
                                            <input v-model="quote.laborCost" type="number"
                                                class="w-full bg-slate-50 border-slate-200 rounded-xl p-3 outline-none focus:ring-2 focus:ring-yellow-400 transition text-sm font-bold text-slate-700"
                                                placeholder="0.00">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Prazo
                                                (Dias)</label>
                                            <input v-model="quote.days" type="number"
                                                class="w-full bg-slate-50 border-slate-200 rounded-xl p-3 outline-none focus:ring-2 focus:ring-yellow-400 transition text-sm"
                                                placeholder="0">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-yellow-50 border border-yellow-100 rounded-2xl p-6 text-center">
                                <p class="text-xs text-yellow-600 font-bold uppercase mb-1">Total M√£o de Obra</p>
                                <div class="text-4xl font-bold text-yellow-600">R$ {{ totalCost }}</div>
                            </div>

                        </div>

                        <!-- Coluna 2: Materiais -->
                        <div class="space-y-6">
                            <div
                                class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 flex flex-col h-full">
                                <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2"><i
                                        class="fa-solid fa-boxes-stacked text-blue-500"></i> Lista de Materiais</h3>

                                <div class="flex-1 space-y-3 overflow-y-auto max-h-[400px] mb-4">
                                    <div v-for="(item, idx) in quote.materials" :key="idx"
                                        class="flex gap-2 items-center bg-slate-50 p-2 rounded-lg">
                                        <input v-model="item.name"
                                            class="flex-grow bg-transparent border-b border-transparent focus:border-blue-400 outline-none text-sm px-2"
                                            placeholder="Item (ex: Cimento)">
                                        <input v-model="item.qty"
                                            class="w-16 bg-white border border-slate-200 rounded-lg text-center text-sm py-1"
                                            placeholder="Qtd">
                                        <button @click="removeMaterial(idx)"
                                            class="text-slate-300 hover:text-red-400 px-2"><i
                                                class="fa-solid fa-xmark"></i></button>
                                    </div>
                                </div>

                                <button @click="addMaterial"
                                    class="w-full border-2 border-dashed border-slate-200 text-slate-400 font-bold py-3 rounded-xl hover:border-blue-400 hover:text-blue-500 transition text-sm flex items-center justify-center gap-2">
                                    <i class="fa-solid fa-plus"></i> Adicionar Material
                                </button>
                            </div>
                        </div>

                    </div>

                </div>
            </div>

            <!-- Bot√£o Flutuante -->
            <div class="fixed bottom-6 right-6 flex gap-3">
                <button @click="shareOnZap"
                    class="bg-green-500 hover:bg-green-600 text-white font-bold px-6 py-4 rounded-full shadow-xl shadow-green-500/20 flex items-center justify-center gap-2 transition transform hover:scale-105 z-50">
                    <i class="fa-brands fa-whatsapp text-xl"></i> <span class="hidden md:inline">Enviar Or√ßamento</span>
                </button>
            </div>

        </main>
    </div>

    <script>
        const { createApp, ref, computed } = Vue;

        createApp({
            setup() {
                const isMenuOpen = ref(false);
                const quote = ref({
                    client: '', description: '', laborCost: '', days: '',
                    materials: [{ name: '', qty: '' }]
                });

                const totalCost = computed(() => Number(quote.value.laborCost || 0).toFixed(2));

                const addMaterial = () => quote.value.materials.push({ name: '', qty: '' });

                const removeMaterial = (index) => {
                    if (quote.value.materials.length > 1) quote.value.materials.splice(index, 1);
                    else quote.value.materials[0] = { name: '', qty: '' };
                };

                const resetForm = () => {
                    if (confirm('Limpar tudo?')) {
                        quote.value = { client: '', description: '', laborCost: '', days: '', materials: [{ name: '', qty: '' }] };
                    }
                };

                const shareOnZap = () => {
                    if (!quote.value.client) return alert('Preencha o nome do cliente!');
                    const q = quote.value;
                    let text = `*OR√áAMENTO OBRA F√ÅCIL* üõ†Ô∏è\n\n`;
                    text += `üë§ *Cliente:* ${q.client}\n`;
                    text += `üìù *Servi√ßo:* ${q.description}\n`;
                    text += `‚è≥ *Prazo:* ${q.days} dias\n`;
                    text += `üí∞ *M√£o de Obra:* R$ ${q.laborCost}\n\n`;

                    if (q.materials.length > 0 && q.materials[0].name) {
                        text += `üì¶ *LISTA DE MATERIAIS:*\n`;
                        q.materials.forEach(m => { if (m.name) text += `- ${m.qty}x ${m.name}\n`; });
                    }
                    text += `\n_Gerado por Obra F√°cil_`;
                    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
                };

                return { isMenuOpen, quote, totalCost, addMaterial, removeMaterial, resetForm, shareOnZap };
            }
        }).mount('#app');
    </script>
</body>

</html>