<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Curiosidades | Plena Apps</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #4c1d95;
            font-family: 'Poppins', sans-serif;
            color: white;
        }

        [v-cloak] {
            display: none;
        }
    </style>
    <script src="../../../assets/js/plena-lock.js"></script>
</head>

<body class="flex items-center justify-center min-h-screen p-4">

    <div id="app" v-cloak
        class="w-full max-w-lg bg-white text-gray-900 rounded-3xl shadow-2xl overflow-hidden relative min-h-[500px] flex flex-col">

        <!-- HEADER -->
        <header class="bg-purple-600 p-6 text-white flex justify-between items-center relative z-10">
            <div>
                <h1 class="font-bold text-xl"><i class="fa-solid fa-brain"></i> Quiz Mania</h1>
                <p class="text-purple-200 text-xs">Teste seu conhecimento</p>
            </div>
            <div class="bg-black/20 px-3 py-1 rounded-full text-xs font-bold font-mono">
                {{ currentIndex + 1 }} / {{ questions.length }}
            </div>
        </header>

        <!-- START SCREEN -->
        <div v-if="!started"
            class="flex-grow flex flex-col items-center justify-center p-8 text-center animate-fade-in">
            <i class="fa-solid fa-circle-question text-6xl text-purple-500 mb-6 bounce"></i>
            <h2 class="text-2xl font-bold mb-2">Pronto para o desafio?</h2>
            <p class="text-gray-500 mb-8">Responda {{ questions.length }} perguntas e veja sua pontuaÃ§Ã£o final!</p>
            <button @click="started = true"
                class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 rounded-xl shadow-lg transition transform hover:scale-105">
                COMEÃ‡AR AGORA
            </button>
        </div>

        <!-- QUIZ SCREEN -->
        <div v-if="started && !finished" class="flex-grow flex flex-col p-6 animate-slide-left">
            <!-- Question -->
            <div class="mb-6">
                <h3 class="text-lg font-bold text-gray-800 leading-tight">{{ currentQuestion.text }}</h3>
            </div>

            <!-- Options -->
            <div class="space-y-3 flex-grow">
                <button v-for="(opt, idx) in currentQuestion.options" :key="idx" @click="checkAnswer(idx)"
                    :disabled="feedback !== null"
                    class="w-full p-4 rounded-xl border-2 text-left font-medium transition relative overflow-hidden"
                    :class="getOptionClass(idx)">

                    <span class="relative z-10">{{ opt }}</span>

                    <!-- Feedback Icon -->
                    <i v-if="feedback !== null && idx === currentQuestion.correct"
                        class="fa-solid fa-check absolute right-4 top-4 text-green-600 text-xl"></i>
                    <i v-if="feedback === false && idx === selectedIdx"
                        class="fa-solid fa-xmark absolute right-4 top-4 text-red-600 text-xl"></i>

                </button>
            </div>

            <!-- Next Button -->
            <button v-if="feedback !== null" @click="nextQuestion"
                class="mt-6 w-full bg-gray-900 text-white font-bold py-4 rounded-xl shadow-lg">
                {{ currentIndex === questions.length - 1 ? 'VER RESULTADO' : 'PRÃ“XIMA' }} <i
                    class="fa-solid fa-arrow-right ml-2"></i>
            </button>
        </div>

        <!-- RESULTS SCREEN -->
        <div v-if="finished"
            class="flex-grow flex flex-col items-center justify-center p-8 text-center animate-pulse-in">
            <div class="w-32 h-32 rounded-full flex items-center justify-center mb-6 border-8"
                :class="score > questions.length/2 ? 'border-green-500 text-green-500' : 'border-red-500 text-red-500'">
                <span class="text-4xl font-black">{{ score }}</span>
            </div>

            <h2 class="text-2xl font-bold mb-2">{{ scoreMessage }}</h2>
            <p class="text-gray-500 mb-8">VocÃª acertou {{ score }} de {{ questions.length }} questÃµes.</p>

            <div class="w-full space-y-3">
                <button @click="shareWhatsapp"
                    class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-xl shadow flex items-center justify-center gap-2">
                    <i class="fa-brands fa-whatsapp text-xl"></i> Compartilhar
                </button>
                <button @click="reset"
                    class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-3 rounded-xl">
                    Jogar Novamente
                </button>
            </div>
        </div>

        <!-- Backup btn (Small footer) -->
        <div class="absolute top-6 right-16 z-50">
            <button @click="backupData"
                class="bg-purple-700 w-8 h-8 rounded-full text-xs text-white/50 hover:text-white" title="Backup"><i
                    class="fa-solid fa-save"></i></button>
        </div>

    </div>

    <script>
        const { createApp, ref, computed } = Vue;

        createApp({
            setup() {
                const started = ref(false);
                const finished = ref(false);
                const currentIndex = ref(0);
                const score = ref(0);
                const feedback = ref(null); // null, true (correct), false (wrong)
                const selectedIdx = ref(null);

                const questions = ref([
                    { text: 'Qual o maior planeta do Sistema Solar?', options: ['Terra', 'JÃºpiter', 'Saturno', 'Sol'], correct: 1 },
                    { text: 'Quantos ossos tem o corpo humano adulto?', options: ['206', '300', '150', '210'], correct: 0 },
                    { text: 'Quem pintou a Mona Lisa?', options: ['Van Gogh', 'Picasso', 'Leonardo da Vinci', 'Michelangelo'], correct: 2 },
                    { text: 'Qual Ã© a capital da AustrÃ¡lia?', options: ['Sydney', 'Melbourne', 'Canberra', 'Perth'], correct: 2 },
                    { text: 'Qual metal Ã© lÃ­quido em temperatura ambiente?', options: ['Ferro', 'MercÃºrio', 'Ouro', 'Chumbo'], correct: 1 }
                ]);

                const currentQuestion = computed(() => questions.value[currentIndex.value]);

                const checkAnswer = (idx) => {
                    if (feedback.value !== null) return;
                    selectedIdx.value = idx;
                    const correct = idx === currentQuestion.value.correct;
                    feedback.value = correct;
                    if (correct) score.value++;
                };

                const getOptionClass = (idx) => {
                    if (feedback.value === null) return 'bg-gray-50 border-gray-100 hover:border-purple-300 hover:bg-purple-50';
                    if (idx === currentQuestion.value.correct) return 'bg-green-100 border-green-500 text-green-800';
                    if (idx === selectedIdx.value && !feedback.value) return 'bg-red-50 border-red-500 text-red-800 opacity-50';
                    return 'opacity-50 bg-gray-50';
                };

                const nextQuestion = () => {
                    if (currentIndex.value < questions.value.length - 1) {
                        currentIndex.value++;
                        feedback.value = null;
                        selectedIdx.value = null;
                    } else {
                        finished.value = true;
                    }
                };

                const scoreMessage = computed(() => {
                    const p = (score.value / questions.value.length) * 100;
                    if (p === 100) return 'Perfeito! ðŸ†';
                    if (p >= 70) return 'Muito Bom! ðŸ‘';
                    if (p >= 50) return 'Na MÃ©dia ðŸ‘';
                    return 'Tente de novo! ðŸ˜…';
                });

                const reset = () => {
                    started.value = false;
                    finished.value = false;
                    currentIndex.value = 0;
                    score.value = 0;
                    feedback.value = null;
                };

                const shareWhatsapp = () => {
                    const text = `ðŸ§  *Quiz Curiosidades*\n\nAcertei ${score.value} de ${questions.value.length} questÃµes!\nNÃ­vel: ${scoreMessage.value}\n\nConsegue me superar?`;
                    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
                };

                const backupData = () => {
                    // Backup questions (if user could edit them, which is not enabled here but useful for consistency)
                    const data = { questions: questions.value };
                    const blob = new Blob([JSON.stringify(data)], { type: "application/json" });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = `quiz_backup.json`;
                    a.click();
                };

                return {
                    started, finished, currentIndex, score, questions, currentQuestion, feedback, selectedIdx,
                    checkAnswer, getOptionClass, nextQuestion, scoreMessage, reset, shareWhatsapp, backupData
                };
            }
        }).mount('#app');
    </script>
</body>

</html>