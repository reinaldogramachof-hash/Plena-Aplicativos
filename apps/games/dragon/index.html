<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dragon Soundboard | Plena Apps</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #1a0b0b;
            font-family: 'Cinzel', serif;
            color: #fca5a5;
        }

        [v-cloak] {
            display: none;
        }

        .btn-rpg {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.1s;
        }

        .btn-rpg:active {
            transform: translateY(2px);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .playing {
            animation: pulse-red 1s infinite;
            border-color: #ef4444 !important;
        }

        @keyframes pulse-red {

            0%,
            100% {
                box-shadow: 0 0 10px #ef4444;
            }

            50% {
                box-shadow: 0 0 20px #dc2626;
            }
        }
    </style>
    <script src="../../../assets/js/plena-lock.js"></script>
</head>

<body class="pb-20">

    <div id="app" v-cloak
        class="max-w-4xl mx-auto min-h-screen bg-neutral-900 border-x-4 border-red-900 shadow-2xl flex flex-col relative overflow-hidden">

        <!-- BG DECORATION -->
        <div class="absolute inset-0 opacity-10 pointer-events-none"
            style="background-image: url('https://www.transparenttextures.com/patterns/dark-matter.png');"></div>

        <header class="p-8 text-center relative z-10 border-b-2 border-red-900/50">
            <h1 class="text-4xl font-bold text-red-500 tracking-widest drop-shadow-md"><i
                    class="fa-solid fa-dragon"></i> DRAGON SOUNDS</h1>
            <p class="text-xs text-red-400 mt-2 uppercase tracking-widest">Mestre de RPG Companion</p>
        </header>

        <!-- CONTROLS -->
        <div class="px-8 py-4 flex justify-between items-center bg-black/30 border-b border-red-900/30">
            <div class="flex items-center gap-4">
                <i class="fa-solid fa-volume-high text-red-500"></i>
                <input type="range" v-model="volume" min="0" max="1" step="0.1" class="accent-red-600">
            </div>
            <button @click="stopAll"
                class="bg-red-900/50 hover:bg-red-800 text-red-100 px-4 py-1 rounded border border-red-800 uppercase text-xs font-bold">
                <i class="fa-solid fa-stop"></i> Parar Todos
            </button>
        </div>

        <!-- GRID -->
        <div class="p-6 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 flex-grow relative z-10">
            <div v-for="sound in sounds" :key="sound.id" @click="playSound(sound)"
                class="btn-rpg bg-gray-800 border-2 border-gray-700 rounded-xl p-4 flex flex-col items-center justify-center gap-3 cursor-pointer hover:bg-gray-750 hover:border-red-500/50 h-32 relative group"
                :class="{'playing': sound.playing}">

                <i :class="sound.icon"
                    class="text-3xl text-gray-400 group-hover:text-red-400 transition-colors duration-300"></i>
                <span class="text-sm font-bold text-gray-300 uppercase tracking-wide group-hover:text-white">{{
                    sound.name }}</span>

                <!-- Loop Indicator -->
                <button @click.stop="toggleLoop(sound)"
                    class="absolute top-2 right-2 text-xs text-gray-600 hover:text-green-500 p-1"
                    :class="{'text-green-500': sound.loop}">
                    <i class="fa-solid fa-repeat"></i>
                </button>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="p-4 text-center text-red-900/40 text-xs uppercase">
            Sons providos por Pixabay
        </div>

    </div>

    <script>
        const { createApp, ref, watch } = Vue;

        createApp({
            setup() {
                const volume = ref(0.8);

                // Using generic Pixabay audio links for demo purposes
                // These are direct links to small MP3s
                const sounds = ref([
                    { id: 1, name: 'Dragon Roar', icon: 'fa-solid fa-dragon', url: 'https://cdn.pixabay.com/audio/2022/03/24/audio_145653db3c.mp3', playing: false, loop: false, audio: null },
                    { id: 2, name: 'Sword Hit', icon: 'fa-solid fa-khanda', url: 'https://cdn.pixabay.com/audio/2022/03/15/audio_731477744c.mp3', playing: false, loop: false, audio: null },
                    { id: 3, name: 'Fireball', icon: 'fa-solid fa-fire', url: 'https://cdn.pixabay.com/audio/2024/05/20/audio_5179374465.mp3', playing: false, loop: false, audio: null },
                    { id: 4, name: 'Magic Chime', icon: 'fa-solid fa-wand-magic-sparkles', url: 'https://cdn.pixabay.com/audio/2022/10/16/audio_13b5628670.mp3', playing: false, loop: false, audio: null },
                    { id: 5, name: 'Dungeon Amb', icon: 'fa-solid fa-dungeon', url: 'https://cdn.pixabay.com/audio/2022/02/07/audio_6590858714.mp3', playing: false, loop: false, audio: null },
                    { id: 6, name: 'Arrow Shot', icon: 'fa-solid fa-bullseye', url: 'https://cdn.pixabay.com/audio/2022/10/25/audio_24520ce4b8.mp3', playing: false, loop: false, audio: null },
                    { id: 7, name: 'Evil Laugh', icon: 'fa-solid fa-face-grin-tongue-wink', url: 'https://cdn.pixabay.com/audio/2021/08/04/audio_3490712869.mp3', playing: false, loop: false, audio: null },
                    { id: 8, name: 'Tavern Crowd', icon: 'fa-solid fa-beer-mug-empty', url: 'https://cdn.pixabay.com/audio/2021/09/06/audio_44875704a2.mp3', playing: false, loop: false, audio: null },
                ]);

                const playSound = (sound) => {
                    if (sound.playing && !sound.loop) {
                        sound.audio.currentTime = 0;
                        return; // Restart text
                    }

                    if (sound.playing && sound.loop) {
                        sound.audio.pause();
                        sound.audio.currentTime = 0;
                        sound.playing = false;
                        return;
                    }

                    if (!sound.audio) {
                        sound.audio = new Audio(sound.url);
                        sound.audio.addEventListener('ended', () => {
                            if (!sound.loop) sound.playing = false;
                        });
                    }

                    sound.audio.volume = volume.value;
                    sound.audio.loop = sound.loop;
                    sound.audio.play().catch(e => console.error(e));
                    sound.playing = true;
                };

                const toggleLoop = (sound) => {
                    sound.loop = !sound.loop;
                    if (sound.audio) sound.audio.loop = sound.loop;
                };

                const stopAll = () => {
                    sounds.value.forEach(s => {
                        if (s.audio) {
                            s.audio.pause();
                            s.audio.currentTime = 0;
                        }
                        s.playing = false;
                    });
                };

                watch(volume, (newVal) => {
                    sounds.value.forEach(s => {
                        if (s.audio) s.audio.volume = newVal;
                    });
                });

                return { volume, sounds, playSound, toggleLoop, stopAll };
            }
        }).mount('#app');
    </script>
</body>

</html>