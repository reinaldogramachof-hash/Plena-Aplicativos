<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gerador de Senhas | Plena Aplicativos</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700;800&family=Inter:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                    colors: {
                        cyber: {
                            bg: '#0f172a',
                            card: '#1e293b',
                            accent: '#22d3ee',
                            accentHover: '#06b6d4',
                            text: '#f1f5f9',
                            muted: '#94a3b8'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #0f172a;
            color: #f1f5f9;
            font-family: 'Inter', sans-serif;
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }

        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #22d3ee;
            cursor: pointer;
            margin-top: -8px;
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.5);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #334155;
            border-radius: 2px;
        }

        .anim-pop {
            animation: pop 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes pop {
            0% {
                transform: scale(0.9);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }
    </style>
</head>

<body class="h-screen overflow-hidden flex flex-col items-center justify-center p-4">

    <div id="app" class="w-full max-w-lg">

        <!-- Header -->
        <div class="text-center mb-8">
            <div
                class="w-16 h-16 bg-cyber-card rounded-2xl mx-auto flex items-center justify-center mb-4 shadow-lg shadow-cyber-accent/10 border border-slate-700">
                <i class="fa-solid fa-shield-halved text-3xl text-cyber-accent"></i>
            </div>
            <h1 class="text-3xl font-bold tracking-tight text-white">Gerador <span
                    class="text-cyber-accent">Seguro</span></h1>
            <p class="text-cyber-muted text-sm mt-1">Crie senhas fortes e inquebráveis instantaneamente.</p>
        </div>

        <!-- Main Card -->
        <div class="bg-cyber-card border border-slate-700 rounded-3xl p-6 shadow-2xl relative overflow-hidden">

            <!-- Result Display -->
            <div class="relative mb-6 group">
                <div
                    class="bg-[#0b1120] rounded-xl p-5 border border-slate-700 flex items-center justify-between transition-colors group-hover:border-cyber-accent/50">
                    <div class="font-mono text-xl md:text-2xl break-all text-white font-bold tracking-wide mr-4"
                        :class="password ? '' : 'text-slate-600'">
                        {{ password || 'Sua senha aparecerá aqui' }}
                    </div>

                    <button @click="copyToClipboard"
                        class="text-slate-400 hover:text-white transition p-2 rounded-lg hover:bg-white/10 relative"
                        title="Copiar Senha">
                        <i class="fa-regular" :class="copied ? 'fa-circle-check text-green-400' : 'fa-copy'"></i>
                        <span v-if="copied"
                            class="absolute -top-8 left-1/2 -translate-x-1/2 bg-green-500 text-white text-xs font-bold px-2 py-1 rounded shadow-lg anim-pop">Copiado!</span>
                    </button>

                    <button @click="generate" class="md:hidden text-cyber-accent hover:text-white transition p-2 ml-2">
                        <i class="fa-solid fa-rotate"></i>
                    </button>
                </div>

                <!-- Strength Bar -->
                <div class="flex gap-1 mt-2 h-1.5 px-1">
                    <div class="flex-1 rounded-full transition-all duration-500"
                        :class="strengthScore >= 1 ? strengthColor : 'bg-slate-700'"></div>
                    <div class="flex-1 rounded-full transition-all duration-500"
                        :class="strengthScore >= 2 ? strengthColor : 'bg-slate-700'"></div>
                    <div class="flex-1 rounded-full transition-all duration-500"
                        :class="strengthScore >= 3 ? strengthColor : 'bg-slate-700'"></div>
                    <div class="flex-1 rounded-full transition-all duration-500"
                        :class="strengthScore >= 4 ? strengthColor : 'bg-slate-700'"></div>
                </div>
                <div class="flex justify-between px-1 mt-1">
                    <span class="text-[10px] text-cyber-muted uppercase font-bold">Força</span>
                    <span class="text-[10px] font-bold uppercase transition-colors" :class="strengthTextColor">{{
                        strengthLabel }}</span>
                </div>
            </div>

            <!-- Controls -->
            <div class="space-y-6">

                <!-- Length Slider -->
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <label class="text-sm font-bold text-cyber-muted uppercase">Comprimento</label>
                        <span
                            class="text-cyber-accent font-mono font-bold text-lg bg-slate-800 px-3 py-1 rounded-lg border border-slate-700">{{
                            length }}</span>
                    </div>
                    <input type="range" v-model.number="length" min="6" max="64" step="1" class="w-full">
                </div>

                <!-- Toggles -->
                <div class="grid grid-cols-2 gap-3">
                    <button @click="toggle('uppercase')"
                        class="p-3 rounded-xl border border-slate-700 flex items-center justify-between transition hover:bg-slate-800"
                        :class="options.uppercase ? 'bg-slate-800 border-cyber-accent text-white' : 'text-slate-400'">
                        <span class="text-sm font-medium">ABC Maísculas</span>
                        <i class="fa-solid"
                            :class="options.uppercase ? 'fa-check-circle text-cyber-accent' : 'fa-circle text-slate-600'"></i>
                    </button>

                    <button @click="toggle('lowercase')"
                        class="p-3 rounded-xl border border-slate-700 flex items-center justify-between transition hover:bg-slate-800"
                        :class="options.lowercase ? 'bg-slate-800 border-cyber-accent text-white' : 'text-slate-400'">
                        <span class="text-sm font-medium">abc Minúsculas</span>
                        <i class="fa-solid"
                            :class="options.lowercase ? 'fa-check-circle text-cyber-accent' : 'fa-circle text-slate-600'"></i>
                    </button>

                    <button @click="toggle('numbers')"
                        class="p-3 rounded-xl border border-slate-700 flex items-center justify-between transition hover:bg-slate-800"
                        :class="options.numbers ? 'bg-slate-800 border-cyber-accent text-white' : 'text-slate-400'">
                        <span class="text-sm font-medium">123 Números</span>
                        <i class="fa-solid"
                            :class="options.numbers ? 'fa-check-circle text-cyber-accent' : 'fa-circle text-slate-600'"></i>
                    </button>

                    <button @click="toggle('symbols')"
                        class="p-3 rounded-xl border border-slate-700 flex items-center justify-between transition hover:bg-slate-800"
                        :class="options.symbols ? 'bg-slate-800 border-cyber-accent text-white' : 'text-slate-400'">
                        <span class="text-sm font-medium">!@# Símbolos</span>
                        <i class="fa-solid"
                            :class="options.symbols ? 'fa-check-circle text-cyber-accent' : 'fa-circle text-slate-600'"></i>
                    </button>
                </div>

            </div>

            <!-- Action -->
            <div class="mt-8">
                <button @click="generate"
                    class="w-full bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-cyan-500/20 transition transform active:scale-95 flex items-center justify-center gap-2 text-lg">
                    <i class="fa-solid fa-bolt"></i> GERAR NOVA SENHA
                </button>
            </div>

        </div>

        <!-- History footer (optional) -->
        <div class="mt-6 text-center">
            <button @click="showHistory = !showHistory"
                class="text-cyber-muted text-xs hover:text-white transition underline decoration-slate-700 decoration-dashed">
                {{ showHistory ? 'Ocultar' : 'Ver' }} Histórico Recente
            </button>

            <div v-if="showHistory"
                class="mt-4 bg-cyber-card border border-slate-700 rounded-xl p-4 text-left max-h-40 overflow-y-auto">
                <div v-for="(pw, idx) in history" :key="idx"
                    class="flex justify-between items-center py-2 border-b border-slate-800 last:border-0">
                    <span class="font-mono text-xs text-slate-300 truncate w-4/5">{{ pw }}</span>
                    <button @click="copyHistory(pw)" class="text-xs text-cyber-accent hover:text-white"><i
                            class="fa-regular fa-copy"></i></button>
                </div>
                <div v-if="history.length === 0" class="text-xs text-slate-500 text-center py-2">Nenhuma senha gerada
                    ainda.</div>
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, computed, onMounted, watch } = Vue;
        const DB_KEY = 'plena_senha_config_v1';

        createApp({
            setup() {
                const length = ref(16);
                const options = ref({
                    uppercase: true,
                    lowercase: true,
                    numbers: true,
                    symbols: true
                });

                const password = ref('');
                const copied = ref(false);
                const history = ref([]);
                const showHistory = ref(false);

                // Load config
                onMounted(() => {
                    const d = localStorage.getItem(DB_KEY);
                    if (d) {
                        const parsed = JSON.parse(d);
                        length.value = parsed.length;
                        options.value = parsed.options;
                    }
                    generate(); // Generate one on start
                });

                watch([length, options], () => {
                    localStorage.setItem(DB_KEY, JSON.stringify({ length: length.value, options: options.value }));
                }, { deep: true });

                const toggle = (key) => {
                    options.value[key] = !options.value[key];
                    // Ensure at least one is selected
                    if (!Object.values(options.value).some(v => v)) {
                        options.value[key] = true;
                    }
                };

                const generate = () => {
                    const sets = {
                        uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
                        lowercase: 'abcdefghijklmnopqrstuvwxyz',
                        numbers: '0123456789',
                        symbols: '!@#$%^&*()_+~`|}{[]:;?><,./-='
                    };

                    let chars = '';
                    let result = '';

                    // Add mandatory chars first to ensure at least one of each selected type exists?
                    // Or just simple pool picking. Simple pool is usually fine, but to be "strict" we can force.
                    // Let's do pool picking for simplicity and UX speed, but using crypto API.

                    Object.keys(options.value).forEach(key => {
                        if (options.value[key]) chars += sets[key];
                    });

                    if (!chars) return; // Should not happen due to toggle check

                    // Use crypto for better randomness
                    const array = new Uint32Array(length.value);
                    window.crypto.getRandomValues(array);

                    for (let i = 0; i < length.value; i++) {
                        result += chars.charAt(array[i] % chars.length);
                    }

                    password.value = result;
                    copied.value = false;

                    // Add to history
                    if (history.value[0] !== result) {
                        history.value.unshift(result);
                        if (history.value.length > 10) history.value.pop();
                    }
                };

                const copyToClipboard = () => {
                    if (!password.value) return;
                    navigator.clipboard.writeText(password.value).then(() => {
                        copied.value = true;
                        setTimeout(() => copied.value = false, 2000);
                    });
                };

                const copyHistory = (pw) => {
                    navigator.clipboard.writeText(pw);
                };

                // Strength Scoring
                const strengthScore = computed(() => {
                    let score = 0;
                    if (length.value >= 8) score++;
                    if (length.value >= 12) score++;
                    if (length.value >= 16) score++;

                    // Variety bonus
                    let variety = 0;
                    if (options.value.uppercase) variety++;
                    if (options.value.lowercase) variety++;
                    if (options.value.numbers) variety++;
                    if (options.value.symbols) variety++;

                    if (variety >= 3) score++;

                    if (score > 4) score = 4;
                    if (length.value < 8) score = 1; // Penalty for short

                    return score;
                });

                const strengthLabel = computed(() => {
                    const labels = ['Muito Fraca', 'Fraca', 'Média', 'Forte', 'Inquebrável'];
                    return labels[strengthScore.value];
                });

                const strengthColor = computed(() => {
                    const colors = ['bg-red-500', 'bg-red-500', 'bg-yellow-500', 'bg-green-500', 'bg-cyan-500'];
                    return colors[strengthScore.value];
                });

                const strengthTextColor = computed(() => {
                    const colors = ['text-red-500', 'text-red-500', 'text-yellow-500', 'text-green-500', 'text-cyan-500'];
                    return colors[strengthScore.value];
                });

                return {
                    length, options, password, copied, history, showHistory,
                    toggle, generate, copyToClipboard, copyHistory,
                    strengthScore, strengthLabel, strengthColor, strengthTextColor
                };
            }
        }).mount('#app');
    </script>
</body>

</html>