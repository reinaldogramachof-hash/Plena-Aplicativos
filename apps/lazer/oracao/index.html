<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Di√°rio de Ora√ß√£o | Plena Apps</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,700;1,300&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Merriweather', serif;
            background-color: #f7f3e8;
            color: #5c554b;
        }

        [v-cloak] {
            display: none;
        }

        .gold-accent {
            border-color: #d4af37;
            color: #d4af37;
        }

        .bg-gold {
            background-color: #d4af37;
        }
    </style>
    <script src="../../../assets/js/plena-lock.js"></script>
</head>

<body class="min-h-screen py-8 px-4">

    <div id="app" v-cloak class="max-w-xl mx-auto">

        <!-- HEADER -->
        <header class="text-center mb-10 border-b-2 border-dashed border-[#d4af37]/30 pb-6">
            <div class="inline-block p-4 border-2 border-[#d4af37] rounded-full mb-4 bg-white shadow-sm">
                <i class="fa-solid fa-hands-praying text-4xl text-[#d4af37]"></i>
            </div>
            <h1 class="text-3xl font-bold text-stone-800">Di√°rio de Ora√ß√£o</h1>
            <p class="text-sm text-stone-500 mt-2">"Orai sem cessar." (1 Ts 5:17)</p>
        </header>

        <!-- SUBMIT FORM -->
        <div class="bg-white p-6 rounded-lg shadow-md mb-8 border-l-4 border-[#d4af37]">
            <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                <i class="fa-solid fa-pen-nib text-xs"></i> Novo Pedido
            </h2>

            <div class="flex flex-col gap-3">
                <input v-model="newTitle" type="text" placeholder="Por quem/o que orar?"
                    class="w-full bg-stone-50 border border-stone-200 p-3 rounded outline-none focus:border-[#d4af37]">

                <div class="flex gap-2">
                    <select v-model="newCategory"
                        class="bg-stone-50 border border-stone-200 p-3 rounded text-sm text-stone-600 outline-none">
                        <option>Fam√≠lia</option>
                        <option>Sa√∫de</option>
                        <option>Trabalho</option>
                        <option>Espiritual</option>
                        <option>Outros</option>
                    </select>
                    <button @click="addPrayer"
                        class="flex-grow bg-[#d4af37] hover:bg-[#c29f2f] text-white font-bold py-3 rounded shadow transition">
                        Adicionar
                    </button>
                </div>
            </div>
        </div>

        <!-- TABS -->
        <div class="flex mb-6 border-b border-stone-300">
            <button @click="tab = 'active'"
                :class="tab === 'active' ? 'border-b-2 border-[#d4af37] text-[#d4af37] font-bold' : 'text-stone-400'"
                class="flex-1 pb-3 transition">Pedindo</button>
            <button @click="tab = 'answered'"
                :class="tab === 'answered' ? 'border-b-2 border-[#d4af37] text-[#d4af37] font-bold' : 'text-stone-400'"
                class="flex-1 pb-3 transition">Alcan√ßadas</button>
        </div>

        <!-- LIST -->
        <div class="space-y-4">

            <div v-for="(prayer, idx) in filteredPrayers" :key="prayer.id"
                class="bg-white p-5 rounded-lg shadow-sm hover:shadow-md transition relative group">

                <div class="flex justify-between items-start mb-2">
                    <span
                        class="text-[10px] uppercase font-bold tracking-widest text-[#d4af37] border border-[#d4af37] px-1.5 rounded">{{
                        prayer.category }}</span>
                    <span class="text-xs text-stone-400">{{ formatDate(prayer.date) }}</span>
                </div>

                <h3 class="text-xl font-bold text-stone-800 mb-4">{{ prayer.title }}</h3>

                <div class="flex justify-between items-center border-t border-stone-100 pt-3">
                    <button @click="deletePrayer(prayer.id)" class="text-stone-300 hover:text-red-400 text-sm"><i
                            class="fa-solid fa-trash"></i></button>

                    <button @click="toggleAnswered(prayer)"
                        :class="prayer.answered ? 'bg-green-100 text-green-700' : 'bg-stone-100 text-stone-500 hover:bg-[#d4af37] hover:text-white'"
                        class="px-4 py-1.5 rounded-full text-xs font-bold transition flex items-center gap-2">
                        <i class="fa-solid" :class="prayer.answered ? 'fa-check-double' : 'fa-check'"></i>
                        {{ prayer.answered ? 'Gra√ßa Alcan√ßada!' : 'Marcar como Atendido' }}
                    </button>
                </div>

            </div>

            <div v-if="filteredPrayers.length === 0" class="text-center py-10 opacity-40">
                <i class="fa-solid fa-dove text-4xl mb-4 text-stone-300"></i>
                <p>Nenhum registro nesta lista.</p>
            </div>

        </div>

    </div>

    <script>
        const { createApp, ref, computed, onMounted, watch } = Vue;

        createApp({
            setup() {
                const tab = ref('active');
                const newTitle = ref('');
                const newCategory = ref('Fam√≠lia');
                const prayers = ref([]);

                const filteredPrayers = computed(() => {
                    return prayers.value.filter(p => {
                        return tab.value === 'active' ? !p.answered : p.answered;
                    }).sort((a, b) => b.id - a.id);
                });

                const addPrayer = () => {
                    if (newTitle.value.trim()) {
                        prayers.value.unshift({
                            id: Date.now(),
                            title: newTitle.value,
                            category: newCategory.value,
                            date: new Date().toISOString(),
                            answered: false
                        });
                        newTitle.value = '';
                    }
                };

                const toggleAnswered = (prayer) => {
                    prayer.answered = !prayer.answered;
                    if (prayer.answered) {
                        alert("Que b√™n√ß√£o! Movido para 'Alcan√ßadas'. üôè");
                    }
                };

                const deletePrayer = (id) => {
                    if (confirm("Remover este pedido?")) {
                        prayers.value = prayers.value.filter(p => p.id !== id);
                    }
                };

                const formatDate = (iso) => {
                    return new Date(iso).toLocaleDateString('pt-BR');
                };

                // Persistence
                onMounted(() => {
                    const saved = localStorage.getItem('plena_oracao');
                    if (saved) try { prayers.value = JSON.parse(saved); } catch (e) { }
                });

                watch(prayers, () => {
                    localStorage.setItem('plena_oracao', JSON.stringify(prayers.value));
                }, { deep: true });

                return {
                    tab, newTitle, newCategory, addPrayer, filteredPrayers, toggleAnswered, deletePrayer, formatDate
                };
            }
        }).mount('#app');
    </script>
</body>

</html>