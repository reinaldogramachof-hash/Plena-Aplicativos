<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Plena Delivery - Gestão de Pedidos</title>

    <meta name="theme-color" content="#7C3AED">
    <meta name="msapplication-TileColor" content="#7C3AED">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Plena Delivery">

    <link rel="manifest" href='data:application/manifest+json,{"name":"Plena Delivery","short_name":"PlenaDelivery","start_url":".","display":"standalone","background_color":"#F3F4F6","theme_color":"#7C3AED","icons":[{"src":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzI1NjNFQiIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0zIDIydj01bDUuNS01LjVNMjEgMTJhOSA5IDAgMSAwLTkgOWMtMi41MiAwLTQuOC0xLTEwLjUtNS41TDIgMjIiLz48cGF0aCBkPSJNMTYgM2w1IDUiLz48cGF0aCBkPSJtMjEgMy01IDUiLz48L3N2Zz4=","sizes":"192x192","type":"image/svg+xml"}]}'>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        plena: {
                            primary: '#7C3AED',
                            secondary: '#10B981',
                            danger: '#EF4444',
                            warning: '#F59E0B',
                            dark: '#1F2937',
                            light: '#F3F4F6'
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s infinite',
                        'slide-in': 'slideIn 0.3s ease-out',
                        'fade-in': 'fadeIn 0.5s ease-out',
                    }
                }
            }
        }
    </script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.378.0/dist/umd/lucide.js"></script>

    <style>
        :root {
            --plena-primary: #7C3AED;
            --plena-secondary: #10B981;
            --plena-danger: #EF4444;
            --plena-warning: #F59E0B;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #F3F4F6;
            -webkit-tap-highlight-color: transparent;
        }

        .hide {
            display: none !important;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                transform: translateX(-10px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            animation: fadeIn 0.2s ease;
        }

        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 50;
                height: 100vh;
                width: 280px;
            }

            .sidebar.open {
                transform: translateX(0);
            }
        }

        @media (min-width: 1025px) {
            .sidebar {
                width: 280px;
                position: fixed;
                height: 100vh;
            }

            .main-content {
                margin-left: 280px;
            }
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success {
            background-color: #DCFCE7;
            color: #166534;
        }

        .badge-warning {
            background-color: #FEF3C7;
            color: #92400E;
        }

        .badge-danger {
            background-color: #FEE2E2;
            color: #991B1B;
        }

        .badge-info {
            background-color: #DBEAFE;
            color: #1E40AF;
        }

        .step-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .progress-bar {
            height: 6px;
            border-radius: 3px;
            background: #e5e7eb;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #7C3AED, #5b21b6);
            transition: width 0.5s ease;
        }

        .order-card {
            transition: all 0.3s ease;
            border-left: 4px solid;
        }

        .order-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .order-status-pending {
            border-left-color: #F59E0B;
        }

        .order-status-preparing {
            border-left-color: #3B82F6;
        }

        .order-status-ready {
            border-left-color: #10B981;
        }

        .order-status-delivering {
            border-left-color: #8B5CF6;
        }

        .order-status-delivered {
            border-left-color: #6B7280;
        }

        .main-content {
            padding-bottom: 0;
        }

        @media print {
            @page {
                size: A4;
                margin: 0;
            }

            body {
                background: white !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                height: 100vh;
                margin: 0;
                padding: 0;
            }

            body>* {
                display: none !important;
            }

            #receiptModal {
                display: flex !important;
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
                background: white;
                z-index: 9999;
                align-items: flex-start;
                justify-content: center;
                overflow: visible !important;
            }

            #receiptModal .bg-white {
                box-shadow: none !important;
                max-width: 100% !important;
                width: 100% !important;
                padding: 0 !important;
                margin: 0 !important;
            }

            #receipt-content {
                padding: 40px !important;
                width: 100%;
                font-size: 12pt;
            }

            .no-print {
                display: none !important;
            }
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }

        .status-dot.pending {
            background-color: #F59E0B;
        }

        .status-dot.preparing {
            background-color: #3B82F6;
        }

        .status-dot.ready {
            background-color: #10B981;
        }

        .status-dot.delivering {
            background-color: #8B5CF6;
        }

        .status-dot.delivered {
            background-color: #6B7280;
        }
    </style>
    <script src="../../../assets/js/plena-lock.js"></script>
    <script src="../../assets/js/plena-toolbar.js"></script>
    <link rel="manifest" href="manifest.json">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body class="text-gray-800 antialiased">
    <!-- Overlay para sidebar mobile -->
    <div id="overlay" class="fixed inset-0 bg-black/50 hidden z-40 transition-opacity" onclick="toggleSidebar()"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar bg-plena-dark text-white transition-transform duration-300 flex flex-col shadow-2xl">
        <div class="h-20 flex items-center px-6 bg-gradient-to-r from-plena-primary to-purple-900">
            <i data-lucide="package" class="w-8 h-8 mr-3"></i>
            <div>
                <h1 class="text-xl font-bold tracking-tight">PLENA DELIVERY</h1>
                <p class="text-xs text-white/90 font-medium">Gestão Profissional de Pedidos</p>
            </div>
        </div>

        <nav class="p-4 space-y-2 flex-1 overflow-y-auto">
            <button onclick="router('dashboard')" class="nav-item w-full flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all group active-nav" id="nav-dashboard">
                <i data-lucide="shopping-bag" class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white"></i>
                Dashboard
            </button>
            <button onclick="router('orders')" class="nav-item w-full flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all group" id="nav-orders">
                <i data-lucide="clipboard-list" class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white"></i>
                Pedidos
            </button>
            <button onclick="router('menu')" class="nav-item w-full flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all group" id="nav-menu">
                <i data-lucide="utensils" class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white"></i>
                Cardápio
            </button>
            <button onclick="router('delivery')" class="nav-item w-full flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all group" id="nav-delivery">
                <i data-lucide="bike" class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white"></i>
                Entregas
            </button>
            <button onclick="router('reports')" class="nav-item w-full flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all group" id="nav-reports">
                <i data-lucide="bar-chart-3" class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white"></i>
                Relatórios
            </button>
            <button onclick="router('settings')" class="nav-item w-full flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all group" id="nav-settings">
                <i data-lucide="settings" class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white"></i>
                Configurações
            </button>
            <button onclick="router('instructions')" class="nav-item w-full flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all group" id="nav-instructions">
                <i data-lucide="book-open" class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white"></i>
                Manual de Uso
            </button>
            <button onclick="router('about')" class="nav-item w-full flex items-center px-4 py-3 rounded-xl hover:bg-white/10 transition-all group" id="nav-about">
                <i data-lucide="info" class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white"></i>
                Sobre a Plena
            </button>
        </nav>

        <div class="p-6 border-t border-white/10 text-center">
            <p class="text-xs text-gray-500">Todos os Direitos Reservados &copy; 2026</p>
            <a href="https://www.plenaaplicativos.com.br" target="_blank" class="text-[10px] text-gray-600 hover:text-plena-primary transition-colors mt-1 block decoration-0">
                Plena Soluções Digitais LTDA
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white h-20 flex items-center justify-between px-4 lg:px-8 sticky top-0 z-30 shadow-sm border-b border-gray-100">
            <div class="flex items-center gap-4">
                <button onclick="toggleSidebar()" class="lg:hidden p-2 hover:bg-gray-100 rounded-lg text-gray-600">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
                <h2 id="page-title" class="text-xl font-bold text-gray-800 hidden sm:block">Dashboard</h2>
            </div>

            <div class="flex items-center gap-2 sm:gap-3">
                <div class="relative group">
                    <div class="absolute -inset-1 bg-plena-primary/20 rounded-lg blur opacity-0 group-hover:opacity-100 transition duration-300"></div>
                    <button onclick="openNewOrderModal()" class="relative flex items-center px-4 py-2.5 bg-plena-primary text-white rounded-lg text-sm font-bold hover:bg-purple-800 transition-all shadow-lg shadow-purple-200 active:scale-95">
                        <i data-lucide="plus" class="w-5 h-5 mr-2"></i>
                        <span>Novo Pedido</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Content Area -->
        <div class="p-4 lg:p-8 flex-1 overflow-y-auto">
            <!-- Dashboard View -->
            <section id="view-dashboard" class="view-section fade-in">
                <div class="mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                            <i data-lucide="shopping-bag" class="w-5 h-5 text-plena-primary"></i>
                            Visão Geral do Dia
                        </h3>
                        <p class="text-sm text-gray-500">Acompanhe o desempenho em tempo real</p>
                    </div>
                    <div class="flex items-center gap-3 w-full sm:w-auto">
                        <div class="relative w-full sm:w-auto">
                            <i data-lucide="calendar" class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-plena-primary"></i>
                            <input type="date" id="date-selector" onchange="renderDashboard()" value="" class="w-full sm:w-auto pl-10 pr-4 py-2.5 rounded-lg border-2 border-plena-primary/20 text-sm bg-plena-primary/5 font-bold text-plena-dark focus:border-plena-primary focus:ring-4 focus:ring-plena-primary/10 outline-none transition-all cursor-pointer hover:bg-plena-primary/10">
                        </div>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Pedidos Hoje</p>
                                <h3 id="dash-today-orders" class="text-3xl font-bold text-gray-900">0</h3>
                                <p class="text-xs text-gray-500 mt-1">Total de pedidos</p>
                            </div>
                            <div class="w-12 h-12 rounded-full bg-plena-primary/10 flex items-center justify-center">
                                <i data-lucide="package" class="w-6 h-6 text-plena-primary"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Faturamento</p>
                                <h3 id="dash-today-revenue" class="text-2xl font-bold text-green-600">R$ 0,00</h3>
                                <p class="text-xs text-gray-500 mt-1">Receita do dia</p>
                            </div>
                            <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center">
                                <i data-lucide="dollar-sign" class="w-6 h-6 text-green-600"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Em Preparo</p>
                                <h3 id="dash-preparing" class="text-2xl font-bold text-blue-600">0</h3>
                                <p class="text-xs text-gray-500 mt-1">Pedidos em produção</p>
                            </div>
                            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center">
                                <i data-lucide="clock" class="w-6 h-6 text-blue-600"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Aguardando</p>
                                <h3 id="dash-pending" class="text-2xl font-bold text-yellow-600">0</h3>
                                <p class="text-xs text-gray-500 mt-1">Pedidos pendentes</p>
                            </div>
                            <div class="w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center">
                                <i data-lucide="alert-circle" class="w-6 h-6 text-yellow-600"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Status Timeline -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="font-bold text-gray-800">Pedidos em Andamento</h3>
                            <div class="flex items-center gap-4">
                                <div class="flex items-center gap-2">
                                    <div class="status-dot pending"></div>
                                    <span class="text-xs text-gray-600">Pendente</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="status-dot preparing"></div>
                                    <span class="text-xs text-gray-600">Preparando</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="status-dot ready"></div>
                                    <span class="text-xs text-gray-600">Pronto</span>
                                </div>
                            </div>
                        </div>
                        <div id="order-status-list" class="space-y-4"></div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4 flex items-center">
                                <i data-lucide="zap" class="w-4 h-4 mr-2 text-plena-primary"></i>
                                Ações Rápidas
                            </h3>
                            <div class="space-y-3">
                                <button onclick="openNewOrderModal()" class="w-full bg-plena-primary text-white py-3 rounded-lg text-sm font-bold hover:bg-purple-800 transition-colors flex items-center justify-center gap-2">
                                    <i data-lucide="plus" class="w-4 h-4"></i>
                                    Novo Pedido
                                </button>
                                <button onclick="openQuickMenuModal()" class="w-full bg-green-600 text-white py-3 rounded-lg text-sm font-bold hover:bg-green-700 transition-colors flex items-center justify-center gap-2">
                                    <i data-lucide="utensils" class="w-4 h-4"></i>
                                    Ver Cardápio
                                </button>
                                <button onclick="router('delivery')" class="w-full bg-blue-600 text-white py-3 rounded-lg text-sm font-bold hover:bg-blue-700 transition-colors flex items-center justify-center gap-2">
                                    <i data-lucide="bike" class="w-4 h-4"></i>
                                    Gerenciar Entregas
                                </button>
                            </div>
                        </div>

                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4">Pedidos Recentes</h3>
                            <div id="recent-orders" class="space-y-3">
                                <!-- Dynamic content -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Orders View -->
            <section id="view-orders" class="view-section hide fade-in">
                <div class="mb-6 flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Todos os Pedidos</h2>
                        <p class="text-sm text-gray-600">Gerencie todos os pedidos do estabelecimento</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="openNewOrderModal()" class="flex items-center gap-2 px-4 py-2 bg-plena-primary text-white rounded-lg text-sm font-bold hover:bg-purple-800 transition-colors shadow-lg shadow-purple-200">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            Novo Pedido
                        </button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-6">
                    <div class="p-4 bg-gray-50 grid grid-cols-1 md:grid-cols-4 gap-3 border-b border-gray-200">
                        <div class="relative">
                            <i data-lucide="search" class="absolute left-3 top-3 w-4 h-4 text-gray-400"></i>
                            <input type="text" id="search-orders" onkeyup="renderOrders()" placeholder="Buscar pedido ou cliente..." class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-plena-primary outline-none text-sm">
                        </div>
                        <div>
                            <input type="date" id="filter-start-date" onchange="renderOrders()" class="w-full border p-2 rounded-lg text-sm bg-white">
                        </div>
                        <div>
                            <input type="date" id="filter-end-date" onchange="renderOrders()" class="w-full border p-2 rounded-lg text-sm bg-white">
                        </div>
                        <div class="flex gap-2">
                            <select id="filter-status" onchange="renderOrders()" class="flex-1 px-4 py-2 rounded-lg border border-gray-300 text-sm bg-white outline-none">
                                <option value="all">Todos os Status</option>
                                <option value="pending">Pendente</option>
                                <option value="preparing">Em Preparo</option>
                                <option value="ready">Pronto</option>
                                <option value="delivering">Em Entrega</option>
                                <option value="delivered">Entregue</option>
                                <option value="cancelled">Cancelado</option>
                            </select>
                            <button onclick="clearOrderFilters()" class="px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg text-sm transition-colors">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Orders Table -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 text-gray-500 text-xs uppercase">
                                <tr>
                                    <th class="px-6 py-3">ID</th>
                                    <th class="px-6 py-3">Cliente</th>
                                    <th class="px-6 py-3">Itens</th>
                                    <th class="px-6 py-3">Total</th>
                                    <th class="px-6 py-3">Status</th>
                                    <th class="px-6 py-3">Data/Hora</th>
                                    <th class="px-6 py-3 text-center">Ações</th>
                                </tr>
                            </thead>
                            <tbody id="orders-table-body" class="divide-y divide-gray-100 text-sm"></tbody>
                        </table>
                    </div>
                    <div id="orders-empty-msg" class="hidden p-8 text-center text-gray-400">
                        <i data-lucide="package" class="w-12 h-12 mx-auto mb-4 text-gray-300"></i>
                        <p>Nenhum pedido encontrado.</p>
                    </div>
                </div>
            </section>

            <!-- Menu View -->
            <section id="view-menu" class="view-section hide fade-in">
                <div class="mb-6 flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Cardápio</h2>
                        <p class="text-sm text-gray-600">Gerencie os produtos do seu estabelecimento</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="openNewProductModal()" class="flex items-center gap-2 px-4 py-2 bg-plena-primary text-white rounded-lg text-sm font-bold hover:bg-purple-800 transition-colors shadow-lg shadow-purple-200">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            Novo Produto
                        </button>
                    </div>
                </div>

                <!-- Categories Filter -->
                <div class="mb-6">
                    <div class="flex gap-2 overflow-x-auto pb-2">
                        <button onclick="filterMenuByCategory('all')" class="px-4 py-2 bg-plena-primary text-white rounded-lg text-sm font-bold whitespace-nowrap">Todos</button>
                        <!-- Categories will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Menu Grid -->
                <div id="menu-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Products will be populated by JavaScript -->
                </div>
            </section>

            <!-- Delivery View -->
            <section id="view-delivery" class="view-section hide fade-in">
                <div class="mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-2">Gestão de Entregas</h2>
                    <p class="text-sm text-gray-600">Acompanhe e gerencie todas as entregas</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Delivery Status Cards -->
                    <div class="lg:col-span-2">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                                <p class="text-xs text-gray-500 uppercase font-bold mb-1">Entregas Hoje</p>
                                <p id="delivery-today" class="text-2xl font-bold text-gray-800">0</p>
                            </div>
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                                <p class="text-xs text-gray-500 uppercase font-bold mb-1">Em Andamento</p>
                                <p id="delivery-active" class="text-2xl font-bold text-blue-600">0</p>
                            </div>
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                                <p class="text-xs text-gray-500 uppercase font-bold mb-1">Tempo Médio</p>
                                <p id="delivery-avg-time" class="text-2xl font-bold text-green-600">0min</p>
                            </div>
                        </div>

                        <!-- Active Deliveries -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4">Entregas Ativas</h3>
                            <div id="active-deliveries" class="space-y-4">
                                <!-- Dynamic content -->
                            </div>
                        </div>
                    </div>

                    <!-- Delivery Map & Info -->
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4">Entregadores</h3>
                            <div id="delivery-staff" class="space-y-3">
                                <!-- Dynamic content -->
                            </div>
                            <button onclick="openNewDeliveryStaffModal()" class="w-full mt-4 border border-gray-300 text-gray-700 py-2 rounded-lg text-sm hover:bg-gray-50 transition-colors">
                                <i data-lucide="user-plus" class="w-4 h-4 inline mr-2"></i>
                                Adicionar Entregador
                            </button>
                        </div>

                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4">Estatísticas</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Taxa de Entrega</span>
                                    <span class="font-bold" id="delivery-fee">R$ 0,00</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Raio de Entrega</span>
                                    <span class="font-bold" id="delivery-radius">0 km</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-gray-600">Tempo Estimado</span>
                                    <span class="font-bold" id="delivery-estimated">30-45 min</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reports View -->
            <section id="view-reports" class="view-section hide fade-in">
                <div class="mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-2">Relatórios</h2>
                    <p class="text-sm text-gray-600">Análise detalhada do desempenho do negócio</p>
                </div>

                <div id="report-filters-card" class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 mb-6">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                        <h3 class="font-bold text-gray-800">Configurar Período</h3>
                        <div class="flex gap-2 bg-gray-100 p-1 rounded-lg overflow-x-auto max-w-full">
                            <button onclick="setReportPeriod('today')" class="px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-white hover:text-gray-900 rounded-md transition-all whitespace-nowrap">Hoje</button>
                            <button onclick="setReportPeriod('this-week')" class="px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-white hover:text-gray-900 rounded-md transition-all whitespace-nowrap">Esta Semana</button>
                            <button onclick="setReportPeriod('this-month')" class="px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-white hover:text-gray-900 rounded-md transition-all whitespace-nowrap">Este Mês</button>
                            <button onclick="setReportPeriod('last-month')" class="px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-white hover:text-gray-900 rounded-md transition-all whitespace-nowrap">Mês Passado</button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                        <div>
                            <label class="text-xs font-bold text-gray-500 uppercase">Data Inicial</label>
                            <input type="date" id="rep-start" class="w-full border border-gray-300 p-2.5 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary outline-none">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-gray-500 uppercase">Data Final</label>
                            <input type="date" id="rep-end" class="w-full border border-gray-300 p-2.5 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary outline-none">
                        </div>
                        <div class="flex gap-2">
                            <button onclick="generateReport()" class="flex-1 bg-plena-dark text-white px-6 py-2.5 rounded-xl text-sm font-bold hover:bg-gray-900 transition-colors shadow-lg shadow-gray-200 flex items-center justify-center gap-2">
                                <i data-lucide="search" class="w-4 h-4"></i>
                                Gerar Relatório
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Report Results -->
                <div id="report-result" class="hide space-y-6">
                    <!-- Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="bg-green-50 p-6 rounded-xl text-center border border-green-100">
                            <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-3">
                                <i data-lucide="dollar-sign" class="w-6 h-6 text-green-600"></i>
                            </div>
                            <p class="text-xs text-gray-500 uppercase font-bold">Faturamento</p>
                            <p id="rep-revenue" class="text-2xl font-bold text-green-700 mt-2">R$ 0,00</p>
                        </div>
                        <div class="bg-blue-50 p-6 rounded-xl text-center border border-blue-100">
                            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-3">
                                <i data-lucide="package" class="w-6 h-6 text-blue-600"></i>
                            </div>
                            <p class="text-xs text-gray-500 uppercase font-bold">Pedidos</p>
                            <p id="rep-orders" class="text-2xl font-bold text-blue-700 mt-2">0</p>
                        </div>
                        <div class="bg-purple-50 p-6 rounded-xl text-center border border-purple-100">
                            <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center mx-auto mb-3">
                                <i data-lucide="users" class="w-6 h-6 text-plena-primary"></i>
                            </div>
                            <p class="text-xs text-gray-500 uppercase font-bold">Clientes</p>
                            <p id="rep-customers" class="text-2xl font-bold text-purple-700 mt-2">0</p>
                        </div>
                        <div class="bg-yellow-50 p-6 rounded-xl text-center border border-yellow-100">
                            <div class="w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center mx-auto mb-3">
                                <i data-lucide="bike" class="w-6 h-6 text-yellow-600"></i>
                            </div>
                            <p class="text-xs text-gray-500 uppercase font-bold">Entregas</p>
                            <p id="rep-deliveries" class="text-2xl font-bold text-yellow-700 mt-2">0</p>
                        </div>
                    </div>

                    <!-- Print & Share Actions -->
                    <div class="flex justify-end gap-2">
                        <button onclick="printReport()" class="bg-blue-600 text-white px-6 py-3 rounded-xl text-sm font-bold hover:bg-blue-700 transition-colors flex items-center gap-2 shadow-lg shadow-blue-200">
                            <i data-lucide="printer" class="w-4 h-4"></i>
                            Imprimir Relatório
                        </button>
                    </div>

                    <!-- Detailed Reports -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Top Products -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4">Produtos Mais Vendidos</h3>
                            <div id="top-products" class="space-y-3">
                                <!-- Filled by JS -->
                            </div>
                        </div>

                        <!-- Sales by Hour -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4">Vendas por Horário</h3>
                            <div id="sales-by-hour" class="space-y-3">
                                <!-- Filled by JS -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="view-settings" class="view-section hide fade-in">
                <div class="mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-2">Configurações do Sistema</h2>
                    <p class="text-sm text-gray-600">Personalize e gerencie suas preferências</p>
                </div>

                <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mb-8">
                    <!-- 1. Dados do Estabelecimento -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col h-full">
                        <h3 class="font-bold text-gray-800 mb-6 flex items-center text-lg">
                            <div class="p-2 bg-plena-primary/10 rounded-lg mr-3">
                                <i data-lucide="store" class="w-5 h-5 text-plena-primary"></i>
                            </div>
                            Dados do Estabelecimento
                        </h3>

                        <div class="space-y-5 flex-1">
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Nome do Estabelecimento</label>
                                <input type="text" id="set-establishment-name" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-2 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all" placeholder="Ex: Pizzaria do João">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">CNPJ</label>
                                <input type="text" id="set-establishment-cnpj" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-2 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all" placeholder="00.000.000/0000-00">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Telefone</label>
                                <input type="tel" id="set-establishment-phone" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-2 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all" placeholder="(11) 99999-9999">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Endereço</label>
                                <input type="text" id="set-establishment-address" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-2 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all" placeholder="Endereço completo">
                            </div>
                        </div>
                        <button onclick="saveGlobalSettings()" class="mt-4 w-full bg-plena-primary text-white py-3 rounded-xl text-sm font-bold hover:bg-purple-800 transition-colors shadow-lg shadow-purple-100 flex items-center justify-center gap-2">
                            <i data-lucide="save" class="w-4 h-4"></i>
                            Salvar Dados
                        </button>
                    </div>

                    <!-- 2. Configurações de Entrega -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col h-full">
                        <h3 class="font-bold text-gray-800 mb-6 flex items-center text-lg">
                            <div class="p-2 bg-green-100 rounded-lg mr-3">
                                <i data-lucide="bike" class="w-5 h-5 text-green-600"></i>
                            </div>
                            Configurações de Entrega
                        </h3>

                        <div class="space-y-5 flex-1">
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Taxa de Entrega (R$)</label>
                                <input type="number" step="0.01" id="set-delivery-fee" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-2 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all" placeholder="5.00">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Raio de Entrega (km)</label>
                                <input type="number" step="0.1" id="set-delivery-radius" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-2 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all" placeholder="5.0">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase tracking-wide">Tempo Médio de Entrega (min)</label>
                                <input type="number" id="set-delivery-time" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-2 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all" placeholder="30">
                            </div>
                            <div class="flex items-center justify-between bg-gray-50 p-4 rounded-xl border border-gray-200">
                                <div>
                                    <label class="text-sm font-bold text-gray-800 block">Entrega Gratis Acima de</label>
                                    <span class="text-xs text-gray-500">Valor mínimo para entrega grátis</span>
                                </div>
                                <div class="relative">
                                    <span class="absolute left-3 top-3 text-gray-400 text-sm">R$</span>
                                    <input type="number" step="0.01" id="set-free-delivery-min" class="w-32 pl-10 border border-gray-300 p-2 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all" placeholder="50.00">
                                </div>
                            </div>
                        </div>

                        <button onclick="saveDeliverySettings()" class="w-full bg-green-600 text-white py-3.5 rounded-xl text-sm font-bold hover:bg-green-700 transition-colors shadow-lg shadow-green-200 mt-4">
                            <i data-lucide="save" class="w-4 h-4 inline mr-2"></i>
                            Salvar Configurações de Entrega
                        </button>
                    </div>

                    <!-- 3. Categorias de Produtos -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 h-full">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="font-bold text-gray-800 flex items-center">
                                <i data-lucide="tag" class="w-5 h-5 mr-2 text-plena-primary"></i>
                                Categorias de Produtos
                            </h3>
                            <button onclick="toggleCategoryForm()" class="flex items-center gap-2 px-3 py-1.5 bg-plena-primary text-white text-sm rounded-lg hover:bg-purple-800">
                                <i data-lucide="plus" class="w-4 h-4"></i> Nova
                            </button>
                        </div>

                        <!-- Category Form -->
                        <div id="category-form-box" class="hidden mb-6 bg-gray-50 p-4 rounded-xl border border-gray-200 slide-in">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <input type="text" id="new-category-name" placeholder="Nome da categoria" class="border p-2 rounded-lg text-sm">
                                <div class="flex gap-2">
                                    <input type="color" id="new-category-color" value="#7C3AED" class="h-10 w-10 p-0 border-0 rounded cursor-pointer">
                                </div>
                            </div>
                            <div class="flex gap-2 mt-3">
                                <button onclick="addCategory()" class="flex-1 bg-gray-800 text-white py-2 rounded-lg text-sm font-bold hover:bg-black">
                                    Salvar Categoria
                                </button>
                                <button onclick="toggleCategoryForm()" class="px-4 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">
                                    Cancelar
                                </button>
                            </div>
                        </div>

                        <!-- Categories List -->
                        <div id="category-list" class="space-y-2 max-h-[300px] overflow-y-auto pr-2">
                            <!-- Filled by JS -->
                        </div>
                    </div>

                    <!-- 4. Segurança e Dados -->
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4 flex items-center">
                                <i data-lucide="shield-check" class="w-5 h-5 mr-2 text-plena-primary"></i>
                                Segurança de Dados
                            </h3>

                            <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg text-sm text-blue-800 mb-6">
                                <p class="font-bold mb-2">⚠️ Importante</p>
                                <p>Seus dados ficam salvos 100% no navegador. Faça backup regularmente!</p>
                            </div>

                            <div class="space-y-3">
                                <button onclick="downloadBackup()" class="w-full border border-gray-300 py-3 rounded-lg text-sm font-medium hover:bg-gray-50 flex justify-center items-center gap-2">
                                    <i data-lucide="download" class="w-4 h-4"></i>
                                    Baixar Backup (.json)
                                </button>

                                <div class="relative">
                                    <button class="w-full bg-gray-800 text-white py-3 rounded-lg text-sm font-medium flex justify-center items-center gap-2">
                                        <i data-lucide="upload" class="w-4 h-4"></i>
                                        Restaurar Backup
                                    </button>
                                    <input type="file" onchange="restoreBackup(this)" accept=".json" class="absolute inset-0 opacity-0 cursor-pointer">
                                </div>
                            </div>
                        </div>

                        <!-- Danger Zone -->
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-4 flex items-center text-red-600">
                                <i data-lucide="alert-triangle" class="w-5 h-5 mr-2"></i>
                                Zona de Perigo
                            </h3>
                            <div class="grid grid-cols-2 gap-3">
                                <button onclick="clearAllOrders()" class="py-2.5 border border-red-300 text-red-600 rounded-lg text-sm hover:bg-red-50 transition-colors">
                                    Limpar Pedidos
                                </button>
                                <button onclick="factoryReset()" class="py-2.5 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 transition-colors">
                                    Resetar Tudo
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Instructions View -->
            <section id="view-instructions" class="view-section hide fade-in">
                <div class="max-w-6xl mx-auto pb-12">
                    <!-- Cabeçalho Hero -->
                    <div class="text-center mb-10 pt-4">
                        <div class="inline-flex items-center justify-center p-4 bg-gradient-to-r from-plena-primary to-purple-900 rounded-2xl mb-4 shadow-lg">
                            <i data-lucide="package" class="w-12 h-12 text-white" aria-label="Ícone de Entrega - Manual de Uso"></i>
                        </div>
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">Manual Completo de Uso</h1>
                        <p class="text-gray-600 text-lg max-w-2xl mx-auto">Guia passo a passo para restaurantes, lanchonetes e delivery</p>
                        <div class="mt-4 flex flex-wrap justify-center gap-2">
                            <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold">✓ Para Iniciantes</span>
                            <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-bold">📱 Mobile e Desktop</span>
                            <span class="px-3 py-1 bg-purple-100 text-plena-primary rounded-full text-xs font-bold">⚡ Rápido e Prático</span>
                        </div>
                    </div>

                    <!-- Barra de Progresso do Tutorial -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-8">
                        <h3 class="font-bold text-gray-800 mb-4 flex items-center">
                            <i data-lucide="compass" class="w-5 h-5 mr-2 text-plena-primary"></i>
                            Seu Progresso no Aprendizado
                        </h3>
                        <div class="mb-4">
                            <div class="progress-bar">
                                <div id="tutorial-progress" class="progress-fill" style="width: 0%"></div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-500 mt-2">
                                <span>0% Concluído</span>
                                <span id="completed-steps">0/7 etapas</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 md:grid-cols-7 gap-2">
                            <button onclick="scrollToSection('instalacao')" class="tutorial-step text-center p-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-xs">
                                1. Instalação
                            </button>
                            <button onclick="scrollToSection('configuracao')" class="tutorial-step text-center p-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-xs">
                                2. Configuração
                            </button>
                            <button onclick="scrollToSection('cadastro-produtos')" class="tutorial-step text-center p-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-xs">
                                3. Cardápio
                            </button>
                            <button onclick="scrollToSection('pedidos')" class="tutorial-step text-center p-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-xs">
                                4. Pedidos
                            </button>
                            <button onclick="scrollToSection('entregas')" class="tutorial-step text-center p-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-xs">
                                5. Entregas
                            </button>
                            <button onclick="scrollToSection('backup')" class="tutorial-step text-center p-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-xs">
                                6. Backup
                            </button>
                            <button onclick="scrollToSection('checklist')" class="tutorial-step text-center p-2 rounded-lg border border-gray-200 hover:bg-gray-50 text-xs">
                                7. Checklist
                            </button>
                        </div>
                    </div>

                    <!-- Seção 1: Instalação -->
                    <div id="instalacao" class="bg-white border border-gray-200 rounded-2xl p-6 shadow-sm mb-8 scroll-mt-24">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <div class="step-number bg-gradient-to-r from-plena-primary to-purple-900 text-white">1</div>
                                <h3 class="text-xl font-bold text-gray-800">Instalação do App no Celular</h3>
                            </div>
                            <button onclick="markSectionComplete('instalacao')" class="text-xs text-gray-500 hover:text-green-600">
                                <i data-lucide="check-circle" class="w-4 h-4"></i> Marcar como concluído
                            </button>
                        </div>

                        <div class="bg-gray-900 rounded-2xl p-6 text-white shadow-lg mb-6">
                            <h4 class="font-bold text-lg mb-4 flex items-center">
                                <i data-lucide="download" class="w-5 h-5 mr-2 text-green-400"></i>
                                Torne o App Disponível OFFLINE
                            </h4>
                            <p class="text-gray-300 mb-4">Instale no celular para usar sem internet, igual um app normal:</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm">
                                <div class="bg-white/10 p-4 rounded-xl border border-white/10">
                                    <div class="font-bold text-white mb-3 flex items-center">
                                        <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center mr-2">
                                            <i data-lucide="smartphone" class="w-4 h-4"></i>
                                        </div>
                                        Android (Chrome)
                                    </div>
                                    <ol class="list-decimal pl-5 space-y-3 text-gray-300">
                                        <li class="flex items-start">
                                            <span class="mr-2">1.</span>
                                            <div>
                                                <strong>Abra esta página no Chrome</strong>
                                                <p class="text-xs text-gray-400">Não use outros navegadores</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="mr-2">2.</span>
                                            <div>
                                                <strong>Toque nos 3 pontinhos ☰</strong>
                                                <p class="text-xs text-gray-400">Canto superior direito</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="mr-2">3.</span>
                                            <div>
                                                <strong>Toque em "Instalar app" ou "Adicionar à tela inicial"</strong>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="mr-2">4.</span>
                                            <div>
                                                <strong>Pronto! O ícone aparecerá na sua tela inicial</strong>
                                            </div>
                                        </li>
                                    </ol>
                                </div>
                                <div class="bg-white/10 p-4 rounded-xl border border-white/10">
                                    <div class="font-bold text-white mb-3 flex items-center">
                                        <div class="w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center mr-2">
                                            <i data-lucide="apple" class="w-4 h-4"></i>
                                        </div>
                                        iPhone (Safari)
                                    </div>
                                    <ol class="list-decimal pl-5 space-y-3 text-gray-300">
                                        <li class="flex items-start">
                                            <span class="mr-2">1.</span>
                                            <div>
                                                <strong>Abra esta página no Safari</strong>
                                                <p class="text-xs text-gray-400">Não use Chrome no iPhone</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="mr-2">2.</span>
                                            <div>
                                                <strong>Toque no ícone de compartilhar</strong>
                                                <p class="text-xs text-gray-400">É o quadrado com seta para cima</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="mr-2">3.</span>
                                            <div>
                                                <strong>Role para baixo e toque em "Adicionar à Tela de Início"</strong>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="mr-2">4.</span>
                                            <div>
                                                <strong>Toque "Adicionar" no canto superior direito</strong>
                                            </div>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Seção 2: Configuração -->
                    <div id="configuracao" class="bg-white border border-gray-200 rounded-2xl p-6 shadow-sm mb-8 scroll-mt-24">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <div class="step-number bg-gradient-to-r from-plena-primary to-purple-900 text-white">2</div>
                                <h3 class="text-xl font-bold text-gray-800">Configuração Inicial (10 Minutos)</h3>
                            </div>
                            <button onclick="markSectionComplete('configuracao')" class="text-xs text-gray-500 hover:text-green-600">
                                <i data-lucide="check-circle" class="w-4 h-4"></i> Marcar como concluído
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                <div class="bg-blue-50 p-5 rounded-xl border border-blue-100">
                                    <h4 class="font-bold text-blue-700 mb-3 flex items-center">
                                        <i data-lucide="store" class="w-5 h-5 mr-2"></i>
                                        PASSO 1: Dados do Estabelecimento
                                    </h4>
                                    <ol class="space-y-3 text-sm">
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">A</div>
                                            <div>
                                                <strong>Clique em "Configurações" no menu lateral</strong>
                                                <p class="text-gray-600 text-xs">Ícone da engrenagem</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">B</div>
                                            <div>
                                                <strong>Preencha o nome do seu estabelecimento</strong>
                                                <p class="text-gray-600 text-xs">Ex: "Pizzaria do João"</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">C</div>
                                            <div>
                                                <strong>Adicione CNPJ, telefone e endereço</strong>
                                                <p class="text-gray-600 text-xs">Esses dados aparecerão nos pedidos</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">D</div>
                                            <div>
                                                <strong>Clique em "Salvar Dados"</strong>
                                            </div>
                                        </li>
                                    </ol>
                                </div>

                                <div class="bg-green-50 p-5 rounded-xl border border-green-100">
                                    <h4 class="font-bold text-green-700 mb-3 flex items-center">
                                        <i data-lucide="bike" class="w-5 h-5 mr-2"></i>
                                        PASSO 2: Configurar Entregas
                                    </h4>
                                    <ol class="space-y-3 text-sm">
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-2 text-xs font-bold">A</div>
                                            <div>
                                                <strong>Na mesma tela de Configurações</strong>
                                                <p class="text-gray-600 text-xs">Desça até "Configurações de Entrega"</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-2 text-xs font-bold">B</div>
                                            <div>
                                                <strong>Defina a taxa de entrega</strong>
                                                <p class="text-gray-600 text-xs">Ex: R$ 5,00</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-2 text-xs font-bold">C</div>
                                            <div>
                                                <strong>Configure o raio de entrega</strong>
                                                <p class="text-gray-600 text-xs">Ex: 5 km</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-2 text-xs font-bold">D</div>
                                            <div>
                                                <strong>Salve as configurações</strong>
                                            </div>
                                        </li>
                                    </ol>
                                </div>
                            </div>

                            <div class="space-y-4">
                                <div class="bg-purple-50 p-5 rounded-xl border border-purple-100">
                                    <h4 class="font-bold text-plena-primary mb-3 flex items-center">
                                        <i data-lucide="tag" class="w-5 h-5 mr-2"></i>
                                        PASSO 3: Criar Categorias
                                    </h4>
                                    <p class="text-sm text-gray-700 mb-3">Organize seu cardápio por categorias:</p>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex items-start">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 mt-0.5 mr-2"></i>
                                            <span><strong>Pizzas</strong> (categoria principal)</span>
                                        </div>
                                        <div class="flex items-start">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 mt-0.5 mr-2"></i>
                                            <span><strong>Bebidas</strong></span>
                                        </div>
                                        <div class="flex items-start">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 mt-0.5 mr-2"></i>
                                            <span><strong>Sobremesas</strong></span>
                                        </div>
                                        <div class="flex items-start">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 mt-0.5 mr-2"></i>
                                            <span><strong>Promoções</strong></span>
                                        </div>
                                    </div>
                                    <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                        <p class="text-xs text-yellow-800">
                                            <strong>💡 Dica:</strong> Crie categorias que façam sentido para seu negócio. Isso ajuda na organização e no atendimento.
                                        </p>
                                    </div>
                                </div>

                                <div class="bg-gray-50 p-5 rounded-xl border border-gray-200">
                                    <h4 class="font-bold text-gray-700 mb-3 flex items-center">
                                        <i data-lucide="users" class="w-5 h-5 mr-2"></i>
                                        PASSO 4: Cadastrar Entregadores
                                    </h4>
                                    <p class="text-sm text-gray-700 mb-3">Para gerenciar entregas:</p>
                                    <div class="code-block mt-1 text-xs bg-gray-800 text-white p-3 rounded-lg">
                                        1. Vá em "Entregas" no menu<br>
                                        2. Clique em "Adicionar Entregador"<br>
                                        3. Preencha nome e telefone<br>
                                        4. Salve
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Seção 3: Cadastro de Produtos -->
                    <div id="cadastro-produtos" class="bg-white border border-gray-200 rounded-2xl p-6 shadow-sm mb-8 scroll-mt-24">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <div class="step-number bg-gradient-to-r from-plena-primary to-purple-900 text-white">3</div>
                                <h3 class="text-xl font-bold text-gray-800">Cadastro do Cardápio</h3>
                            </div>
                            <button onclick="markSectionComplete('cadastro-produtos')" class="text-xs text-gray-500 hover:text-green-600">
                                <i data-lucide="check-circle" class="w-4 h-4"></i> Marcar como concluído
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                            <!-- Cartão 1 -->
                            <div class="bg-gradient-to-br from-blue-50 to-white p-5 rounded-xl border border-blue-100">
                                <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mb-3">
                                    <i data-lucide="plus" class="w-5 h-5 text-blue-600"></i>
                                </div>
                                <h4 class="font-bold text-gray-800 mb-2">Adicionar Produto</h4>
                                <p class="text-sm text-gray-600 mb-3">Passo a passo simples:</p>
                                <ol class="space-y-2 text-sm">
                                    <li class="flex items-start">
                                        <span class="font-bold mr-2">1.</span>
                                        <span>Clique em <strong>"Cardápio"</strong> no menu</span>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="font-bold mr-2">2.</span>
                                        <span>Toque no botão <strong>"Novo Produto"</strong></span>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="font-bold mr-2">3.</span>
                                        <span>Preencha nome, descrição, preço</span>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="font-bold mr-2">4.</span>
                                        <span>Selecione a categoria</span>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="font-bold mr-2">5.</span>
                                        <span>Clique em <strong>"Salvar Produto"</strong></span>
                                    </li>
                                </ol>
                            </div>

                            <!-- Cartão 2 -->
                            <div class="bg-gradient-to-br from-green-50 to-white p-5 rounded-xl border border-green-100">
                                <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center mb-3">
                                    <i data-lucide="edit" class="w-5 h-5 text-green-600"></i>
                                </div>
                                <h4 class="font-bold text-gray-800 mb-2">Editar Produto</h4>
                                <p class="text-sm text-gray-600 mb-3">Para alterar preço ou disponibilidade:</p>
                                <div class="space-y-3">
                                    <div class="bg-white p-3 rounded-lg border">
                                        <div class="flex items-center">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center mr-2">
                                                <i data-lucide="edit-2" class="w-3 h-3 text-blue-600"></i>
                                            </div>
                                            <span class="text-sm font-medium">Toque no produto</span>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Isso abrirá a tela de edição</p>
                                    </div>
                                    <div class="bg-white p-3 rounded-lg border">
                                        <div class="flex items-center">
                                            <div class="w-6 h-6 rounded-full bg-yellow-100 flex items-center justify-center mr-2">
                                                <i data-lucide="toggle-left" class="w-3 h-3 text-yellow-600"></i>
                                            </div>
                                            <span class="text-sm font-medium">Altere o status</span>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Ativo/Inativo controla disponibilidade</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Cartão 3 -->
                            <div class="bg-gradient-to-br from-purple-50 to-white p-5 rounded-xl border border-purple-100">
                                <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center mb-3">
                                    <i data-lucide="filter" class="w-5 h-5 text-plena-primary"></i>
                                </div>
                                <h4 class="font-bold text-gray-800 mb-2">Organizar por Categorias</h4>
                                <p class="text-sm text-gray-600 mb-3">Facilite a busca:</p>
                                <div class="space-y-2 text-sm text-gray-700">
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 rounded-full bg-blue-500 mr-2"></div>
                                        <span><strong>Use os botões no topo</strong> para filtrar</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 rounded-full bg-green-500 mr-2"></div>
                                        <span><strong>Clientes encontram rápido</strong> o que procuram</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-2 h-2 rounded-full bg-purple-500 mr-2"></div>
                                        <span><strong>Pedidos são mais organizados</strong></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Exemplo Visual -->
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 border border-green-100 rounded-xl p-5">
                            <h4 class="font-bold text-green-800 mb-3 flex items-center">
                                <i data-lucide="lightbulb" class="w-5 h-5 mr-2"></i>
                                Dicas para um Cardápio Atraente
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-white p-4 rounded-lg border text-center">
                                    <i data-lucide="camera" class="w-6 h-6 text-plena-primary mx-auto mb-2"></i>
                                    <p class="text-xs font-bold">Fotos</p>
                                    <p class="text-xs text-gray-600">Use fotos reais dos produtos</p>
                                </div>
                                <div class="bg-white p-4 rounded-lg border text-center">
                                    <i data-lucide="pen-tool" class="w-6 h-6 text-plena-primary mx-auto mb-2"></i>
                                    <p class="text-xs font-bold">Descrições</p>
                                    <p class="text-xs text-gray-600">Descreva ingredientes principais</p>
                                </div>
                                <div class="bg-white p-4 rounded-lg border text-center">
                                    <i data-lucide="star" class="w-6 h-6 text-plena-primary mx-auto mb-2"></i>
                                    <p class="text-xs font-bold">Destaques</p>
                                    <p class="text-xs text-gray-600">Mantenha promoções em evidência</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Seção 4: Pedidos -->
                    <div id="pedidos" class="bg-white border border-gray-200 rounded-2xl p-6 shadow-sm mb-8 scroll-mt-24">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <div class="step-number bg-gradient-to-r from-plena-primary to-purple-900 text-white">4</div>
                                <h3 class="text-xl font-bold text-gray-800">Gestão de Pedidos</h3>
                            </div>
                            <button onclick="markSectionComplete('pedidos')" class="text-xs text-gray-500 hover:text-green-600">
                                <i data-lucide="check-circle" class="w-4 h-4"></i> Marcar como concluído
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                                    <i data-lucide="clipboard-list" class="w-5 h-5 mr-2 text-plena-primary"></i>
                                    Fluxo de Pedidos
                                </h4>
                                <p class="text-sm text-gray-700 mb-4">Do recebimento à entrega:</p>
                                <ol class="space-y-4 text-sm">
                                    <li class="flex items-start">
                                        <div class="w-8 h-8 rounded-full bg-yellow-100 text-yellow-700 flex items-center justify-center mr-3 text-xs font-bold">1</div>
                                        <div>
                                            <strong>Pendente</strong>
                                            <p class="text-gray-600 text-xs mt-1">Pedido recebido, aguardando confirmação</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <div class="w-8 h-8 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-3 text-xs font-bold">2</div>
                                        <div>
                                            <strong>Em Preparo</strong>
                                            <p class="text-gray-600 text-xs mt-1">Cozinha preparando o pedido</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <div class="w-8 h-8 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-3 text-xs font-bold">3</div>
                                        <div>
                                            <strong>Pronto</strong>
                                            <p class="text-gray-600 text-xs mt-1">Pedido finalizado, pronto para entrega</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <div class="w-8 h-8 rounded-full bg-purple-100 text-plena-primary flex items-center justify-center mr-3 text-xs font-bold">4</div>
                                        <div>
                                            <strong>Em Entrega</strong>
                                            <p class="text-gray-600 text-xs mt-1">Entregador a caminho do cliente</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <div class="w-8 h-8 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center mr-3 text-xs font-bold">5</div>
                                        <div>
                                            <strong>Entregue</strong>
                                            <p class="text-gray-600 text-xs mt-1">Pedido entregue com sucesso</p>
                                        </div>
                                    </li>
                                </ol>
                            </div>

                            <div>
                                <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                                    <i data-lucide="zap" class="w-5 h-5 mr-2 text-green-600"></i>
                                    Atualização Rápida de Status
                                </h4>
                                <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                                    <p class="text-sm text-gray-700 mb-3">No <strong>Dashboard</strong> ou <strong>Pedidos</strong>:</p>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between bg-white p-3 rounded-lg border">
                                            <div class="flex items-center">
                                                <div class="status-dot pending mr-2"></div>
                                                <span class="text-sm">Pendente</span>
                                            </div>
                                            <button class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">→ Preparar</button>
                                        </div>
                                        <div class="flex items-center justify-between bg-white p-3 rounded-lg border">
                                            <div class="flex items-center">
                                                <div class="status-dot preparing mr-2"></div>
                                                <span class="text-sm">Em Preparo</span>
                                            </div>
                                            <button class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded">→ Pronto</button>
                                        </div>
                                        <div class="flex items-center justify-between bg-white p-3 rounded-lg border">
                                            <div class="flex items-center">
                                                <div class="status-dot ready mr-2"></div>
                                                <span class="text-sm">Pronto</span>
                                            </div>
                                            <button class="text-xs bg-purple-100 text-plena-primary px-2 py-1 rounded">→ Entregar</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-6">
                                    <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                                        <i data-lucide="message-circle" class="w-5 h-5 mr-2 text-blue-600"></i>
                                        Comunicação com Cliente
                                    </h4>
                                    <ul class="space-y-2 text-sm text-gray-700">
                                        <li class="flex items-start">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2 mt-0.5"></i>
                                            <span>WhatsApp integrado para atualizações</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2 mt-0.5"></i>
                                            <span>Notificações automáticas de status</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2 mt-0.5"></i>
                                            <span>Histórico completo da conversa</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Seção 5: Entregas -->
                    <div id="entregas" class="bg-white border border-gray-200 rounded-2xl p-6 shadow-sm mb-8 scroll-mt-24">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <div class="step-number bg-gradient-to-r from-plena-primary to-purple-900 text-white">5</div>
                                <h3 class="text-xl font-bold text-gray-800">Gestão de Entregas</h3>
                            </div>
                            <button onclick="markSectionComplete('entregas')" class="text-xs text-gray-500 hover:text-green-600">
                                <i data-lucide="check-circle" class="w-4 h-4"></i> Marcar como concluído
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-bold text-gray-800 mb-4 flex items-center">
                                    <i data-lucide="user-plus" class="w-5 h-5 mr-2 text-green-600"></i>
                                    Gerenciar Entregadores
                                </h4>
                                <div class="space-y-4">
                                    <div class="bg-white p-4 rounded-xl border border-green-200">
                                        <div class="flex items-center mb-2">
                                            <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center mr-3">
                                                <span class="font-bold text-green-700">1</span>
                                            </div>
                                            <p class="font-bold text-gray-800">Acesse Entregas</p>
                                        </div>
                                        <p class="text-sm text-gray-600 ml-11">Menu lateral → Ícone da moto</p>
                                    </div>

                                    <div class="bg-white p-4 rounded-xl border border-green-200">
                                        <div class="flex items-center mb-2">
                                            <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center mr-3">
                                                <span class="font-bold text-green-700">2</span>
                                            </div>
                                            <p class="font-bold text-gray-800">Clique em "Adicionar Entregador"</p>
                                        </div>
                                        <p class="text-sm text-gray-600 ml-11">Preencha nome e telefone</p>
                                    </div>

                                    <div class="bg-white p-4 rounded-xl border border-green-200">
                                        <div class="flex items-center mb-2">
                                            <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center mr-3">
                                                <span class="font-bold text-green-700">3</span>
                                            </div>
                                            <p class="font-bold text-gray-800">Atribua Pedidos</p>
                                        </div>
                                        <p class="text-sm text-gray-600 ml-11">No pedido pronto, selecione o entregador</p>
                                    </div>

                                    <div class="bg-white p-4 rounded-xl border border-green-200">
                                        <div class="flex items-center mb-2">
                                            <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center mr-3">
                                                <span class="font-bold text-green-700">4</span>
                                            </div>
                                            <p class="font-bold text-gray-800">Acompanhe em Tempo Real</p>
                                        </div>
                                        <p class="text-sm text-gray-600 ml-11">Veja status de todas as entregas ativas</p>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h4 class="font-bold text-gray-800 mb-4 flex items-center">
                                    <i data-lucide="map-pin" class="w-5 h-5 mr-2 text-blue-600"></i>
                                    Otimização de Rotas
                                </h4>
                                <div class="bg-blue-50 p-5 rounded-xl border border-blue-100">
                                    <p class="text-sm text-gray-700 mb-4">Dicas para eficiência nas entregas:</p>
                                    <ol class="space-y-3 text-sm">
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">A</div>
                                            <div>
                                                <strong>Agrupe entregas próximas</strong>
                                                <p class="text-gray-600 text-xs">Combine pedidos da mesma região</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">B</div>
                                            <div>
                                                <strong>Comunique atrasos</strong>
                                                <p class="text-gray-600 text-xs">Mantenha cliente informado via WhatsApp</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">C</div>
                                            <div>
                                                <strong>Use o histórico</strong>
                                                <p class="text-gray-600 text-xs">Analise tempos médios de entrega</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">D</div>
                                            <div>
                                                <strong>Defina zonas prioritárias</strong>
                                                <p class="text-gray-600 text-xs">Foque nas áreas com mais pedidos</p>
                                            </div>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Seção 6: Backup -->
                    <div id="backup" class="bg-white border border-gray-200 rounded-2xl p-6 shadow-sm mb-8 scroll-mt-24">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <div class="step-number bg-gradient-to-r from-plena-primary to-purple-900 text-white">6</div>
                                <h3 class="text-xl font-bold text-gray-800">Backup e Segurança dos Dados</h3>
                            </div>
                            <button onclick="markSectionComplete('backup')" class="text-xs text-gray-500 hover:text-green-600">
                                <i data-lucide="check-circle" class="w-4 h-4"></i> Marcar como concluído
                            </button>
                        </div>

                        <div class="bg-red-50 border-l-4 border-red-500 p-6 rounded-r-xl mb-6">
                            <h4 class="font-bold text-red-800 mb-3 flex items-center">
                                <i data-lucide="alert-octagon" class="w-5 h-5 mr-2"></i>
                                ATENÇÃO: Leia com Cuidado!
                            </h4>
                            <div class="text-sm text-red-800 space-y-2">
                                <p>📱 <strong>Seus dados ficam APENAS no seu dispositivo.</strong></p>
                                <p>🔄 <strong>Se você perder o aparelho, formatar ou limpar o navegador, perderá TODOS os dados.</strong></p>
                                <p>💾 <strong>O backup é SUA responsabilidade.</strong> Faça SEMPRE!</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-bold text-gray-800 mb-4 flex items-center">
                                    <i data-lucide="download" class="w-5 h-5 mr-2 text-green-600"></i>
                                    Como Fazer Backup (Passo a Passo)
                                </h4>
                                <ol class="space-y-4 text-sm">
                                    <li class="flex items-start">
                                        <div class="w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-2 text-xs font-bold">1</div>
                                        <div>
                                            <strong>Clique em "Configurações"</strong>
                                            <p class="text-gray-600 text-xs">Menu lateral → Ícone da engrenagem</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <div class="w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-2 text-xs font-bold">2</div>
                                        <div>
                                            <strong>Desça até "Segurança de Dados"</strong>
                                            <p class="text-gray-600 text-xs">Procure pelo ícone do escudo</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <div class="w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-2 text-xs font-bold">3</div>
                                        <div>
                                            <strong>Clique em "Baixar Backup (.json)"</strong>
                                            <p class="text-gray-600 text-xs">Um arquivo será baixado automaticamente</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <div class="w-6 h-6 rounded-full bg-green-100 text-green-700 flex items-center justify-center mr-2 text-xs font-bold">4</div>
                                        <div>
                                            <strong>Salve em 2 Lugares Seguros</strong>
                                            <div class="mt-1 text-xs text-gray-600">
                                                • Google Drive<br>
                                                • WhatsApp (envie para você mesmo)<br>
                                                • Pendrive ou HD externo<br>
                                                • E-mail (anexe o arquivo)
                                            </div>
                                        </div>
                                    </li>
                                </ol>
                            </div>

                            <div>
                                <h4 class="font-bold text-gray-800 mb-4 flex items-center">
                                    <i data-lucide="refresh-cw" class="w-5 h-5 mr-2 text-blue-600"></i>
                                    Como Restaurar Backup
                                </h4>
                                <div class="bg-blue-50 p-5 rounded-xl border border-blue-100">
                                    <p class="text-sm text-gray-700 mb-4">Se você perdeu os dados ou trocou de dispositivo:</p>
                                    <ol class="space-y-3 text-sm">
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">A</div>
                                            <div>
                                                <strong>Baixe o arquivo de backup</strong>
                                                <p class="text-gray-600 text-xs">Do Google Drive, WhatsApp ou e-mail</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">B</div>
                                            <div>
                                                <strong>Acesse as Configurações do app</strong>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">C</div>
                                            <div>
                                                <strong>Clique em "Restaurar Backup"</strong>
                                                <p class="text-gray-600 text-xs">Selecione o arquivo .json baixado</p>
                                            </div>
                                        </li>
                                        <li class="flex items-start">
                                            <div class="w-6 h-6 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center mr-2 text-xs font-bold">D</div>
                                            <div>
                                                <strong>Confirme a restauração</strong>
                                                <p class="text-gray-600 text-xs">O app será recarregado com seus dados antigos</p>
                                            </div>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Seção 7: Checklist Interativo -->
                    <div id="checklist" class="bg-white border border-gray-200 rounded-2xl p-6 shadow-sm mb-8 scroll-mt-24">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <div class="step-number bg-gradient-to-r from-plena-primary to-purple-900 text-white">7</div>
                                <h3 class="text-xl font-bold text-gray-800">Checklist Interativo de Rotina</h3>
                            </div>
                            <button onclick="markSectionComplete('checklist')" class="text-xs text-gray-500 hover:text-green-600">
                                <i data-lucide="check-circle" class="w-4 h-4"></i> Marcar como concluído
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Coluna 1 -->
                            <div class="space-y-4">
                                <div class="bg-blue-50 p-5 rounded-xl border border-blue-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h4 class="font-bold text-blue-600 uppercase text-sm">Abertura do Dia</h4>
                                        <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">CRÍTICO</span>
                                    </div>
                                    <div id="checklist-1" class="space-y-3">
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-1-1" class="w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500" onchange="updateChecklist()">
                                            <label for="check-1-1" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Verificar cardápio e disponibilidade
                                            </label>
                                        </div>
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-1-2" class="w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500" onchange="updateChecklist()">
                                            <label for="check-1-2" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Confirmar entregadores disponíveis
                                            </label>
                                        </div>
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-1-3" class="w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500" onchange="updateChecklist()">
                                            <label for="check-1-3" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Verificar estoque de produtos
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-green-50 p-5 rounded-xl border border-green-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h4 class="font-bold text-green-600 uppercase text-sm">Durante o Expediente</h4>
                                        <span class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded">ROTINA</span>
                                    </div>
                                    <div id="checklist-2" class="space-y-3">
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-2-1" class="w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-green-500" onchange="updateChecklist()">
                                            <label for="check-2-1" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Atualizar status dos pedidos
                                            </label>
                                        </div>
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-2-2" class="w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-green-500" onchange="updateChecklist()">
                                            <label for="check-2-2" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Comunicar clientes sobre atrasos
                                            </label>
                                        </div>
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-2-3" class="w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-green-500" onchange="updateChecklist()">
                                            <label for="check-2-3" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Monitorar entregas ativas
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Coluna 2 -->
                            <div class="space-y-4">
                                <div class="bg-purple-50 p-5 rounded-xl border border-purple-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h4 class="font-bold text-plena-primary uppercase text-sm">Fechamento do Dia</h4>
                                        <span class="text-xs bg-purple-100 text-plena-primary px-2 py-1 rounded">ANÁLISE</span>
                                    </div>
                                    <div id="checklist-3" class="space-y-3">
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-3-1" class="w-5 h-5 text-purple-600 rounded border-gray-300 focus:ring-purple-500" onchange="updateChecklist()">
                                            <label for="check-3-1" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Fechar caixa e conferir valores
                                            </label>
                                        </div>
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-3-2" class="w-5 h-5 text-purple-600 rounded border-gray-300 focus:ring-purple-500" onchange="updateChecklist()">
                                            <label for="check-3-2" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                FAZER BACKUP dos dados
                                            </label>
                                        </div>
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-3-3" class="w-5 h-5 text-purple-600 rounded border-gray-300 focus:ring-purple-500" onchange="updateChecklist()">
                                            <label for="check-3-3" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Gerar relatório diário
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-red-50 p-5 rounded-xl border border-red-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h4 class="font-bold text-red-600 uppercase text-sm">Manutenção Semanal</h4>
                                        <span class="text-xs bg-red-100 text-red-700 px-2 py-1 rounded">MANUTENÇÃO</span>
                                    </div>
                                    <div id="checklist-4" class="space-y-3">
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-4-1" class="w-5 h-5 text-red-600 rounded border-gray-300 focus:ring-red-500" onchange="updateChecklist()">
                                            <label for="check-4-1" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Revisar preços do cardápio
                                            </label>
                                        </div>
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-4-2" class="w-5 h-5 text-red-600 rounded border-gray-300 focus:ring-red-500" onchange="updateChecklist()">
                                            <label for="check-4-2" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Analisar desempenho de entregadores
                                            </label>
                                        </div>
                                        <div class="checklist-item flex items-center">
                                            <input type="checkbox" id="check-4-3" class="w-5 h-5 text-red-600 rounded border-gray-300 focus:ring-red-500" onchange="updateChecklist()">
                                            <label for="check-4-3" class="ml-3 text-sm text-gray-700 cursor-pointer">
                                                Verificar histórico de pedidos
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Coluna 3: Resumo -->
                            <div>
                                <div class="bg-gradient-to-br from-gray-900 to-plena-dark text-white p-5 rounded-xl shadow-lg">
                                    <h4 class="font-bold text-white mb-4 text-lg">Seu Progresso da Semana</h4>

                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between text-sm mb-1">
                                                <span>Checklist da Semana</span>
                                                <span id="checklist-percent">0%</span>
                                            </div>
                                            <div class="progress-bar bg-gray-700">
                                                <div id="checklist-progress" class="progress-fill bg-gradient-to-r from-green-400 to-blue-400" style="width: 0%"></div>
                                            </div>
                                        </div>

                                        <div class="grid grid-cols-2 gap-3 text-sm">
                                            <div class="text-center p-3 bg-white/10 rounded-lg">
                                                <p class="text-2xl font-bold" id="checklist-completed">0</p>
                                                <p class="text-white/70 text-xs">Concluídos</p>
                                            </div>
                                            <div class="text-center p-3 bg-white/10 rounded-lg">
                                                <p class="text-2xl font-bold" id="checklist-total">12</p>
                                                <p class="text-white/70 text-xs">Total Itens</p>
                                            </div>
                                        </div>

                                        <div class="pt-4 border-t border-white/10">
                                            <p class="text-xs text-white/80 mb-3">Próximas tarefas prioritárias:</p>
                                            <div id="next-tasks" class="space-y-2">
                                                <!-- Será preenchido por JavaScript -->
                                            </div>
                                        </div>
                                    </div>

                                    <button onclick="resetChecklist()" class="w-full mt-4 bg-white/20 hover:bg-white/30 text-white py-2.5 rounded-lg text-sm font-medium transition-colors">
                                        <i data-lucide="refresh-ccw" class="w-4 h-4 inline mr-2"></i>
                                        Reiniciar Checklist da Semana
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Final Completion Card -->
                    <div class="mt-12 text-center max-w-2xl mx-auto p-8 bg-gradient-to-b from-green-50 to-white border border-green-200 rounded-3xl shadow-lg relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-green-400 to-plena-primary"></div>

                        <div class="w-20 h-20 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-6 shadow-sm">
                            <i data-lucide="award" class="w-10 h-10 text-green-600"></i>
                        </div>

                        <h4 class="text-2xl font-bold text-gray-800 mb-3">
                            Parabéns! Você Dominou o Sistema 🚀
                        </h4>
                        <p class="text-gray-600 mb-8 leading-relaxed">
                            Você concluiu todas as etapas do manual. Agora você tem o conhecimento necessário para gerenciar seu delivery com total segurança e profissionalismo.
                        </p>

                        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                            <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="w-full sm:w-auto px-6 py-3 bg-white border border-gray-200 text-gray-700 rounded-xl font-bold hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm">
                                <i data-lucide="arrow-up" class="w-4 h-4 inline mr-2"></i>
                                Voltar ao Topo
                            </button>

                            <button onclick="router('dashboard')" class="w-full sm:w-auto px-8 py-3 bg-plena-primary text-white rounded-xl font-bold hover:bg-purple-800 transition-all shadow-md hover:shadow-lg transform hover:-translate-y-0.5">
                                Ir para o Dashboard
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Rodapé do Manual -->
                <div class="text-center mt-12 pt-8 border-t border-gray-200">
                    <p class="text-sm text-gray-600 mb-2">
                        Este manual faz parte do sistema Plena Delivery v1.0 Pro
                    </p>
                    <p class="text-[10px] text-gray-400">
                        Plena Soluções Digitais LTDA • CNPJ: 17.347.919/0001-59 •
                        <a href="mailto:tecnologia@plenaaplicativos.com.br" class="text-plena-primary hover:underline">
                            tecnologia@plenaaplicativos.com.br
                        </a>
                    </p>
                    <p class="text-[8px] text-gray-300 mt-2">
                        Última atualização: Janeiro 2026 • Compatível com Android, iPhone, Windows, Mac
                    </p>
                </div>
            </section>

            <!-- About View: Legal & Safety Center -->
            <section id="view-about" class="view-section hide fade-in">
                <div class="max-w-4xl mx-auto pb-12">
                    <!-- 1. Header Institucional -->
                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 mb-8 text-center">
                        <div class="w-20 h-20 rounded-full bg-gradient-to-r from-plena-primary to-purple-900 flex items-center justify-center mx-auto mb-4 shadow-lg shadow-purple-200">
                            <i data-lucide="shield-check" class="w-10 h-10 text-white"></i>
                        </div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-1">Central de Segurança e Legalidade</h2>
                        <p class="text-gray-500 font-medium">Plena Soluções Digitais • Transparência Total</p>
                    </div>

                    <!-- 2. Grid de Políticas -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <!-- Termos de Uso -->
                        <div class="bg-white p-6 rounded-xl border border-gray-200 hover:shadow-md transition-shadow">
                            <h3 class="font-bold text-gray-800 mb-3 flex items-center text-lg">
                                <div class="p-2 bg-blue-50 rounded-lg mr-3">
                                    <i data-lucide="file-text" class="w-5 h-5 text-plena-primary"></i>
                                </div>
                                Termos de Uso
                            </h3>
                            <p class="text-sm text-gray-600 leading-relaxed text-justify">
                                A licença concedida é <strong>pessoal, intransferível e não exclusiva</strong>. O software é fornecido "no estado em que se encontra" (as-is). É estritamente proibida a revenda, cópia, distribuição não autorizada ou engenharia reversa do código-fonte, sob pena das sanções previstas na Lei de Propriedade Intelectual (9.610/98).
                            </p>
                        </div>

                        <!-- Privacidade e LGPD -->
                        <div class="bg-white p-6 rounded-xl border border-gray-200 hover:shadow-md transition-shadow">
                            <h3 class="font-bold text-gray-800 mb-3 flex items-center text-lg">
                                <div class="p-2 bg-green-50 rounded-lg mr-3">
                                    <i data-lucide="lock" class="w-5 h-5 text-green-600"></i>
                                </div>
                                Privacidade (LGPD)
                            </h3>
                            <p class="text-sm text-gray-600 leading-relaxed text-justify">
                                Adotamos a arquitetura <strong>Privacy by Design (Local-First)</strong>. Seus dados de pedidos e clientes ficam salvos <strong>exclusivamente no seu dispositivo</strong>. A Plena não coleta, não armazena e não tem acesso a nenhuma informação inserida no sistema. Sua privacidade é absoluta.
                            </p>
                        </div>
                    </div>

                    <!-- 3. Responsabilidade do Usuário (Crítico) -->
                    <div class="bg-red-50 border border-red-100 p-8 rounded-2xl mb-8 relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-4 opacity-10">
                            <i data-lucide="alert-octagon" class="w-32 h-32 text-red-900"></i>
                        </div>
                        <div class="relative z-10">
                            <h3 class="font-bold text-red-800 mb-4 flex items-center text-lg">
                                <i data-lucide="alert-triangle" class="w-6 h-6 mr-3"></i>
                                IMPORTANTE: Sua Responsabilidade sobre os Dados
                            </h3>
                            <div class="space-y-4 text-sm text-red-900/80 text-justify font-medium">
                                <p>
                                    <strong>1. Backup é Obrigatório:</strong> Como não temos acesso aos seus dados, <strong>não podemos recuperá-los</strong> em caso de perda, roubo ou dano ao seu dispositivo. A realização de cópias de segurança (Backup) é de responsabilidade única e exclusiva do usuário.
                                </p>
                                <p>
                                    <strong>2. Isenção de Responsabilidade Técnica:</strong> A Plena exime-se de qualquer responsabilidade por prejuízos decorrentes de falhas de hardware, vírus no dispositivo do usuário, ou uso incorreto dos cálculos financeiros do sistema. Verifique sempre as taxas configuradas.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Suporte e SLA -->
                    <div class="bg-gradient-to-br from-gray-900 to-plena-dark text-white p-8 rounded-2xl mb-12 shadow-xl">
                        <div class="flex flex-col md:flex-row items-center justify-between gap-8">
                            <div class="flex-1">
                                <h3 class="font-bold text-xl mb-2 flex items-center">
                                    <i data-lucide="life-buoy" class="w-6 h-6 mr-3 text-plena-primary"></i>
                                    Suporte Premium Especializado
                                </h3>
                                <p class="text-gray-300 text-sm mb-6 leading-relaxed">
                                    Precisa de ajuda ou encontrou alguma inconsistência? Nossa equipe técnica está pronta para atender você com prioridade. Garantimos a qualidade e a segurança da nossa marca.
                                </p>

                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <div class="bg-white/10 p-3 rounded-lg backdrop-blur-sm">
                                        <p class="text-xs text-gray-400 uppercase font-bold">Canal Oficial</p>
                                        <p class="font-bold text-white">E-mail</p>
                                    </div>
                                    <div class="bg-white/10 p-3 rounded-lg backdrop-blur-sm">
                                        <p class="text-xs text-gray-400 uppercase font-bold">Tempo de Resposta (SLA)</p>
                                        <p class="font-bold text-plena-primary">Até 24h Úteis</p>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <a href="mailto:tecnologia@plenaaplicativos.com.br" class="inline-flex items-center justify-center bg-white text-plena-dark px-8 py-4 rounded-xl font-bold hover:bg-gray-100 transition-transform transform hover:scale-105 shadow-lg">
                                    <i data-lucide="mail" class="w-5 h-5 mr-2"></i>
                                    Falar com Suporte
                                </a>
                                <p class="text-xs text-center text-gray-400 mt-3">tecnologia@plenaaplicativos.com.br</p>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Confirmação e Aceite -->
                    <div class="mt-8 mb-12" id="terms-action-container">
                        <div class="bg-gray-50 border border-gray-200 p-6 rounded-2xl flex flex-col items-center text-center transition-all duration-300" id="terms-box">
                            <i data-lucide="check-circle-2" class="w-12 h-12 text-gray-300 mb-3" id="terms-icon"></i>
                            <h3 class="font-bold text-gray-800 text-lg mb-2" id="terms-title">Confirmação de Leitura</h3>
                            <p class="text-sm text-gray-500 mb-6 max-w-lg" id="terms-desc">
                                Para prosseguir com segurança, confirme que você leu e compreendeu os Termos de Uso, a Política de Privacidade e sua responsabilidade sobre os backups.
                            </p>

                            <button onclick="confirmTerms()" id="btn-confirm-terms" class="bg-plena-primary hover:bg-purple-800 text-white font-bold py-3 px-8 rounded-xl shadow-lg shadow-purple-200 transform hover:scale-105 transition-all flex items-center gap-2 group">
                                <span>Li, Compreendi e Concordo</span>
                                <i data-lucide="arrow-right" class="w-5 h-5 group-hover:translate-x-1 transition-transform"></i>
                            </button>

                            <div id="terms-accepted-badge" class="hidden flex flex-col items-center animate-in fade-in zoom-in duration-300">
                                <span class="bg-green-100 text-green-700 font-bold px-6 py-2 rounded-full text-sm border border-green-200 flex items-center gap-2 mb-2">
                                    <i data-lucide="lock" class="w-4 h-4"></i>
                                    Termos Aceitos e Registrados
                                </span>
                                <p class="text-xs text-gray-400 font-mono" id="terms-date">Carregando data...</p>
                            </div>
                        </div>
                    </div>

                    <!-- 6. Rodapé Legal -->
                    <div class="text-center border-t border-gray-200 pt-8">
                        <p class="text-sm font-bold text-gray-800">Plena Soluções Digitais LTDA</p>
                        <p class="text-xs text-gray-500 mt-1">CNPJ: 17.347.919/0001-59 • Todos os direitos reservados</p>
                        <p class="text-[10px] text-gray-400 mt-4">
                            Versão 1.0 Pro • Build 2026.01.07
                        </p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- New Order Modal -->
    <div id="newOrderModal" class="fixed inset-0 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl transform transition-all p-6 md:p-8">
            <div class="flex justify-between items-center mb-8 border-b border-gray-100 pb-4">
                <div>
                    <h3 class="text-xl font-bold text-gray-900">Novo Pedido</h3>
                    <p class="text-sm text-gray-500">Cadastre um novo pedido para entrega ou retirada</p>
                </div>
                <button onclick="closeModal('newOrderModal')" class="bg-gray-100 hover:bg-gray-200 p-2 rounded-full text-gray-500 transition-colors">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>

            <form onsubmit="submitNewOrder(event)">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- LEFT COLUMN: Customer Data -->
                    <div class="space-y-5">
                        <div class="flex items-center gap-2 text-plena-primary font-bold uppercase text-xs tracking-wider mb-2">
                            <i data-lucide="user" class="w-4 h-4"></i> Dados do Cliente
                        </div>

                        <div>
                            <label class="text-xs font-bold text-gray-500 uppercase">Nome do Cliente</label>
                            <input type="text" id="order-customer-name" required class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all" placeholder="Ex: João Silva">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase">Telefone</label>
                                <input type="tel" id="order-customer-phone" required class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all" placeholder="(11) 99999-9999">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 uppercase">Tipo</label>
                                <select id="order-type" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all">
                                    <option value="delivery">Entrega</option>
                                    <option value="pickup">Retirada</option>
                                </select>
                            </div>
                        </div>

                        <div id="delivery-address-fields">
                            <label class="text-xs font-bold text-gray-500 uppercase">Endereço de Entrega</label>
                            <input type="text" id="order-delivery-address" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all" placeholder="Rua, Número, Bairro, Complemento">
                        </div>

                        <div>
                            <label class="text-xs font-bold text-gray-500 uppercase">Observações</label>
                            <textarea id="order-notes" rows="3" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all" placeholder="Observações do pedido..."></textarea>
                        </div>
                    </div>

                    <!-- RIGHT COLUMN: Order Items -->
                    <div class="bg-gray-50 rounded-2xl p-6 border border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-2 text-green-600 font-bold uppercase text-xs tracking-wider">
                                <i data-lucide="shopping-cart" class="w-4 h-4"></i> Itens do Pedido
                            </div>
                            <button type="button" onclick="openQuickMenuModal()" class="text-xs bg-plena-primary text-white px-3 py-1.5 rounded-lg hover:bg-purple-800">
                                <i data-lucide="plus" class="w-3 h-3 inline mr-1"></i> Adicionar Item
                            </button>
                        </div>

                        <div id="order-items-list" class="space-y-3 mb-4">
                            <!-- Items will be added here -->
                        </div>

                        <!-- Order Summary -->
                        <div class="border-t border-gray-200 pt-4 mt-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-600">Subtotal:</span>
                                <span id="order-subtotal" class="font-bold">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-600">Taxa de Entrega:</span>
                                <span id="order-delivery-fee">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between items-center text-lg font-bold border-t border-gray-300 pt-2 mt-2">
                                <span>Total:</span>
                                <span id="order-total">R$ 0,00</span>
                            </div>
                        </div>

                        <div class="mt-6">
                            <label class="text-xs font-bold text-gray-500 uppercase">Forma de Pagamento</label>
                            <select id="order-payment-method" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary focus:border-transparent outline-none transition-all">
                                <option value="cash">Dinheiro</option>
                                <option value="card">Cartão</option>
                                <option value="pix">PIX</option>
                                <option value="online">Online</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="flex gap-2 pt-6">
                    <button type="button" onclick="closeModal('newOrderModal')" class="px-4 py-3 border border-gray-300 text-gray-700 rounded-xl font-bold hover:bg-gray-50">
                        Cancelar
                    </button>
                    <button type="submit" class="flex-1 bg-plena-primary text-white py-3 rounded-xl font-bold shadow-lg shadow-purple-200 hover:bg-purple-800 transition-all">
                        Finalizar Pedido
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Quick Menu Modal -->
    <div id="quickMenuModal" class="fixed inset-0 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl transform transition-all p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-bold text-gray-800">Adicionar Itens</h3>
                <button onclick="closeModal('quickMenuModal')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x"></i>
                </button>
            </div>

            <div class="mb-4">
                <div class="relative">
                    <i data-lucide="search" class="absolute left-3 top-3 w-4 h-4 text-gray-400"></i>
                    <input type="text" id="menu-search" placeholder="Buscar produto..." class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-plena-primary outline-none text-sm">
                </div>
            </div>

            <div id="quick-menu-items" class="max-h-[400px] overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-3">
                <!-- Products will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="productModal" class="fixed inset-0 modal-backdrop hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md transform transition-all p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-bold text-gray-800" id="product-modal-title">Novo Produto</h3>
                <button onclick="closeModal('productModal')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x"></i>
                </button>
            </div>

            <form onsubmit="submitProduct(event)">
                <input type="hidden" id="product-id">

                <div class="space-y-4">
                    <div>
                        <label class="text-xs font-bold text-gray-500 uppercase">Nome do Produto</label>
                        <input type="text" id="product-name" required class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary outline-none transition-all" placeholder="Ex: Pizza Margherita">
                    </div>

                    <div>
                        <label class="text-xs font-bold text-gray-500 uppercase">Descrição</label>
                        <textarea id="product-description" rows="2" class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary outline-none transition-all" placeholder="Descrição do produto..."></textarea>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-xs font-bold text-gray-500 uppercase">Preço (R$)</label>
                            <input type="number" step="0.01" id="product-price" required class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary outline-none transition-all" placeholder="0,00">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-gray-500 uppercase">Categoria</label>
                            <select id="product-category" required class="w-full border border-gray-300 p-3 rounded-xl text-sm mt-1 focus:ring-2 focus:ring-plena-primary outline-none transition-all">
                                <!-- Categories will be populated by JavaScript -->
                            </select>
                        </div>
                    </div>

                    <div class="flex items-center justify-between bg-gray-50 p-4 rounded-xl border border-gray-200">
                        <div>
                            <label class="text-sm font-bold text-gray-800 block">Produto Disponível?</label>
                            <span class="text-xs text-gray-500">Desative para tirar do cardápio</span>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="product-available" class="sr-only peer" checked>
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-500"></div>
                        </label>
                    </div>

                    <button type="submit" class="w-full bg-plena-primary text-white py-3 rounded-xl font-bold shadow-lg shadow-purple-200 hover:bg-purple-800 transition-all mt-2">
                        Salvar Produto
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div id="receiptModal" class="fixed inset-0 modal-backdrop hidden z-50 overflow-y-auto">
        <div class="min-h-screen flex items-center justify-center p-4">
            <div class="bg-white w-full max-w-2xl shadow-2xl relative">
                <div class="bg-gray-900 text-white p-4 flex justify-between items-center no-print">
                    <h3 class="font-bold flex items-center gap-2"><i data-lucide="file-check" class="w-5 h-5"></i> Comprovante de Pedido</h3>
                    <div class="flex gap-3">
                        <button onclick="window.print()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 transition-colors">
                            <i data-lucide="printer" class="w-4 h-4"></i> Imprimir
                        </button>
                        <button onclick="closeModal('receiptModal')" class="text-gray-400 hover:text-white transition-colors">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>

                <div class="p-12 md:p-16 text-gray-900 font-serif leading-relaxed" id="receipt-content">
                    <div class="text-center border-b-2 border-gray-800 pb-6 mb-8">
                        <h1 class="text-3xl font-bold uppercase tracking-wide mb-2">Comprovante de Pedido</h1>
                        <p class="text-sm text-gray-500">Documento Comprobatório</p>
                    </div>

                    <div class="mb-8">
                        <div class="flex justify-between mb-4">
                            <div>
                                <p class="text-sm text-gray-500">Número do Pedido</p>
                                <p class="font-bold text-lg" id="rec-order-id">#0001</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm text-gray-500">Data/Hora</p>
                                <p class="font-bold" id="rec-order-date">01/01/2026 18:30</p>
                            </div>
                        </div>

                        <div class="mb-6">
                            <p class="text-sm text-gray-500 mb-1">Cliente</p>
                            <p class="font-bold text-lg" id="rec-customer-name">Nome do Cliente</p>
                            <p class="text-sm" id="rec-customer-phone">(11) 99999-9999</p>
                            <p class="text-sm" id="rec-delivery-address">Endereço de entrega</p>
                        </div>
                    </div>

                    <div class="border-t border-b border-gray-300 py-4 my-6">
                        <h3 class="font-bold mb-3">Itens do Pedido</h3>
                        <div id="rec-order-items">
                            <!-- Items will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="text-right mb-8">
                        <div class="inline-block text-left">
                            <div class="flex justify-between mb-1">
                                <span class="mr-8">Subtotal:</span>
                                <span id="rec-subtotal">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between mb-1">
                                <span class="mr-8">Taxa de Entrega:</span>
                                <span id="rec-delivery-fee">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between text-lg font-bold border-t border-gray-300 pt-2 mt-2">
                                <span class="mr-8">Total:</span>
                                <span id="rec-total">R$ 0,00</span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-12 pt-8 border-t border-gray-300">
                        <div class="grid grid-cols-2 gap-8">
                            <div>
                                <p class="text-sm text-gray-500 mb-1">Forma de Pagamento</p>
                                <p class="font-bold" id="rec-payment-method">Dinheiro</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 mb-1">Status</p>
                                <p class="font-bold" id="rec-order-status">Pendente</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-16 text-center text-xs text-gray-400 border-t pt-4">
                        Gerado digitalmente por Plena Delivery • Autenticação: <span id="rec-hash">---</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Modal -->
    <div id="confirmModal" class="fixed inset-0 modal-backdrop hidden z-[60] flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm transform transition-all p-6">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i data-lucide="alert-triangle" class="w-8 h-8 text-red-600"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-2" id="confirm-title">Confirmação</h3>
                <p class="text-sm text-gray-500" id="confirm-message">Tem certeza que deseja realizar esta ação?</p>
            </div>
            <div class="flex gap-3">
                <button id="confirm-btn-cancel" onclick="handleConfirmCancel()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 transition-colors">
                    Cancelar
                </button>
                <button id="confirm-btn-action" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-xl font-bold hover:bg-red-700 transition-colors shadow-lg shadow-red-200">
                    Confirmar
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>

        // ESTADO GLOBAL
        const DB_KEY = 'plena_delivery_pro_v1';
        const defaultDB = {
            orders: [],
            products: [],
            categories: [
                { id: '1', name: 'Pizzas', color: '#EF4444' },
                { id: '2', name: 'Lanches', color: '#F59E0B' },
                { id: '3', name: 'Bebidas', color: '#3B82F6' },
                { id: '4', name: 'Sobremesas', color: '#8B5CF6' },
                { id: '5', name: 'Promoções', color: '#10B981' }
            ],
            deliveryStaff: [],
            settings: {
                establishmentName: '',
                establishmentCNPJ: '',
                establishmentPhone: '',
                establishmentAddress: '',
                deliveryFee: 5.00,
                deliveryRadius: 5.0,
                deliveryTime: 30,
                freeDeliveryMin: 50.00,
                currency: 'R$'
            },
            currentOrderItems: []
        };

        let db = JSON.parse(localStorage.getItem(DB_KEY)) || defaultDB;

        // UTILITÁRIOS
        const save = () => {
            localStorage.setItem(DB_KEY, JSON.stringify(db));
            updateDataStatus();
        };

        const fmtMoney = (v) => {
            return v.toLocaleString('pt-BR', {
                style: 'currency',
                currency: 'BRL',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        };

        const fmtDate = (d) => {
            const date = new Date(d);
            return date.toLocaleDateString('pt-BR');
        };

        const fmtDateTime = (d) => {
            const date = new Date(d);
            return date.toLocaleString('pt-BR');
        };

        const getID = () => {
            return Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
        };

        const sanitizeHTML = (str) => {
            if (str === null || typeof str === 'undefined') {
                return '';
            }
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return str.toString().replace(/[&<>"']/g, (m) => map[m]);
        };

        // FUNÇÕES ESPECÍFICAS DO MANUAL DE USO
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function markSectionComplete(sectionId) {
            if (!db.settings.tutorial) db.settings.tutorial = {};
            if (!db.settings.tutorial.completedSections) db.settings.tutorial.completedSections = [];

            const completedSections = db.settings.tutorial.completedSections;
            if (!completedSections.includes(sectionId)) {
                completedSections.push(sectionId);
                save();
                updateTutorialProgress();
                showNotification('Seção marcada como concluída!', 'success');
            }
        }

        function updateTutorialProgress() {
            const sections = ['instalacao', 'configuracao', 'cadastro-produtos', 'pedidos', 'entregas', 'backup', 'checklist'];
            const completedSections = (db.settings.tutorial && db.settings.tutorial.completedSections) ? db.settings.tutorial.completedSections : [];

            const progress = sections.length > 0 ? (completedSections.length / sections.length) * 100 : 0;

            const progressBar = document.getElementById('tutorial-progress');
            const completedSteps = document.getElementById('completed-steps');

            if (progressBar) progressBar.style.width = `${progress}%`;
            if (completedSteps) completedSteps.textContent = `${completedSections.length}/${sections.length} etapas`;

            sections.forEach(sectionId => {
                const button = document.querySelector(`.tutorial-step[onclick="scrollToSection('${sectionId}')"]`);
                if (button) {
                    if (completedSections.includes(sectionId)) {
                        button.classList.add('bg-green-100', 'border-green-300', 'text-green-800');
                        button.classList.remove('border-gray-200', 'hover:bg-gray-50');
                    } else {
                        button.classList.remove('bg-green-100', 'border-green-300', 'text-green-800');
                        button.classList.add('border-gray-200', 'hover:bg-gray-50');
                    }
                }
            });
            updateChecklist();
        }

        function updateChecklist() {
            const checkboxes = document.querySelectorAll('#checklist input[type="checkbox"]');
            if(checkboxes.length === 0) return;

            const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
            const percentage = (checked / checkboxes.length) * 100;
            
            const progressBar = document.getElementById('checklist-progress');
            const percentageText = document.getElementById('checklist-percent');
            const completedText = document.getElementById('checklist-completed');
            const totalText = document.getElementById('checklist-total');

            if (progressBar) progressBar.style.width = `${percentage}%`;
            if (percentageText) percentageText.textContent = `${Math.round(percentage)}%`;
            if (completedText) completedText.textContent = checked;
            if (totalText) totalText.textContent = checkboxes.length;

            const nextTasks = document.getElementById('next-tasks');
            if (nextTasks) {
                const uncheckedItems = Array.from(checkboxes).filter(cb => !cb.checked).slice(0, 3).map(cb => {
                    const label = document.querySelector(`label[for="${cb.id}"]`);
                    return label ? label.textContent.trim() : '';
                }).filter(text => text);
                
                nextTasks.innerHTML = uncheckedItems.length > 0
                    ? uncheckedItems.map(task => `<div class="flex items-center"><i data-lucide="circle" class="w-3 h-3 text-white/60 mr-2"></i><span class="text-xs text-white/90">${task}</span></div>`).join('')
                    : `<div class="flex items-center"><i data-lucide="check-circle" class="w-3 h-3 text-green-400 mr-2"></i><span class="text-xs text-white/90">Todas as tarefas concluídas!</span></div>`;
                if(lucide) lucide.createIcons();
            }

            const checklistState = {};
            checkboxes.forEach(cb => {
                checklistState[cb.id] = cb.checked;
                const item = cb.closest('.checklist-item');
                if (item) {
                    item.classList.toggle('completed', cb.checked);
                }
            });
            
            if (!db.settings.tutorial) db.settings.tutorial = {};
            db.settings.tutorial.checklist = checklistState;
            save();
        }
        
        function loadTutorialState() {
            const savedChecklist = (db.settings.tutorial && db.settings.tutorial.checklist) ? db.settings.tutorial.checklist : {};
            Object.keys(savedChecklist).forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox) checkbox.checked = savedChecklist[id];
            });

            updateTutorialProgress();
        }
        
        function resetChecklist() {
            showCustomConfirm('Reiniciar Checklist', 'Tem certeza que deseja reiniciar todas as tarefas do checklist da semana?', () => {
                const checkboxes = document.querySelectorAll('#checklist input[type="checkbox"]');
                checkboxes.forEach(cb => {
                    cb.checked = false;
                });
                if (db.settings.tutorial) {
                    db.settings.tutorial.checklist = {};
                }
                save();
                updateChecklist();
                showNotification('Checklist reiniciado com sucesso!', 'success');
            }, true, 'Reiniciar', 'Cancelar');
        }

        // INICIALIZAÇÃO
        function init() {
            try {
                if (window.lucide) lucide.createIcons();

                // Configurar datas padrão
                const today = new Date().toISOString().split('T')[0];
                const dateInput = document.getElementById('date-selector');
                if (dateInput) dateInput.value = today;

                // Configurar inputs de data
                if (document.getElementById('filter-start-date')) document.getElementById('filter-start-date').value = today;
                if (document.getElementById('filter-end-date')) document.getElementById('filter-end-date').value = today;
                if (document.getElementById('rep-start')) document.getElementById('rep-start').value = today;
                if (document.getElementById('rep-end')) document.getElementById('rep-end').value = today;

                // Renderizar dados iniciais
                renderDashboard();
                renderCategories();
                updateDataStatus();

                // Carregar configurações globais
                if (db.settings.establishmentName) {
                    document.getElementById('set-establishment-name').value = db.settings.establishmentName;
                }
                if (db.settings.establishmentCNPJ) document.getElementById('set-establishment-cnpj').value = db.settings.establishmentCNPJ;
                if (db.settings.establishmentPhone) document.getElementById('set-establishment-phone').value = db.settings.establishmentPhone;
                if (db.settings.establishmentAddress) document.getElementById('set-establishment-address').value = db.settings.establishmentAddress;
                if (db.settings.deliveryFee) document.getElementById('set-delivery-fee').value = db.settings.deliveryFee;
                if (db.settings.deliveryRadius) document.getElementById('set-delivery-radius').value = db.settings.deliveryRadius;
                if (db.settings.deliveryTime) document.getElementById('set-delivery-time').value = db.settings.deliveryTime;
                if (db.settings.freeDeliveryMin) document.getElementById('set-free-delivery-min').value = db.settings.freeDeliveryMin;

                // Inicializar componentes do manual
                loadTutorialState();

                // Configurar periodicidade para salvar
                setInterval(save, 30000);
            } catch (error) {
                console.error('Erro na inicialização:', error);
                alert('Ocorreu um erro ao iniciar o aplicativo: ' + error.message);
            }
        }

        // ROTEAMENTO E NAVEGAÇÃO
        function router(view) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hide'));
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('bg-white/10', 'text-white');
                el.classList.add('text-gray-400');
            });

            const viewElement = document.getElementById(`view-${view}`);
            if (viewElement) {
                viewElement.classList.remove('hide');
                viewElement.classList.add('fade-in');
            }

            const navElement = document.getElementById(`nav-${view}`);
            if (navElement) {
                navElement.classList.add('bg-white/10', 'text-white');
                navElement.classList.remove('text-gray-400');
            }

            const titles = {
                dashboard: 'Dashboard',
                orders: 'Pedidos',
                menu: 'Cardápio',
                delivery: 'Entregas',
                reports: 'Relatórios',
                settings: 'Configurações',
                instructions: 'Manual de Uso',
                about: 'Sobre a Plena'
            };

            document.getElementById('page-title').innerText = titles[view] || 'Plena Delivery';

            if (window.innerWidth < 1024) {
                toggleSidebar();
            }

            if (view === 'dashboard') {
                renderDashboard();
            } else if (view === 'orders') {
                renderOrders();
            } else if (view === 'menu') {
                renderMenu();
            } else if (view === 'delivery') {
                renderDelivery();
            } else if (view === 'settings') {
                renderCategories();
            } else if (view === 'instructions') {
                loadTutorialState();
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');

            sidebar.classList.toggle('open');
            overlay.classList.toggle('hidden');

            document.body.style.overflow = sidebar.classList.contains('open') ? 'hidden' : '';
        }

        // DASHBOARD
        function renderDashboard() {
            const dateSelector = document.getElementById('date-selector').value;
            const today = dateSelector || new Date().toISOString().split('T')[0];

            const todayOrders = db.orders.filter(order => order.date && order.date.startsWith(today));
            const todayRevenue = todayOrders.reduce((sum, order) => sum + order.total, 0);
            const preparingOrders = todayOrders.filter(order => order.status === 'preparing').length;
            const pendingOrders = todayOrders.filter(order => order.status === 'pending').length;

            document.getElementById('dash-today-orders').textContent = todayOrders.length;
            document.getElementById('dash-today-revenue').textContent = fmtMoney(todayRevenue);
            document.getElementById('dash-preparing').textContent = preparingOrders;
            document.getElementById('dash-pending').textContent = pendingOrders;

            renderOrderStatusList(todayOrders);
            renderRecentOrders();
        }

        function renderOrderStatusList(orders) {
            const container = document.getElementById('order-status-list');
            const activeOrders = orders.filter(order => ['pending', 'preparing', 'ready'].includes(order.status));

            if (activeOrders.length === 0) {
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center py-12 text-center">
                        <div class="bg-gray-50 p-4 rounded-full mb-4">
                            <i data-lucide="package" class="w-12 h-12 text-gray-300"></i>
                        </div>
                        <h3 class="text-gray-900 font-bold text-lg mb-1">Nenhum pedido ativo</h3>
                        <p class="text-gray-500 text-sm">Todos os pedidos foram finalizados.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = activeOrders.map(order => {
                const statusConfig = {
                    'pending': { color: 'order-status-pending', label: 'Pendente', icon: 'clock' },
                    'preparing': { color: 'order-status-preparing', label: 'Em Preparo', icon: 'utensils' },
                    'ready': { color: 'order-status-ready', label: 'Pronto', icon: 'check-circle' },
                    'delivering': { color: 'order-status-delivering', label: 'Em Entrega', icon: 'bike' },
                    'delivered': { color: 'order-status-delivered', label: 'Entregue', icon: 'package-check' }
                };

                const config = statusConfig[order.status] || statusConfig.pending;

                return `
                    <div class="order-card ${config.color} bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center">
                                <i data-lucide="${config.icon}" class="w-4 h-4 mr-2"></i>
                                <span class="font-bold text-gray-800">Pedido #${order.id.slice(-4)}</span>
                            </div>
                            <span class="text-xs font-bold px-2 py-1 rounded-full ${order.type === 'delivery' ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'}">
                                ${order.type === 'delivery' ? 'Entrega' : 'Retirada'}
                            </span>
                        </div>
                        
                        <div class="mb-3">
                            <p class="text-sm text-gray-800">${sanitizeHTML(order.customerName)}</p>
                            <p class="text-xs text-gray-500">${sanitizeHTML(order.customerPhone)}</p>
                            ${order.deliveryAddress ? `<p class="text-xs text-gray-500 truncate">${sanitizeHTML(order.deliveryAddress)}</p>` : ''}
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="text-sm font-bold text-gray-800">
                                ${fmtMoney(order.total)}
                            </div>
                            <div class="flex gap-2">
                                ${order.status === 'pending' ? `
                                    <button onclick="updateOrderStatus('${order.id}', 'preparing')" class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">→ Preparar</button>
                                ` : ''}
                                ${order.status === 'preparing' ? `
                                    <button onclick="updateOrderStatus('${order.id}', 'ready')" class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded">→ Pronto</button>
                                ` : ''}
                                ${order.status === 'ready' ? `
                                    <button onclick="updateOrderStatus('${order.id}', 'delivering')" class="text-xs bg-purple-100 text-plena-primary px-2 py-1 rounded">→ Entregar</button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            if (window.lucide) lucide.createIcons();
        }

        function renderRecentOrders() {
            const container = document.getElementById('recent-orders');
            const recentOrders = [...db.orders].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 3);

            if (recentOrders.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-sm text-center">Sem pedidos recentes</p>';
                return;
            }

            container.innerHTML = recentOrders.map(order => {
                const timeAgo = getTimeAgo(order.date);
                return `
                    <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium text-gray-800">#${order.id.slice(-4)}</p>
                            <p class="text-xs text-gray-500">${sanitizeHTML(order.customerName)} • ${timeAgo}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-bold text-plena-primary">${fmtMoney(order.total)}</p>
                            <span class="text-xs ${order.status === 'delivered' ? 'text-green-600' : 'text-yellow-600'}">${getStatusLabel(order.status)}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getTimeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMins / 60);
            const diffDays = Math.floor(diffHours / 24);

            if (diffDays > 0) return `${diffDays}d atrás`;
            if (diffHours > 0) return `${diffHours}h atrás`;
            if (diffMins > 0) return `${diffMins}min atrás`;
            return 'Agora mesmo';
        }

        function getStatusLabel(status) {
            const labels = {
                'pending': 'Pendente',
                'preparing': 'Preparando',
                'ready': 'Pronto',
                'delivering': 'Em Entrega',
                'delivered': 'Entregue',
                'cancelled': 'Cancelado'
            };
            return labels[status] || status;
        }

        // ORDERS
        function renderOrders() {
            const term = document.getElementById('search-orders').value.toLowerCase();
            const statusFilter = document.getElementById('filter-status').value;
            const startDate = document.getElementById('filter-start-date').value;
            const endDate = document.getElementById('filter-end-date').value;

            let filtered = db.orders.filter(order => {
                const matchesTerm = order.customerName.toLowerCase().includes(term) ||
                    order.customerPhone.toLowerCase().includes(term) ||
                    order.id.toLowerCase().includes(term);
                const matchesStatus = statusFilter === 'all' || order.status === statusFilter;
                const matchesDate = (!startDate || order.date >= startDate) && (!endDate || order.date <= endDate);

                return matchesTerm && matchesStatus && matchesDate;
            });

            filtered.sort((a, b) => new Date(b.date) - new Date(a.date));

            const tbody = document.getElementById('orders-table-body');
            const emptyMsg = document.getElementById('orders-empty-msg');

            if (filtered.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="py-12 text-center">
                            <div class="flex flex-col items-center justify-center">
                                <div class="bg-gray-50 p-4 rounded-full mb-4">
                                    <i data-lucide="package" class="w-12 h-12 text-gray-300"></i>
                                </div>
                                <h3 class="text-gray-900 font-bold text-lg mb-1">Nenhum pedido encontrado</h3>
                                <p class="text-gray-500 text-sm">Tente ajustar os filtros ou adicione um novo pedido.</p>
                            </div>
                        </td>
                    </tr>
                `;
                emptyMsg.classList.add('hidden');
                return;
            }

            emptyMsg.classList.add('hidden');

            tbody.innerHTML = filtered.map(order => {
                const itemCount = order.items ? order.items.length : 0;
                return `
                    <tr class="hover:bg-gray-50 group border-b border-gray-100">
                        <td class="px-6 py-4 font-mono text-gray-500">#${order.id.slice(-4)}</td>
                        <td class="px-6 py-4">
                            <div class="font-bold text-gray-800">${sanitizeHTML(order.customerName)}</div>
                            <div class="text-xs text-gray-500">${sanitizeHTML(order.customerPhone)}</div>
                        </td>
                        <td class="px-6 py-4">${itemCount} item(s)</td>
                        <td class="px-6 py-4 font-bold text-plena-primary">${fmtMoney(order.total)}</td>
                        <td class="px-6 py-4">
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold ${getStatusColor(order.status)}">
                                ${getStatusLabel(order.status)}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-gray-500 text-sm">${fmtDateTime(order.date)}</td>
                        <td class="px-6 py-4 text-center">
                            <div class="flex justify-center space-x-2">
                                <button onclick="openReceiptModal('${order.id}')" class="p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors" title="Ver Comprovante">
                                    <i data-lucide="eye" class="w-4 h-4"></i>
                                </button>
                                ${order.status !== 'delivered' && order.status !== 'cancelled' ? `
                                    <button onclick="updateOrderStatus('${order.id}', '${getNextStatus(order.status)}')" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors" title="Avançar Status">
                                        <i data-lucide="arrow-right" class="w-4 h-4"></i>
                                    </button>
                                ` : ''}
                                <button onclick="cancelOrder('${order.id}')" class="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors" title="Cancelar">
                                    <i data-lucide="x" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');

            if (window.lucide) lucide.createIcons();
        }

        function getStatusColor(status) {
            const colors = {
                'pending': 'bg-yellow-100 text-yellow-700',
                'preparing': 'bg-blue-100 text-blue-700',
                'ready': 'bg-green-100 text-green-700',
                'delivering': 'bg-purple-100 text-plena-primary',
                'delivered': 'bg-gray-100 text-gray-700',
                'cancelled': 'bg-red-100 text-red-700'
            };
            return colors[status] || 'bg-gray-100 text-gray-700';
        }

        function getNextStatus(currentStatus) {
            const sequence = ['pending', 'preparing', 'ready', 'delivering', 'delivered'];
            const currentIndex = sequence.indexOf(currentStatus);
            return currentIndex < sequence.length - 1 ? sequence[currentIndex + 1] : currentStatus;
        }

        function clearOrderFilters() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('search-orders').value = '';
            document.getElementById('filter-status').value = 'all';
            document.getElementById('filter-start-date').value = today;
            document.getElementById('filter-end-date').value = today;
            renderOrders();
        }

        // ORDER MANAGEMENT
        function openNewOrderModal() {
            db.currentOrderItems = [];
            renderOrderItems();
            updateOrderSummary();

            const today = new Date().toISOString().replace('T', ' ').substring(0, 16);
            document.getElementById('order-customer-name').value = '';
            document.getElementById('order-customer-phone').value = '';
            document.getElementById('order-type').value = 'delivery';
            document.getElementById('order-delivery-address').value = '';
            document.getElementById('order-notes').value = '';
            document.getElementById('order-payment-method').value = 'cash';

            openModal('newOrderModal');
        }

        function openQuickMenuModal() {
            renderQuickMenuItems();
            openModal('quickMenuModal');
        }

        function renderQuickMenuItems() {
            const container = document.getElementById('quick-menu-items');
            const searchTerm = document.getElementById('menu-search').value.toLowerCase();
            
            let filteredProducts = db.products.filter(product => product.available !== false);
            
            if (searchTerm) {
                filteredProducts = filteredProducts.filter(product => 
                    product.name.toLowerCase().includes(searchTerm) ||
                    product.description.toLowerCase().includes(searchTerm)
                );
            }

            container.innerHTML = filteredProducts.map(product => {
                const category = db.categories.find(c => c.id === product.categoryId);
                return `
                    <div class="bg-white p-3 rounded-lg border border-gray-200 hover:border-plena-primary transition-colors cursor-pointer" onclick="addOrderItem('${product.id}')">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-bold text-gray-800 text-sm">${sanitizeHTML(product.name)}</h4>
                            ${category ? `<span class="text-xs px-2 py-0.5 rounded" style="background:${category.color}20; color:${category.color}">${category.name}</span>` : ''}
                        </div>
                        <p class="text-xs text-gray-600 mb-2 line-clamp-2">${sanitizeHTML(product.description || '')}</p>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-plena-primary">${fmtMoney(product.price)}</span>
                            <i data-lucide="plus" class="w-4 h-4 text-gray-400"></i>
                        </div>
                    </div>
                `;
            }).join('');

            if (window.lucide) lucide.createIcons();
        }

        function addOrderItem(productId) {
            const product = db.products.find(p => p.id === productId);
            if (!product) return;

            const existingItem = db.currentOrderItems.find(item => item.productId === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                db.currentOrderItems.push({
                    productId: product.id,
                    name: product.name,
                    price: product.price,
                    quantity: 1
                });
            }

            renderOrderItems();
            updateOrderSummary();
            closeModal('quickMenuModal');
        }

        function renderOrderItems() {
            const container = document.getElementById('order-items-list');
            
            if (db.currentOrderItems.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-400">
                        <i data-lucide="shopping-cart" class="w-8 h-8 mx-auto mb-2"></i>
                        <p class="text-sm">Nenhum item adicionado</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = db.currentOrderItems.map((item, index) => `
                <div class="flex items-center justify-between bg-white p-3 rounded-lg border border-gray-200">
                    <div class="flex-1">
                        <p class="font-medium text-gray-800">${sanitizeHTML(item.name)}</p>
                        <p class="text-xs text-gray-500">${fmtMoney(item.price)} cada</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="updateOrderItemQuantity(${index}, -1)" class="w-6 h-6 flex items-center justify-center bg-gray-100 rounded-full">
                            <i data-lucide="minus" class="w-3 h-3"></i>
                        </button>
                        <span class="w-8 text-center font-bold">${item.quantity}</span>
                        <button onclick="updateOrderItemQuantity(${index}, 1)" class="w-6 h-6 flex items-center justify-center bg-gray-100 rounded-full">
                            <i data-lucide="plus" class="w-3 h-3"></i>
                        </button>
                        <button onclick="removeOrderItem(${index})" class="ml-2 text-red-500 hover:text-red-700">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            if (window.lucide) lucide.createIcons();
        }

        function updateOrderItemQuantity(index, change) {
            const item = db.currentOrderItems[index];
            item.quantity += change;
            
            if (item.quantity <= 0) {
                db.currentOrderItems.splice(index, 1);
            }
            
            renderOrderItems();
            updateOrderSummary();
        }

        function removeOrderItem(index) {
            db.currentOrderItems.splice(index, 1);
            renderOrderItems();
            updateOrderSummary();
        }

        function updateOrderSummary() {
            const subtotal = db.currentOrderItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const orderType = document.getElementById('order-type').value;
            const deliveryFee = orderType === 'delivery' ? (db.settings.deliveryFee || 0) : 0;
            const total = subtotal + deliveryFee;

            document.getElementById('order-subtotal').textContent = fmtMoney(subtotal);
            document.getElementById('order-delivery-fee').textContent = fmtMoney(deliveryFee);
            document.getElementById('order-total').textContent = fmtMoney(total);
        }

        function submitNewOrder(e) {
            e.preventDefault();

            if (db.currentOrderItems.length === 0) {
                alert('Adicione pelo menos um item ao pedido.');
                return;
            }

            const order = {
                id: getID(),
                customerName: document.getElementById('order-customer-name').value.trim(),
                customerPhone: document.getElementById('order-customer-phone').value.trim(),
                type: document.getElementById('order-type').value,
                deliveryAddress: document.getElementById('order-type').value === 'delivery' ? document.getElementById('order-delivery-address').value.trim() : null,
                notes: document.getElementById('order-notes').value.trim(),
                paymentMethod: document.getElementById('order-payment-method').value,
                items: [...db.currentOrderItems],
                subtotal: db.currentOrderItems.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                deliveryFee: document.getElementById('order-type').value === 'delivery' ? (db.settings.deliveryFee || 0) : 0,
                total: 0,
                status: 'pending',
                date: new Date().toISOString()
            };

            order.total = order.subtotal + order.deliveryFee;

            db.orders.push(order);
            db.currentOrderItems = [];
            save();

            closeModal('newOrderModal');
            showNotification('Pedido criado com sucesso!', 'success');

            if (document.getElementById('view-dashboard').classList.contains('hide') === false) {
                renderDashboard();
            }
            if (document.getElementById('view-orders').classList.contains('hide') === false) {
                renderOrders();
            }
        }

        function updateOrderStatus(orderId, newStatus) {
            const order = db.orders.find(o => o.id === orderId);
            if (!order) return;

            order.status = newStatus;
            save();

            showNotification(`Status atualizado para: ${getStatusLabel(newStatus)}`, 'success');

            if (document.getElementById('view-dashboard').classList.contains('hide') === false) {
                renderDashboard();
            }
            if (document.getElementById('view-orders').classList.contains('hide') === false) {
                renderOrders();
            }
        }

        function cancelOrder(orderId) {
            showCustomConfirm('Cancelar Pedido', 'Tem certeza que deseja cancelar este pedido?', () => {
                const order = db.orders.find(o => o.id === orderId);
                if (order) {
                    order.status = 'cancelled';
                    save();
                    
                    showNotification('Pedido cancelado com sucesso!', 'success');
                    
                    if (document.getElementById('view-dashboard').classList.contains('hide') === false) {
                        renderDashboard();
                    }
                    if (document.getElementById('view-orders').classList.contains('hide') === false) {
                        renderOrders();
                    }
                }
            });
        }

        // MENU MANAGEMENT
        function openNewProductModal(productId = null) {
            const categorySelect = document.getElementById('product-category');
            categorySelect.innerHTML = db.categories.map(cat => 
                `<option value="${cat.id}">${cat.name}</option>`
            ).join('');

            if (productId) {
                const product = db.products.find(p => p.id === productId);
                if (product) {
                    document.getElementById('product-modal-title').textContent = 'Editar Produto';
                    document.getElementById('product-id').value = product.id;
                    document.getElementById('product-name').value = product.name;
                    document.getElementById('product-description').value = product.description || '';
                    document.getElementById('product-price').value = product.price;
                    document.getElementById('product-category').value = product.categoryId;
                    document.getElementById('product-available').checked = product.available !== false;
                }
            } else {
                document.getElementById('product-modal-title').textContent = 'Novo Produto';
                document.getElementById('product-form').reset();
                document.getElementById('product-id').value = '';
                document.getElementById('product-available').checked = true;
            }

            openModal('productModal');
        }

        function submitProduct(e) {
            e.preventDefault();

            const product = {
                id: document.getElementById('product-id').value || getID(),
                name: document.getElementById('product-name').value.trim(),
                description: document.getElementById('product-description').value.trim(),
                price: parseFloat(document.getElementById('product-price').value),
                categoryId: document.getElementById('product-category').value,
                available: document.getElementById('product-available').checked
            };

            if (document.getElementById('product-id').value) {
                const index = db.products.findIndex(p => p.id === product.id);
                if (index !== -1) {
                    db.products[index] = product;
                }
            } else {
                db.products.push(product);
            }

            save();
            closeModal('productModal');

            if (document.getElementById('view-menu').classList.contains('hide') === false) {
                renderMenu();
            }

            showNotification('Produto salvo com sucesso!', 'success');
        }

        function renderMenu() {
            const container = document.getElementById('menu-grid');
            
            if (db.products.length === 0) {
                container.innerHTML = `
                    <div class="col-span-4 bg-white p-8 rounded-2xl text-center border border-gray-100">
                        <i data-lucide="utensils" class="w-12 h-12 mx-auto mb-4 text-gray-300"></i>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">Nenhum produto cadastrado</h3>
                        <p class="text-gray-500 mb-4">Comece cadastrando seus produtos</p>
                        <button onclick="openNewProductModal()" class="bg-plena-primary text-white px-4 py-2 rounded-lg font-bold hover:bg-purple-800">
                            Cadastrar Primeiro Produto
                        </button>
                    </div>
                `;
                return;
            }

            container.innerHTML = db.products.map(product => {
                const category = db.categories.find(c => c.id === product.categoryId);
                return `
                    <div class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm cursor-pointer hover:shadow-md transition-shadow" onclick="openNewProductModal('${product.id}')">
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="font-bold text-gray-800">${sanitizeHTML(product.name)}</h3>
                            ${!product.available ? `<span class="px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-bold">Indisponível</span>` : ''}
                        </div>
                        
                        ${product.description ? `<p class="text-sm text-gray-600 mb-3 line-clamp-2">${sanitizeHTML(product.description)}</p>` : ''}
                        
                        <div class="flex justify-between items-end">
                            <div>
                                ${category ? `<span class="text-xs px-2 py-1 rounded" style="background:${category.color}20; color:${category.color}">${category.name}</span>` : ''}
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-plena-primary">${fmtMoney(product.price)}</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterMenuByCategory(categoryId) {
            // Implement category filtering
            renderMenu();
        }

        // CATEGORY MANAGEMENT
        function renderCategories() {
            const container = document.getElementById('category-list');
            container.innerHTML = db.categories.map(category => `
                <div class="flex items-center justify-between bg-white p-3 rounded-lg border border-gray-200">
                    <div class="flex items-center">
                        <div class="w-4 h-4 rounded-full mr-3" style="background-color: ${category.color}"></div>
                        <span class="font-medium">${sanitizeHTML(category.name)}</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editCategory('${category.id}')" class="text-blue-600 hover:text-blue-800">
                            <i data-lucide="edit-2" class="w-4 h-4"></i>
                        </button>
                        <button onclick="deleteCategory('${category.id}')" class="text-red-600 hover:text-red-800">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            if (window.lucide) lucide.createIcons();
        }

        function toggleCategoryForm() {
            document.getElementById('category-form-box').classList.toggle('hidden');
        }

        function addCategory() {
            const name = document.getElementById('new-category-name').value.trim();
            const color = document.getElementById('new-category-color').value;

            if (!name) {
                alert('Por favor, insira um nome para a categoria.');
                return;
            }

            db.categories.push({
                id: getID(),
                name: name,
                color: color
            });

            save();
            renderCategories();
            toggleCategoryForm();
            
            document.getElementById('new-category-name').value = '';
            document.getElementById('new-category-color').value = '#7C3AED';

            showNotification('Categoria criada com sucesso!', 'success');
        }

        function editCategory(categoryId) {
            const category = db.categories.find(c => c.id === categoryId);
            if (!category) return;

            const newName = prompt('Novo nome para a categoria:', category.name);
            if (newName && newName.trim()) {
                category.name = newName.trim();
                save();
                renderCategories();
                showNotification('Categoria atualizada!', 'success');
            }
        }

        function deleteCategory(categoryId) {
            if (db.products.some(p => p.categoryId === categoryId)) {
                alert('Não é possível excluir esta categoria pois existem produtos vinculados a ela.');
                return;
            }

            showCustomConfirm('Excluir Categoria', 'Tem certeza que deseja excluir esta categoria?', () => {
                db.categories = db.categories.filter(c => c.id !== categoryId);
                save();
                renderCategories();
                showNotification('Categoria excluída!', 'success');
            });
        }

        // DELIVERY MANAGEMENT
        function renderDelivery() {
            const today = new Date().toISOString().split('T')[0];
            const todayDeliveries = db.orders.filter(order => 
                order.type === 'delivery' && 
                order.date && 
                order.date.startsWith(today)
            );
            const activeDeliveries = todayDeliveries.filter(order => 
                ['ready', 'delivering'].includes(order.status)
            );

            document.getElementById('delivery-today').textContent = todayDeliveries.length;
            document.getElementById('delivery-active').textContent = activeDeliveries.length;
            document.getElementById('delivery-avg-time').textContent = '30min';

            renderActiveDeliveries(activeDeliveries);
            renderDeliveryStaff();
            updateDeliverySettingsDisplay();
        }

        function renderActiveDeliveries(deliveries) {
            const container = document.getElementById('active-deliveries');
            
            if (deliveries.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-400">
                        <i data-lucide="bike" class="w-8 h-8 mx-auto mb-2"></i>
                        <p class="text-sm">Nenhuma entrega ativa no momento</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = deliveries.map(order => `
                <div class="bg-white p-4 rounded-xl border border-gray-200">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <span class="font-bold text-gray-800">Pedido #${order.id.slice(-4)}</span>
                            <span class="ml-2 text-xs px-2 py-1 rounded-full ${order.status === 'ready' ? 'bg-green-100 text-green-700' : 'bg-purple-100 text-plena-primary'}">
                                ${getStatusLabel(order.status)}
                            </span>
                        </div>
                        <span class="text-sm font-bold text-plena-primary">${fmtMoney(order.total)}</span>
                    </div>
                    
                    <div class="mb-3">
                        <p class="text-sm text-gray-800">${sanitizeHTML(order.customerName)}</p>
                        <p class="text-xs text-gray-500">${sanitizeHTML(order.deliveryAddress)}</p>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="text-xs text-gray-500">
                            <i data-lucide="clock" class="w-3 h-3 inline mr-1"></i>
                            ${fmtDateTime(order.date)}
                        </div>
                        ${order.status === 'ready' ? `
                            <button onclick="assignDelivery('${order.id}')" class="text-xs bg-plena-primary text-white px-3 py-1.5 rounded-lg hover:bg-purple-800">
                                Atribuir Entregador
                            </button>
                        ` : `
                            <button onclick="markAsDelivered('${order.id}')" class="text-xs bg-green-600 text-white px-3 py-1.5 rounded-lg hover:bg-green-700">
                                Marcar como Entregue
                            </button>
                        `}
                    </div>
                </div>
            `).join('');

            if (window.lucide) lucide.createIcons();
        }

        function renderDeliveryStaff() {
            const container = document.getElementById('delivery-staff');
            
            if (db.deliveryStaff.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-4 text-gray-400">
                        <p class="text-sm">Nenhum entregador cadastrado</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = db.deliveryStaff.map(staff => `
                <div class="flex items-center justify-between bg-white p-3 rounded-lg border border-gray-200">
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center mr-3">
                            <i data-lucide="user" class="w-4 h-4 text-gray-600"></i>
                        </div>
                        <div>
                            <p class="font-medium text-gray-800">${sanitizeHTML(staff.name)}</p>
                            <p class="text-xs text-gray-500">${sanitizeHTML(staff.phone)}</p>
                        </div>
                    </div>
                    <span class="text-xs px-2 py-1 rounded-full ${staff.active ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700'}">
                        ${staff.active ? 'Ativo' : 'Inativo'}
                    </span>
                </div>
            `).join('');
        }

        function openNewDeliveryStaffModal() {
            const name = prompt('Nome do entregador:');
            if (!name || !name.trim()) return;

            const phone = prompt('Telefone do entregador:');
            if (!phone || !phone.trim()) return;

            db.deliveryStaff.push({
                id: getID(),
                name: name.trim(),
                phone: phone.trim(),
                active: true
            });

            save();
            renderDeliveryStaff();
            showNotification('Entregador cadastrado com sucesso!', 'success');
        }

        function updateDeliverySettingsDisplay() {
            document.getElementById('delivery-fee').textContent = fmtMoney(db.settings.deliveryFee || 0);
            document.getElementById('delivery-radius').textContent = `${db.settings.deliveryRadius || 0} km`;
            document.getElementById('delivery-estimated').textContent = `${db.settings.deliveryTime || 30}-${(db.settings.deliveryTime || 30) + 15} min`;
        }

        // REPORTS
        function setReportPeriod(period) {
            const today = new Date();
            const start = new Date();
            const end = new Date();

            switch(period) {
                case 'today':
                    break;
                case 'this-week':
                    start.setDate(today.getDate() - today.getDay());
                    break;
                case 'this-month':
                    start.setDate(1);
                    break;
                case 'last-month':
                    start.setMonth(today.getMonth() - 1, 1);
                    end.setMonth(today.getMonth(), 0);
                    break;
            }

            document.getElementById('rep-start').value = start.toISOString().split('T')[0];
            document.getElementById('rep-end').value = end.toISOString().split('T')[0];
        }

        function generateReport() {
            const start = document.getElementById('rep-start').value;
            const end = document.getElementById('rep-end').value;

            const filteredOrders = db.orders.filter(order => 
                order.date && order.date >= start && order.date <= end
            );

            const revenue = filteredOrders.reduce((sum, order) => sum + order.total, 0);
            const customers = new Set(filteredOrders.map(order => order.customerPhone)).size;
            const deliveries = filteredOrders.filter(order => order.type === 'delivery').length;

            document.getElementById('rep-revenue').textContent = fmtMoney(revenue);
            document.getElementById('rep-orders').textContent = filteredOrders.length;
            document.getElementById('rep-customers').textContent = customers;
            document.getElementById('rep-deliveries').textContent = deliveries;

            // Top Products
            const productSales = {};
            filteredOrders.forEach(order => {
                if (order.items) {
                    order.items.forEach(item => {
                        if (!productSales[item.productId]) {
                            productSales[item.productId] = {
                                name: item.name,
                                quantity: 0,
                                revenue: 0
                            };
                        }
                        productSales[item.productId].quantity += item.quantity;
                        productSales[item.productId].revenue += item.price * item.quantity;
                    });
                }
            });

            const topProducts = Object.values(productSales)
                .sort((a, b) => b.revenue - a.revenue)
                .slice(0, 5);

            const topProductsContainer = document.getElementById('top-products');
            topProductsContainer.innerHTML = topProducts.map(product => `
                <div class="flex justify-between items-center">
                    <span class="text-sm">${sanitizeHTML(product.name)}</span>
                    <div class="text-right">
                        <span class="font-bold">${fmtMoney(product.revenue)}</span>
                        <span class="text-xs text-gray-500 ml-2">${product.quantity} un</span>
                    </div>
                </div>
            `).join('');

            document.getElementById('report-result').classList.remove('hide');
        }

        function printReport() {
            window.print();
        }

        // SETTINGS
        function saveGlobalSettings() {
            db.settings.establishmentName = document.getElementById('set-establishment-name').value.trim();
            db.settings.establishmentCNPJ = document.getElementById('set-establishment-cnpj').value.trim();
            db.settings.establishmentPhone = document.getElementById('set-establishment-phone').value.trim();
            db.settings.establishmentAddress = document.getElementById('set-establishment-address').value.trim();

            save();
            showNotification('Configurações salvas com sucesso!', 'success');
        }

        function saveDeliverySettings() {
            db.settings.deliveryFee = parseFloat(document.getElementById('set-delivery-fee').value) || 0;
            db.settings.deliveryRadius = parseFloat(document.getElementById('set-delivery-radius').value) || 0;
            db.settings.deliveryTime = parseInt(document.getElementById('set-delivery-time').value) || 30;
            db.settings.freeDeliveryMin = parseFloat(document.getElementById('set-free-delivery-min').value) || 0;

            save();
            updateDeliverySettingsDisplay();
            showNotification('Configurações de entrega salvas!', 'success');
        }

        // BACKUP & RESTORE
        function downloadBackup() {
            const dataStr = JSON.stringify(db, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `plena_delivery_backup_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('Backup baixado com sucesso!', 'success');
        }

        function restoreBackup(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    showCustomConfirm('Restaurar Backup', 'Isso substituirá todos os dados atuais. Deseja continuar?', () => {
                        Object.assign(db, backupData);
                        save();
                        init();
                        showNotification('Backup restaurado com sucesso!', 'success');
                        location.reload();
                    });
                } catch (error) {
                    alert('Erro ao restaurar backup: Arquivo inválido.');
                }
            };
            reader.readAsText(file);
        }

        function clearAllOrders() {
            showCustomConfirm('Limpar Todos os Pedidos', 'Tem certeza que deseja excluir todos os pedidos? Esta ação não pode ser desfeita.', () => {
                db.orders = [];
                save();
                showNotification('Todos os pedidos foram excluídos!', 'success');
                
                if (document.getElementById('view-dashboard').classList.contains('hide') === false) {
                    renderDashboard();
                }
                if (document.getElementById('view-orders').classList.contains('hide') === false) {
                    renderOrders();
                }
            });
        }

        function factoryReset() {
            showCustomConfirm('Resetar Tudo', 'Isso apagará TODOS os dados (pedidos, produtos, configurações). Deseja continuar?', () => {
                localStorage.removeItem(DB_KEY);
                location.reload();
            });
        }

        // UTILITY FUNCTIONS
        function openModal(id) {
            const modal = document.getElementById(id);
            if (modal) {
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(id) {
            const modal = document.getElementById(id);
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        function showNotification(message, type = 'info') {
            // Simple notification implementation
            alert(message);
        }

        function updateDataStatus() {
            // Update any data status indicators if needed
        }

        // CUSTOM CONFIRM MODAL
        let currentConfirmCallback = null;
        let currentCancelCallback = null;

        function showCustomConfirm(title, message, onConfirm, isDestructive = true, confirmText = 'Confirmar', cancelText = 'Cancelar', onCancel = null) {
            document.getElementById('confirm-title').innerText = title;
            document.getElementById('confirm-message').innerText = message;

            const btnConfirm = document.getElementById('confirm-btn-action');
            const btnCancel = document.getElementById('confirm-btn-cancel');

            btnConfirm.innerText = confirmText;
            btnCancel.innerText = cancelText;

            if (isDestructive) {
                btnConfirm.className = "flex-1 px-4 py-2 bg-red-600 text-white rounded-xl font-bold hover:bg-red-700 transition-colors shadow-lg shadow-red-200";
            } else {
                btnConfirm.className = "flex-1 px-4 py-2 bg-plena-primary text-white rounded-xl font-bold hover:bg-purple-800 transition-colors shadow-lg shadow-purple-200";
            }

            currentConfirmCallback = onConfirm;
            currentCancelCallback = onCancel;

            document.getElementById('confirmModal').classList.remove('hidden');
        }

        function closeConfirmModal() {
            document.getElementById('confirmModal').classList.add('hidden');
            currentConfirmCallback = null;
            currentCancelCallback = null;
        }

        function handleConfirmCancel() {
            if (currentCancelCallback) currentCancelCallback();
            closeConfirmModal();
        }

        document.getElementById('confirm-btn-action').addEventListener('click', () => {
            if (currentConfirmCallback) currentConfirmCallback();
            closeConfirmModal();
        });

        // RECEIPT MODAL
        function openReceiptModal(orderId) {
            const order = db.orders.find(o => o.id === orderId);
            if (!order) return;

            // Populate receipt data
            document.getElementById('rec-order-id').textContent = `#${order.id.slice(-4)}`;
            document.getElementById('rec-order-date').textContent = fmtDateTime(order.date);
            document.getElementById('rec-customer-name').textContent = sanitizeHTML(order.customerName);
            document.getElementById('rec-customer-phone').textContent = sanitizeHTML(order.customerPhone);
            document.getElementById('rec-delivery-address').textContent = order.deliveryAddress ? sanitizeHTML(order.deliveryAddress) : 'Retirada no local';
            document.getElementById('rec-subtotal').textContent = fmtMoney(order.subtotal);
            document.getElementById('rec-delivery-fee').textContent = fmtMoney(order.deliveryFee);
            document.getElementById('rec-total').textContent = fmtMoney(order.total);
            document.getElementById('rec-payment-method').textContent = getPaymentMethodLabel(order.paymentMethod);
            document.getElementById('rec-order-status').textContent = getStatusLabel(order.status);
            document.getElementById('rec-hash').textContent = order.id.slice(-8).toUpperCase();

            // Populate order items
            const itemsContainer = document.getElementById('rec-order-items');
            if (order.items) {
                itemsContainer.innerHTML = order.items.map(item => `
                    <div class="flex justify-between mb-2">
                        <div>
                            <p class="font-medium">${sanitizeHTML(item.name)}</p>
                            <p class="text-sm text-gray-500">${item.quantity} x ${fmtMoney(item.price)}</p>
                        </div>
                        <span class="font-bold">${fmtMoney(item.price * item.quantity)}</span>
                    </div>
                `).join('');
            }

            openModal('receiptModal');
        }

        function getPaymentMethodLabel(method) {
            const labels = {
                'cash': 'Dinheiro',
                'card': 'Cartão',
                'pix': 'PIX',
                'online': 'Online'
            };
            return labels[method] || method;
        }

        // Initialize the application
        // INICIALIZAR APLICATIVO
        document.addEventListener('DOMContentLoaded', () => {
             if (typeof init === 'function') init();
             // Register SW for PWA
             if ('serviceWorker' in navigator) {
                 navigator.serviceWorker.register('./sw.js')
                     .then(() => console.log('SW Registered'))
                     .catch(err => console.error('SW Error:', err));
             }
        });
    </script>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>

    

    

<!-- PWA INSTALLATION TOAST (Standardized) -->
<div id="pwa-install-toast" style="display: none; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background-color: white; color: black; padding: 12px 16px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index: 9999; align-items: center; gap: 12px; border: 1px solid #e5e7eb; min-width: 300px;">
    <div style="background-color: transparent; padding: 0; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
        <img src="./icons/icon-192.png" alt="App Icon" style="width: 40px; height: 40px; border-radius: 8px; object-fit: cover;">
    </div>
    <div style="flex: 1;">
        <p style="font-size: 14px; font-weight: bold; margin: 0; color: #1f2937;">Instalar Aplicativo</p>
        <p style="font-size: 12px; color: #6b7280; margin: 0;">Acesso rápido 100% offline</p>
    </div>
    <button onclick="installPWA()" style="background-color: #000; color: white; border: none; padding: 8px 16px; border-radius: 8px; font-size: 12px; font-weight: bold; cursor: pointer; white-space: nowrap;">
        Instalar
    </button>
    <button onclick="dismissInstall()" style="background-color: transparent; border: none; color: #9ca3af; cursor: pointer; padding: 4px; display: flex; align-items: center;">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
    </button>
</div>

<script>
    let deferredPrompt;
    
    // Check if installed
    const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone || document.referrer.includes('android-app://');

    window.addEventListener('beforeinstallprompt', (e) => {
        // Prevent Chrome 67 and earlier from automatically showing the prompt
        e.preventDefault();
        deferredPrompt = e;
        
        // Show the toast if not already dismissed and not in standalone mode
        if (!localStorage.getItem('pwa_dismissed') && !isStandalone) {
             const toast = document.getElementById('pwa-install-toast');
             if (toast) toast.style.display = 'flex';
        }
    });

    function installPWA() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('User accepted the install prompt');
                }
                deferredPrompt = null;
                dismissInstall();
            });
        }
    }

    function dismissInstall() {
        const toast = document.getElementById('pwa-install-toast');
        if (toast) toast.style.display = 'none';
        localStorage.setItem('pwa_dismissed', 'true');
    }
</script>
</body>
</html>